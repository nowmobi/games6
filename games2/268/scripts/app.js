!function(e){function t(t){for(var i,o,r=t[0],a=t[1],s=0,u=[];s<r.length;s++)o=r[s],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&u.push(n[o][0]),n[o]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i]);for(l&&l(t);u.length;)u.shift()()}var i={},n={1:0};function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(e){var t=[],i=n[e];if(0!==i)if(i)t.push(i[2]);else{var r=new Promise((function(t,o){i=n[e]=[t,o]}));t.push(i[2]=r);var a,s=proxiesWindow.document.createElement("script");s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.src=function(e){return o.p+""+({0:"Axl",4:"audioworkletaudio"}[e]||e)+".js"}(e);var l=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(u);var i=n[e];if(0!==i){if(i){var o=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+o+": "+r+")",l.name="ChunkLoadError",l.type=o,l.request=r,i[1](l)}n[e]=void 0}};var u=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,proxiesWindow.document.head.appendChild(s)}return Promise.all(t)},o.m=e,o.c=i,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="./",o.oe=function(e){throw console.error(e),e};var r=proxiesWindow.self.webpackJsonp=proxiesWindow.self.webpackJsonp||[],a=r.push.bind(r);r.push=t,r=r.slice();for(var s=0;s<r.length;s++)t(r[s]);var l=a;o(o.s=43)}([function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"o",(function(){return a})),i.d(t,"w",(function(){return s})),i.d(t,"v",(function(){return l})),i.d(t,"q",(function(){return u})),i.d(t,"a",(function(){return c})),i.d(t,"p",(function(){return h})),i.d(t,"g",(function(){return d})),i.d(t,"n",(function(){return f})),i.d(t,"k",(function(){return m})),i.d(t,"f",(function(){return g})),i.d(t,"c",(function(){return b})),i.d(t,"e",(function(){return v})),i.d(t,"d",(function(){return y})),i.d(t,"i",(function(){return x})),i.d(t,"r",(function(){return _})),i.d(t,"j",(function(){return w})),i.d(t,"t",(function(){return P})),i.d(t,"l",(function(){return S})),i.d(t,"m",(function(){return k})),i.d(t,"s",(function(){return A})),i.d(t,"h",(function(){return T})),i.d(t,"u",(function(){return E}));var n=i(2),o=i(1);function r(e,t,i){return Math.min(Math.max(e,t),i)}function a(e,t,i){return r((i-e)/(t-e),0,1)}function s(e,t,i){var n=r((i-e)/(t-e),0,1);return n*n*(3-2*n)}function l(e,t,i){return(i=r((i-e)/(t-e),0,1))*i*i*(i*(6*i-15)+10)}function u(e,t,i){return(1-i)*e+i*t}function c(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}function h(e){return 440*Math.pow(2,(e-69)/12)}function d(e){return 12*Math.log2(e/440)+69}function f(e){return e===o.b.a||e===o.b.e||e===o.b.i||e===o.b.o||e===o.b.u}var p=[0,0,0];function m(e,t,i,o,r){var a=n.a.dot(i,r),s=n.a.dot(n.a.subtract(p,t,o),i)/a;return n.a.add(e,o,n.a.multiplyByScalar(p,r,s)),e}function g(e,t){for(var i=[],n=0;n<e;++n)i.push(t);return i}function b(e,t,i){for(var o=[],r=0;r<e.length;++r)o.push([0,0,0]);var a=function(t){return[e[3*t+0],e[3*t+1],e[3*t+2]*i]};for(r=0;r<t.length/3;++r){var s=t[3*r+0],l=t[3*r+1],u=t[3*r+2],c=a(s),h=a(l),d=a(u),f=n.a.cross([],n.a.subtract([],h,c),n.a.subtract([],d,c));n.a.add(o[s],o[s],f),n.a.add(o[l],o[l],f),n.a.add(o[u],o[u],f)}for(r=0;r<o.length;++r)n.a.normalize(o[r],o[r]);var p=[];for(r=0;r<o.length;++r)p.push(o[r][0]),p.push(o[r][1]),p.push(o[r][2]);return p}function v(e){return Math.PI*e/180}function y(e,t){new Uint8Array(t).set(new Uint8Array(e))}function x(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return[parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255]}function _(e,t){return Math.round(e/t)*t}function w(e){var t=e[0],i=e[1],n=e[2],o=n*i,r=6*(t%=1),a=o*(1-Math.abs(r%2-1)),s=Math.floor(r),l=[o,a,0,0,a,o][s],u=[a,o,o,a,0,0][s],c=[0,0,a,o,o,a][s],h=n-o;return[l+=h,u+=h,c+=h]}function P(e){var t=e[0],i=e[1],n=e[2],o=Math.max(t,i,n),r=o-Math.min(t,i,n),a=r&&(o==t?(i-n)/r:o==i?2+(n-t)/r:4+(t-i)/r);return[60*(a<0?a+6:a)/360,o&&r/o,o]}function S(e){return 11===e.getMonth()||0===e.getMonth()&&e.getDate()<=5}function k(e){return 11===e.getMonth()&&31===e.getDate()||0===e.getMonth()&&1===e.getDate()||0===e.getMonth()&&2===e.getDate()}function A(e,t){return e+Math.random()*(t-e)}function T(e){return 11===e.getMonth()?Math.max(e.getFullYear()+1,2022).toFixed(0):Math.max(e.getFullYear(),2022).toFixed(0)}function E(e){for(var t=e.length-1;t>0;t--){var i=Math.floor(Math.random()*(t+1)),n=e[t];e[t]=e[i],e[i]=n}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"d",(function(){return l}));var n,o={spectralMin:-128.68316134071944,spectralMax:19,aperiodicMin:-35.112804058126855,aperiodicMax:13877787807814457e-33};function r(e){return e===n.a?"a":e===n.e?"e":e===n.i?"i":e===n.o?"o":e===n.u?"u":void 0}!function(e){e[e.i=0]="i",e[e.a=1]="a",e[e.e=2]="e",e[e.o=3]="o",e[e.sil=4]="sil",e[e.r=5]="r",e[e.n=6]="n",e[e.l=7]="l",e[e.t=8]="t",e[e.s=9]="s",e[e.d=10]="d",e[e.u=11]="u",e[e.m=12]="m",e[e.p=13]="p",e[e.v=14]="v",e[e.ch=15]="ch",e[e.c=16]="c",e[e.f=17]="f",e[e.j=18]="j",e[e.b=19]="b",e[e.h=20]="h",e[e.g=21]="g",e[e.qu=22]="qu",e[e.sh=23]="sh",e[e.ny=24]="ny",e[e.y=25]="y",e[e.sk=26]="sk",e[e.z=27]="z",e[e.tz=28]="tz"}(n||(n={}));for(var a=[],s=0;s<29;++s)a[s]=s===n.t||s===n.s||s===n.p||s===n.v||s===n.ch||s===n.c||s===n.f||s===n.j||s===n.h||s===n.g||s===n.qu||s===n.sh||s===n.sk||s===n.z||s===n.tz;function l(e){return a[e]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(6);function o(e,t,i){return Math.min(Math.max(e,t),i)}var r={set:function(e,t,i,n){return e[0]=t,e[1]=i,e[2]=n,e},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},clone:function(e){return[e[0],e[1],e[2]]},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},scaleAndAdd:function(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e},cross:function(e,t,i){var n=t[0],o=t[1],r=t[2],a=i[0],s=i[1],l=i[2];return e[0]=o*l-r*s,e[1]=r*a-n*l,e[2]=n*s-o*a,e},coneClamp:function(e,t,i,o){if(r.dot(t,i)<-.9999)return e;var a=Math.acos(r.dot(t,i));if(a>o){var s=r.normalize([],r.cross([],i,t)),l=n.a.fromAxisAngle([],s,a-o);return r.multiplyByQuaternion(e,i,l),e}return e},rotateTowards:function(e,t,i,o){var a=Math.acos(r.dot(t,i));o>a&&(o=a);var s=r.normalize([],r.cross([],t,i)),l=n.a.fromAxisAngle([],s,o);return r.multiplyByQuaternion(e,t,l),e},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},multiply:function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e},addList:function(e,t){e[0]=0,e[1]=0,e[2]=0;for(var i=0;i<t.length;++i)e[0]+=t[i][0],e[1]+=t[i][1],e[2]+=t[i][2];return e},subtract:function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},multiplyByScalar:function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},multiplyByQuaternion:function(e,t,i){var n=t[0],o=t[1],r=t[2],a=i[3],s=i[0],l=i[1],u=i[2],c=a*n+l*r-u*o,h=a*o+u*n-s*r,d=a*r+s*o-l*n,f=-s*n-l*o-u*r;return e[0]=f*-s+c*a+h*-u-d*-l,e[1]=f*-l+h*a+d*-s-c*-u,e[2]=f*-u+d*a+c*-l-h*-s,e},normalize:function(e,t){var i=t[0],n=t[1],o=t[2],r=1/Math.sqrt(i*i+n*n+o*o);return e[0]=i*r,e[1]=n*r,e[2]=o*r,e},distance:function(e,t){var i=t[0]-e[0],n=t[1]-e[1],o=t[2]-e[2];return Math.sqrt(i*i+n*n+o*o)},distance2:function(e,t){var i=t[0]-e[0],n=t[1]-e[1],o=t[2]-e[2];return i*i+n*n+o*o},length:function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])},mix:function(e,t,i,n){return e[0]=(1-n)*t[0]+n*i[0],e[1]=(1-n)*t[1]+n*i[1],e[2]=(1-n)*t[2]+n*i[2],e},linearMix:function(e,t,i,n){for(var o=0;o<3;++o)t[o]<i[o]?e[o]=Math.min(t[o]+n[o],i[o]):t[o]>i[o]?e[o]=Math.max(t[o]-n[o],i[o]):e[o]=i[o]},clampedMix:function(e,t,i,n,o){var a=r.subtract([],i,t),s=r.length(a),l=Math.min(s*n,o);l>0?r.add(e,t,r.multiplyByScalar([],a,l/s)):(e[0]=i[0],e[1]=i[1],e[2]=i[2]),r.multiplyByScalar(a,a,n)},clamp:function(e,t,i,n){return e[0]=o(t[0],i[0],n[0]),e[1]=o(t[1],i[1],n[1]),e[2]=o(t[2],i[2],n[2]),e},slerp:function(e,t,i,n){var a=r.dot(t,i);a=o(a,0,1);for(var s=Math.acos(a)*n,l=r.subtract([],i,r.multiplyByScalar([],t,a)),u=0;u<3;++u)e[u]=t[u]*Math.cos(s)+l[u]*Math.sin(s);return e},pow:function(e,t,i){return e[0]=Math.pow(t[0],i),e[1]=Math.pow(t[1],i),e[2]=Math.pow(t[2],i),e},hsvToRGB:function(e,t){var i=t[0],n=t[1],o=t[2],r=6*(i%=1),a=(t=o*n)*(1-Math.abs(r%2-1)),s=Math.floor(r),l=[t,a,0,0,a,t][s],u=[a,t,t,a,0,0][s],c=[0,0,a,t,t,a][s],h=o-t;return l+=h,u+=h,c+=h,e[0]=l,e[1]=u,e[2]=c,e},rgbToHSV:function(e,t){var i,n,o,r,a,s=t[0],l=t[1],u=t[2],c=Math.max(s,l,u),h=c-Math.min(s,l,u),d=function(e){return(c-e)/6/h+.5};return 0==h?r=a=0:(a=h/c,i=d(s),n=d(l),o=d(u),s===c?r=o-n:l===c?r=.3333333333333333+i-o:u===c&&(r=.6666666666666666+n-i),r<0?r+=1:r>1&&(r-=1)),e[0]=r,e[1]=a,e[2]=c,e}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(0);function o(e){return e}var r=function(){function e(e,t){void 0===t&&(t=o),this.fromValue=e,this.targetValue=e,this.smoothingFunction=t,this.tweenDuration=1,this.tweenStartTime=-99999}return e.prototype.change=function(e,t,i){void 0===i&&(i=0),e!==this.targetValue&&(this.fromValue=this.evaluate(),this.targetValue=e,this.tweenDuration=1e3*t,this.tweenStartTime=Date.now()+1e3*i)},e.prototype.evaluate=function(){if(0===this.tweenDuration)return this.targetValue;var e=this.smoothingFunction(Object(n.o)(this.tweenStartTime,this.tweenStartTime+this.tweenDuration,Date.now()));return Object(n.q)(this.fromValue,this.targetValue,e)},e}()},function(e,t,i){"use strict";function n(e){return"./"+e}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";(function(e){var n=t;function o(e,t,i){for(var n=Object.keys(t),o=0;o<n.length;++o)void 0!==e[n[o]]&&i||(e[n[o]]=t[n[o]]);return e}function r(e){function t(e,i){if(!(this instanceof t))return new t(e,i);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),i&&o(this,i)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=i(22),n.base64=i(23),n.EventEmitter=i(24),n.float=i(25),n.inquire=i(26),n.utf8=i(27),n.pool=i(28),n.LongBits=i(29),n.isNode=Boolean(void 0!==e&&e&&e.process&&e.process.versions&&e.process.versions.node),n.global=n.isNode&&e||"undefined"!=typeof proxiesWindow&&proxiesWindow||void 0!==proxiesWindow.self&&proxiesWindow.self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var i=e[t];return!(null==i||!e.hasOwnProperty(t))&&("object"!=typeof i||(Array.isArray(i)?i.length:Object.keys(i).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var i=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))},n.merge=o,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=r,n.ProtocolError=r("ProtocolError"),n.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var e=Object.keys(this),i=e.length-1;i>-1;--i)if(1===t[e[i]]&&void 0!==this[e[i]]&&null!==this[e[i]])return e[i]}},n.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,i){return new e(t,i)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}}).call(this,i(16))},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n={identity:function(){return[0,0,0,1]},makeIdentity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},length:function(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3]},invert:function(e,t){var i=1/(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]);return e[0]=-t[0]*i,e[1]=-t[1]*i,e[2]=-t[2]*i,e[3]=t[3]*i,e},multiply:function(e,t,i){var n=t[0],o=t[1],r=t[2],a=t[3],s=i[0],l=i[1],u=i[2],c=i[3];return e[0]=s*n-l*o-u*r-c*a,e[1]=s*o+l*n+u*a-c*r,e[2]=s*r-l*a+u*n+c*o,e[3]=s*a+l*r-u*o+c*n,e},normalize:function(e,t){var i=1/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]);return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},fromAxisAngle:function(e,t,i){return e[0]=t[0]*Math.sin(i/2),e[1]=t[1]*Math.sin(i/2),e[2]=t[2]*Math.sin(i/2),e[3]=Math.cos(i/2),e},slerp:function(e,t,i,o){var r,a,s,l,u,c=t[0],h=t[1],d=t[2],f=t[3],p=i[0],m=i[1],g=i[2],b=i[3];return(a=c*p+h*m+d*g+f*b)<0&&(a=-a,p=-p,m=-m,g=-g,b=-b),1-a>1e-6?(r=Math.acos(a),s=Math.sin(r),l=Math.sin((1-o)*r)/s,u=Math.sin(o*r)/s):(l=1-o,u=o),e[0]=l*c+u*p,e[1]=l*h+u*m,e[2]=l*d+u*g,e[3]=l*f+u*b,n.normalize(e,e),e}}},function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return o}));var n=function(){function e(e,t){this.module=e,this.pointer=this.module._malloc(4*t),this.length=t}return e.prototype.getArray=function(){return this.module.HEAPU32.subarray(this.pointer>>2,(this.pointer>>2)+this.length)},e}(),o=function(){function e(e,t){this.module=e,this.pointer=this.module._malloc(4*t),this.length=t}return e.prototype.getArray=function(){return this.module.HEAPF32.subarray(this.pointer>>2,(this.pointer>>2)+this.length)},e}()},function(e,t,i){"use strict";function n(e){return new Promise((function(t,i){var n=new proxiesWindow.XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(e){var i=n.response;i&&t(i)},n.send(null)}))}function o(e){return new Promise((function(t,i){var n=proxiesWindow.document.createElement("img");n.onload=function(){t(n)},n.src=e}))}function r(e){return new Promise((function(t,i){var n=new proxiesWindow.XMLHttpRequest;n.open("GET",e,!0),n.onload=function(){t(JSON.parse(n.responseText))},n.send(null)}))}i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return r}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(){function e(e){this.buffer=e,this.floatView=new Float32Array(e),this.intView=new Int32Array(e)}return e.prototype.setId=function(e){this.intView[0]=e},e.prototype.getId=function(){return this.intView[0]},e.prototype.setPhoneme=function(e){this.intView[1]=e},e.prototype.getPhoneme=function(){return this.intView[1]},e.prototype.setPreviousPhoneme=function(e){this.intView[2]=e},e.prototype.getPreviousPhoneme=function(){return this.intView[2]},e.prototype.setNextPhoneme=function(e){this.intView[3]=e},e.prototype.getNextPhoneme=function(){return this.intView[3]},e.prototype.setPhonemePosition=function(e){this.floatView[4]=e},e.prototype.getPhonemePosition=function(){return this.floatView[4]},e.prototype.setF0=function(e){this.floatView[5]=e},e.prototype.getF0=function(){return this.floatView[5]},e.prototype.setSingerIndex=function(e){this.intView[6]=e},e.prototype.getSingerIndex=function(){return this.intView[6]},e.prototype.setMidiNote=function(e){this.floatView[7]=e},e.prototype.getMidiNote=function(){return this.floatView[7]},e.prototype.setVowel=function(e){this.intView[8]=e},e.prototype.getVowel=function(){return this.intView[8]},e.prototype.setMuted=function(e){this.intView[9]=e?1:0},e.prototype.getMuted=function(){return 0!==this.intView[9]},e.prototype.setControlled=function(e){this.intView[10]=e?1:0},e.prototype.getControlled=function(){return 0!==this.intView[10]},e.prototype.setSkip=function(e){this.intView[11]=e},e.prototype.getSkip=function(){return this.intView[11]},e.prototype.getAperiodic=function(){return this.floatView.subarray(12,16)},e.getSizeBytes=function(){return 64},e.isExcitationFrame=function(t){return t.byteLength===e.getSizeBytes()},e}()},function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return a}));var n=i(0);function o(e,t,i,o){var r;return((r=-3*Math.abs(Math.log2(t/Object(n.b)(e,1,16e3)))/i+100)>0?Math.pow(10,(r-100)/20):0)*o}function r(e){for(var t=[],i=0;i<60;++i)t.push(0);for(var n=function(e,t,i){for(var n=[],o=0;o<60;++o){var r=271.1864406779661*o,a=2*Math.PI*r/t,s=-.45,l=Math.atan2((1-s*s)*Math.sin(a),(1+s*s)*Math.cos(a)-2*s);n.push(l/(2*Math.PI)*t)}return n[59]=t/2,n}(0,32e3),r=0,a=e;r<a.length;r++){var s=a[r];for(i=0;i<60;++i)t[i]+=o(n[i],s.centreFrequencyHz,s.bandwidthOctaves,s.gainDB)}return t}var a={forceScriptProcessor:!1,scriptProcessorBufferSize:4096,frameHopSeconds:.005,excitationOffset:0,targetFFTSize:512,pans:[[-23,-6,17,28],[0,-14,14,28],[0,0,-14,14],[0,0,0,0]],reverb:{mix:.6,feedback:.88,lowcut:3e-4,highcut:.741,crossfreq:.833,predelay_ms:0,modamount:.008,modtime:.666},noiseExcitation:!1,onlySpectralGain:!1,voiceTypes:[{scale:[67,69,71,72,74,76,77,79,81,83,84]},{scale:[60,62,64,65,67,69,71,72,74,76]},{scale:[48,50,52,53,55,57,59,60,62,64,65,67]},{scale:[43,45,47,48,50,52,53,55,57,59,60]}],singers:[{voiceType:0,pitchStops:[62,72,80],spectralFilters:[{centreFrequencyHz:459,bandwidthOctaves:4,gainDB:-4.4},{centreFrequencyHz:1640,bandwidthOctaves:2.6,gainDB:4.4},{centreFrequencyHz:15e3,bandwidthOctaves:4,gainDB:-2.8}],aperiodicGain:{vowel:[-15,-9,-6,0,-9,-15],consonant:[0,0,0,0,0,0]},periodicGain:{vowel:[0,0,0,0,0,0],consonant:[0,0,0,0,0,0]},jitterScale:1,spectralSingerMapping:[1,0,0,0,0,0],aperiodicSingerMapping:[1,0,0,0,0,0],gain:1.883},{pitchStops:[59,68,74],voiceType:1,spectralFilters:[{centreFrequencyHz:87.8,bandwidthOctaves:3,gainDB:-7.4},{centreFrequencyHz:275.5,bandwidthOctaves:2.15,gainDB:6.8},{centreFrequencyHz:3263,bandwidthOctaves:2,gainDB:-2.2}],aperiodicGain:{vowel:[-3,0,0,0,-3,-6],consonant:[0,0,0,0,0,0]},periodicGain:{vowel:[0,0,0,0,0,0],consonant:[0,0,0,0,0,0]},jitterScale:1,spectralSingerMapping:[.1,.5,0,0,1,0],aperiodicSingerMapping:[.1,.5,0,0,1,0],gain:1.6947},{pitchStops:[48,58,65],voiceType:2,spectralFilters:[{centreFrequencyHz:72,bandwidthOctaves:4,gainDB:-6.8},{centreFrequencyHz:874.3,bandwidthOctaves:2.18,gainDB:4.8},{centreFrequencyHz:2212,bandwidthOctaves:3.68,gainDB:-3.4}],aperiodicGain:{vowel:[0,0,0,0,0,0],consonant:[0,0,0,0,0,0]},periodicGain:{vowel:[0,0,0,0,0,0],consonant:[0,0,0,0,0,0]},jitterScale:1,spectralSingerMapping:[0,0,0,1,0,0],aperiodicSingerMapping:[0,0,0,1,0,0],gain:2.4479},{pitchStops:[43,52,60],voiceType:3,spectralFilters:[{centreFrequencyHz:225.7,bandwidthOctaves:2.95,gainDB:5.2},{centreFrequencyHz:1031.6,bandwidthOctaves:2,gainDB:-4.8},{centreFrequencyHz:2558.2,bandwidthOctaves:3.02,gainDB:1.8}],aperiodicGain:{vowel:[0,0,0,0,0,0],consonant:[0,0,0,0,0,0]},periodicGain:{vowel:[0,0,0,0,0,0],consonant:[0,0,0,0,0,0]},jitterScale:1,spectralSingerMapping:[0,0,0,1,0,0],aperiodicSingerMapping:[0,0,0,1,0,0],gain:1.5064}]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(){function e(e){this.buffer=e,this.floatView=new Float32Array(e),this.intView=new Int32Array(e)}return e.prototype.setId=function(e){this.intView[0]=e},e.prototype.getId=function(){return this.intView[0]},e.prototype.setPhoneme=function(e){this.intView[1]=e},e.prototype.getPhoneme=function(){return this.intView[1]},e.prototype.setPreviousPhoneme=function(e){this.intView[2]=e},e.prototype.getPreviousPhoneme=function(){return this.intView[2]},e.prototype.setNextPhoneme=function(e){this.intView[3]=e},e.prototype.getNextPhoneme=function(){return this.intView[3]},e.prototype.setPhonemePosition=function(e){this.floatView[4]=e},e.prototype.getPhonemePosition=function(){return this.floatView[4]},e.prototype.setF0=function(e){this.floatView[5]=e},e.prototype.getF0=function(){return this.floatView[5]},e.prototype.setSingerIndex=function(e){this.intView[6]=e},e.prototype.getSingerIndex=function(){return this.intView[6]},e.prototype.setMidiNote=function(e){this.floatView[7]=e},e.prototype.getMidiNote=function(){return this.floatView[7]},e.prototype.setVowel=function(e){this.intView[8]=e},e.prototype.getVowel=function(){return this.intView[8]},e.prototype.setMuted=function(e){this.intView[9]=e?1:0},e.prototype.getMuted=function(){return 0!==this.intView[9]},e.prototype.setControlled=function(e){this.intView[10]=e?1:0},e.prototype.getControlled=function(){return 0!==this.intView[10]},e.prototype.setSkip=function(e){this.intView[11]=e},e.prototype.getSkip=function(){return this.intView[11]},e.prototype.getSpectral=function(){return this.floatView.subarray(12,270)},e.prototype.setSubsteps=function(e){this.intView[270]=e},e.prototype.getSubsteps=function(){return this.intView[270]},e.prototype.setSendTime=function(e){this.floatView[271]=e},e.prototype.getSendTime=function(){return this.floatView[271]},e.getSizeBytes=function(){return 1088},e.isSpectralFrame=function(t){return t.byteLength===e.getSizeBytes()},e}()},function(e,t,i){"use strict";function n(){return"?v=5"}i.d(t,"a",(function(){return n}))},,function(e,t,i){"use strict";function n(){return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]))}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";e.exports=h;var n,o=i(5),r=o.LongBits,a=o.base64,s=o.utf8;function l(e,t,i){this.fn=e,this.len=t,this.next=void 0,this.val=i}function u(){}function c(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new l(u,0,0),this.tail=this.head,this.states=null}var d=function(){return o.Buffer?function(){return(h.create=function(){return new n})()}:function(){return new h}};function f(e,t,i){t[i]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,i){for(;e.hi;)t[i++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[i++]=127&e.lo|128,e.lo=e.lo>>>7;t[i++]=e.lo}function g(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}h.create=d(),h.alloc=function(e){return new o.Array(e)},o.Array!==Array&&(h.alloc=o.pool(h.alloc,o.Array.prototype.subarray)),h.prototype._push=function(e,t,i){return this.tail=this.tail.next=new l(e,t,i),this.len+=t,this},p.prototype=Object.create(l.prototype),p.prototype.fn=function(e,t,i){for(;e>127;)t[i++]=127&e|128,e>>>=7;t[i]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(m,10,r.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=r.from(e);return this._push(m,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=r.from(e).zzEncode();return this._push(m,t.length(),t)},h.prototype.bool=function(e){return this._push(f,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=r.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(o.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(o.float.writeDoubleLE,8,e)};var b=o.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(o.isString(e)){var i=h.alloc(t=a.length(e));a.decode(e,i,0),e=i}return this.uint32(t)._push(b,t,e)},h.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(f,1,0)},h.prototype.fork=function(){return this.states=new c(this),this.head=this.tail=new l(u,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(u,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t},h._configure=function(e){n=e,h.create=d(),n._configure()}},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof proxiesWindow&&(i=proxiesWindow)}e.exports=i},function(e,t,i){"use strict";e.exports=l;var n,o=i(5),r=o.LongBits,a=o.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var u,c="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},h=function(){return o.Buffer?function(e){return(l.create=function(e){return o.Buffer.isBuffer(e)?new n(e):c(e)})(e)}:c};function d(){var e=new r(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw s(this,8);return new r(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}l.create=h(),l.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,l.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return u}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return f(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|f(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw s(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,i):t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)},l.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){n=e,l.create=h(),n._configure();var t=o.Long?"toLong":"toNumber";o.merge(l.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},function(e,t,i){"use strict";var n=i(20),o=n.Reader,r=n.Writer,a=n.util,s=n.roots.default||(n.roots.default={});s.JitterTemplates=function(){function e(e){if(this.templates=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.templates=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=r.create()),null!=e.templates&&e.templates.length)for(var i=0;i<e.templates.length;++i)s.JitterTemplates.Template.encode(e.templates[i],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var i=void 0===t?e.len:e.pos+t,n=new s.JitterTemplates;e.pos<i;){var r=e.uint32();if(r>>>3==1)n.templates&&n.templates.length||(n.templates=[]),n.templates.push(s.JitterTemplates.Template.decode(e,e.uint32()));else e.skipType(7&r)}return n},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.templates&&e.hasOwnProperty("templates")){if(!Array.isArray(e.templates))return"templates: array expected";for(var t=0;t<e.templates.length;++t){var i=s.JitterTemplates.Template.verify(e.templates[t]);if(i)return"templates."+i}}return null},e.fromObject=function(e){if(e instanceof s.JitterTemplates)return e;var t=new s.JitterTemplates;if(e.templates){if(!Array.isArray(e.templates))throw TypeError(".JitterTemplates.templates: array expected");t.templates=[];for(var i=0;i<e.templates.length;++i){if("object"!=typeof e.templates[i])throw TypeError(".JitterTemplates.templates: object expected");t.templates[i]=s.JitterTemplates.Template.fromObject(e.templates[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.templates=[]),e.templates&&e.templates.length){i.templates=[];for(var n=0;n<e.templates.length;++n)i.templates[n]=s.JitterTemplates.Template.toObject(e.templates[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.Template=function(){function e(e){if(this.values=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.values=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=r.create()),null!=e.values&&e.values.length){t.uint32(10).fork();for(var i=0;i<e.values.length;++i)t.float(e.values[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var i=void 0===t?e.len:e.pos+t,n=new s.JitterTemplates.Template;e.pos<i;){var r=e.uint32();if(r>>>3==1)if(n.values&&n.values.length||(n.values=[]),2==(7&r))for(var a=e.uint32()+e.pos;e.pos<a;)n.values.push(e.float());else n.values.push(e.float());else e.skipType(7&r)}return n},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.values&&e.hasOwnProperty("values")){if(!Array.isArray(e.values))return"values: array expected";for(var t=0;t<e.values.length;++t)if("number"!=typeof e.values[t])return"values: number[] expected"}return null},e.fromObject=function(e){if(e instanceof s.JitterTemplates.Template)return e;var t=new s.JitterTemplates.Template;if(e.values){if(!Array.isArray(e.values))throw TypeError(".JitterTemplates.Template.values: array expected");t.values=[];for(var i=0;i<e.values.length;++i)t.values[i]=Number(e.values[i])}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.values=[]),e.values&&e.values.length){i.values=[];for(var n=0;n<e.values.length;++n)i.values[n]=t.json&&!isFinite(e.values[n])?String(e.values[n]):e.values[n]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e}(),e.exports=s},function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i(0),o=i(18),r=function(){function e(e){this.templates=[];for(var t=0,i=o.JitterTemplates.decode(e).templates;t<i.length;t++){var n=i[t];this.templates.push(n.values)}this.previousTemplate=this.getRandomTemplate(),this.currentTemplate=this.getRandomTemplate(),this.currentTemplateFrame=0}return e.prototype.getRandomTemplate=function(){return this.templates[Math.floor(Math.random()*this.templates.length)]},e.prototype.next=function(){var e=0;if(this.currentTemplateFrame<10){var t=this.previousTemplate.length-1-10+this.currentTemplateFrame,i=Object(n.o)(0,10,this.currentTemplateFrame);e=Object(n.q)(this.previousTemplate[t],this.currentTemplate[this.currentTemplateFrame],i)}else e=this.currentTemplate[this.currentTemplateFrame];return this.currentTemplateFrame=this.currentTemplateFrame+1,this.currentTemplateFrame>=this.currentTemplate.length-10&&(this.previousTemplate=this.currentTemplate,this.currentTemplate=this.getRandomTemplate(),this.currentTemplateFrame=0),e},e}(),a=i(10),s=i(1),l=function(){function e(e,t){this.objects=[];for(var i=0;i<t;++i)this.objects.push(e());this.index=0}return e.prototype.next=function(){return this.index=(this.index+1)%this.objects.length,this.objects[this.index]},e.prototype.head=function(){return this.objects[this.index]},e}(),u=function(){function e(e,t,i,o,s,u,c){this.onFrameUsed=null,this.lastSubsteps=1,this.jitter=new r(s),this.audioParameters=c,this.synthPointer=t,this.voiceIndex=i,this.singerIndex=o,this.voicePointer=e._synthGetVoice(t,i),this.gain=c.singers[this.singerIndex].gain,this.sampleRate=u,this.module=e,this.spectralFramePointers=new l((function(){return e._createSpectralFrame(258)}),100),this.excitationFramePointers=new l((function(){return e._createExcitationFrame(6)}),100),this.previousF0=440,this.nextExcitationFrames=[],this.nextSpectralFrames=[],this.lastOverrideFrequency=440,this.overrideF0s=[],this.overrideFrequency=!1,this.setSpectralFrameData(this.spectralFramePointers.next(),Object(n.f)(258,0),!0),this.setExcitationFrameData(this.excitationFramePointers.next(),Object(n.f)(4,-120),!0,!1);for(var h=0;h<c.excitationOffset;++h)this.setSpectralFrameData(this.spectralFramePointers.next(),Object(n.f)(258,0),!0);for(h=0;h<-c.excitationOffset;++h)this.setExcitationFrameData(this.excitationFramePointers.next(),Object(n.f)(4,-120),!0,!1);this.spectralGain=Object(a.b)(c.singers[this.singerIndex].spectralFilters)}return e.prototype.pushExcitationFrame=function(e){this.nextExcitationFrames.push(e)},e.prototype.pushSpectralFrame=function(e){this.nextSpectralFrames.push(e)},e.prototype.setSpectralFrameData=function(e,t,i){if(this.module._spectralFrameReset(e,i?1:0),!i)for(var n=this.module._spectralFrameGetSpectrogram(e),o=this.module.HEAPF32.subarray(n>>2,258+(n>>2)),r=0;r<258;++r)o[r]=t[r]},e.prototype.setExcitationFrameData=function(e,t,i,o){if(this.module._excitationFrameReset(e,i?1:0),!i){var r=this.module._excitationFrameGetAperiodic(e),a=this.module.HEAPF32.subarray(r>>2,6+(r>>2));a[0]=-60,a[5]=-1e-12;for(var l=0;l<4;++l)a[1+l]=s.a.aperiodicMin+(.5*t[l]+.5)*(s.a.aperiodicMax-s.a.aperiodicMin);var u=o?this.audioParameters.singers[this.singerIndex].aperiodicGain.consonant:this.audioParameters.singers[this.singerIndex].aperiodicGain.vowel;for(l=0;l<6;++l)a[l]+=u[l],a[l]=Math.pow(10,a[l]/10);var c=this.module._excitationFrameGetPeriodic(e),h=this.module.HEAPF32.subarray(c>>2,6+(c>>2));for(h[0]=-60,h[5]=-1e-12,l=0;l<4;++l)h[1+l]=s.a.aperiodicMin+(.5*t[l]+.5)*(s.a.aperiodicMax-s.a.aperiodicMin);for(l=0;l<6;++l)h[l]=Math.pow(10,h[l]/10),h[l]=1-h[l];var d=o?this.audioParameters.singers[this.singerIndex].periodicGain.consonant:this.audioParameters.singers[this.singerIndex].periodicGain.vowel;for(l=0;l<6;++l){var f=Object(n.b)(h[l],1e-8,.999999999);f=10*Math.log10(f),f+=d[l],h[l]=Math.pow(10,f/10)}}},e.prototype.setAudioParameters=function(e){this.audioParameters=e,this.spectralGain=Object(a.b)(e.singers[this.singerIndex].spectralFilters)},e.prototype.step=function(e){for(var t=0;1!==this.module._synthHasEnoughExcitationFrames(this.synthPointer,e,this.voiceIndex)||1!==this.module._synthHasEnoughSpectralFrames(this.synthPointer,e,this.voiceIndex);){var i=null;if(0!==this.nextSpectralFrames.length){var n=this.nextSpectralFrames[0];this.lastSubsteps=n.getSubsteps(),i=this.spectralFramePointers.next(),this.setSpectralFrameData(i,n.getSpectral(),n.getMuted()),this.onFrameUsed&&this.onFrameUsed(n.buffer),this.nextSpectralFrames.splice(0,1)}else i=this.spectralFramePointers.head();for(var o=0;o<this.lastSubsteps;++o)this.module._voiceAddSpectralFrame(this.voicePointer,i);for(var r=0;r<this.lastSubsteps;++r){var a=-1,l=!1;for(o=this.overrideF0s.length-1;o>=0;--o)if(t>this.overrideF0s[o].delay){a=this.overrideF0s[o].f0,this.lastOverrideFrequency=a,l=!0;break}if(!l&&this.overrideF0s.length>0&&(a=this.overrideF0s[0].f0,this.lastOverrideFrequency=a),-1===a&&(a=this.lastOverrideFrequency),this.overrideFrequency||(a=-1),0!==this.nextExcitationFrames.length){var u=(n=this.nextExcitationFrames[0]).getF0();a>0&&(u=a),this.previousF0=u;var c=u+this.jitter.next()*u*this.audioParameters.singers[this.singerIndex].jitterScale,h=this.excitationFramePointers.next();this.setExcitationFrameData(h,n.getAperiodic(),n.getMuted(),Object(s.d)(n.getPhoneme())),this.module._voiceAddExcitationFrame(this.voicePointer,c,h),this.onFrameUsed&&this.onFrameUsed(n.buffer),this.nextExcitationFrames.splice(0,1)}else{u=this.previousF0,a>0&&(u=a),this.previousF0=u,c=u+this.jitter.next()*u*this.audioParameters.singers[this.singerIndex].jitterScale;var d=this.excitationFramePointers.head();this.module._voiceAddExcitationFrame(this.voicePointer,c,d)}t+=this.audioParameters.frameHopSeconds}}this.overrideF0s.length=0},e.prototype.addOverrideF0=function(e,t){this.overrideF0s.push({f0:e,delay:t})},e}(),c=i(7),h=i(3),d=function(){function e(e,t,i,o,r,a,s,l,d){var f=this;this.onFrameUsed=null,this.module=t,this.sampleRate=r,this.processingSampleRate=a,this.bufferSize=d;for(var p=this.module._malloc(i.length),m=this.module.HEAPU8.subarray(p,p+i.length),g=0;g<i.length;++g)m[g]=i[g];var b,v=l.frameHopSeconds,y=v,x=(b=l.targetFFTSize*this.processingSampleRate/32e3,2*Math.ceil(b/2));for(this.synthPointer=this.module._createSynth(this.processingSampleRate,s,v,y,x,2,e,p,i.length),this.pans=Object(n.f)(e,0).map((function(e){return new h.a(e)})),this.voices=[],g=0;g<e;++g)this.voices.push(new u(t,this.synthPointer,g,g,o,this.processingSampleRate,l));for(var _=0,w=this.voices;_<w.length;_++)w[_].onFrameUsed=function(e){f.onFrameUsed&&f.onFrameUsed(e)};this.reverbContext=t._createDCReverbContext(this.processingSampleRate);var P=t.cwrap("heavySendMessage",null,["number","string","number","number"]);for(var S in l.reverb)P(this.reverbContext,S,l.reverb[S],0);P(this.reverbContext,"init",1,0),this.module._synthSetOnlyNoise(this.synthPointer,l.noiseExcitation?1:0),this.combinedBuffer=new c.a(t,2*this.bufferSize),this.outputBuffer=new c.a(t,2*this.bufferSize),this.lastAudioProcessTime=Date.now()}return e.prototype.setPans=function(e){for(var t=0;t<e.length;++t)this.pans[t].change(e[t],.5)},e.prototype.process=function(e,t){var i=t*this.processingSampleRate/this.sampleRate;this.module._clearBuffer(this.combinedBuffer.pointer,2*i);for(var n=0;n<this.voices.length;++n){this.voices[n].step(i);var o=this.pans[n].evaluate();o=o/180*Math.PI+Math.PI/4;var r=this.voices[n].gain,a=Math.cos(o)*r,s=Math.sin(o)*r;this.module._voiceSetGain(this.voices[n].voicePointer,0,a),this.module._voiceSetGain(this.voices[n].voicePointer,1,s)}this.module._synthStep(this.synthPointer,i),this.module._copyBuffer(this.module._synthGetBuffer(this.synthPointer,0),this.combinedBuffer.pointer,i,0,1),this.module._copyBuffer(this.module._synthGetBuffer(this.synthPointer,1),this.combinedBuffer.pointer,i,i,1),this.module._reverbContextProcess(this.reverbContext,this.combinedBuffer.pointer,this.outputBuffer.pointer,i);for(var l=this.outputBuffer.getArray(),u=this.sampleRate/this.processingSampleRate,c=0;c<2;++c){var h=e[c],d=c*i;if(1===u)for(var f=0;f<t;++f)h[f]=l[d+f];else if(2===u)for(f=0;f<i;++f)h[2*f+0]=l[d+f],h[2*f+1]=0;else for(f=0;f<i;++f){h[f*u+0]=l[d+f];for(var p=1;p<u;++p)h[f*u+p]=0}}this.lastAudioProcessTime=Date.now()},e.prototype.addSpectralFrame=function(e,t){this.voices[e].pushSpectralFrame(t)},e.prototype.addExcitationFrame=function(e,t){this.voices[e].pushExcitationFrame(t)},e.prototype.setOverrideFrequency=function(e,t){this.voices[e].overrideFrequency=t},e.prototype.addOverrideF0=function(e,t){this.voices[e].addOverrideF0(t,(Date.now()-this.lastAudioProcessTime)/1e3)},e.prototype.benchmarkSpectrumGeneration=function(e){var t=proxiesWindow.performance.now();this.voices[0].module._synthBenchmarkSpectrumGeneration(this.voices[0].synthPointer,e);var i=proxiesWindow.performance.now();console.log(i-t)},e.prototype.setAudioParameters=function(e){var t=this.module.cwrap("heavySendMessage",null,["number","string","number","number"]);for(var i in e.reverb)t(this.reverbContext,i,e.reverb[i],0);for(var n=0;n<this.voices.length;++n)this.voices[n].setAudioParameters(e);this.module._synthSetOnlyNoise(this.synthPointer,e.noiseExcitation?1:0)},e}()},function(e,t,i){"use strict";e.exports=i(21)},function(e,t,i){"use strict";var n=t;function o(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=i(15),n.BufferWriter=i(30),n.Reader=i(17),n.BufferReader=i(31),n.util=i(5),n.rpc=i(32),n.roots=i(34),n.configure=o,o()},function(e,t,i){"use strict";e.exports=function(e,t){for(var i=new Array(arguments.length-1),n=0,o=2,r=!0;o<arguments.length;)i[n++]=arguments[o++];return new Promise((function(o,a){i[n]=function(e){if(r)if(r=!1,e)a(e);else{for(var t=new Array(arguments.length-1),i=0;i<t.length;)t[i++]=arguments[i];o.apply(null,t)}};try{e.apply(t||null,i)}catch(e){r&&(r=!1,a(e))}}))}},function(e,t,i){"use strict";var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&"="===e.charAt(t);)++i;return Math.ceil(3*e.length)/4-i};for(var o=new Array(64),r=new Array(123),a=0;a<64;)r[o[a]=a<26?a+65:a<52?a+71:a<62?a-4:a-59|43]=a++;n.encode=function(e,t,i){for(var n,r=null,a=[],s=0,l=0;t<i;){var u=e[t++];switch(l){case 0:a[s++]=o[u>>2],n=(3&u)<<4,l=1;break;case 1:a[s++]=o[n|u>>4],n=(15&u)<<2,l=2;break;case 2:a[s++]=o[n|u>>6],a[s++]=o[63&u],l=0}s>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,a)),s=0)}return l&&(a[s++]=o[n],a[s++]=61,1===l&&(a[s++]=61)),r?(s&&r.push(String.fromCharCode.apply(String,a.slice(0,s))),r.join("")):String.fromCharCode.apply(String,a.slice(0,s))},n.decode=function(e,t,i){for(var n,o=i,a=0,s=0;s<e.length;){var l=e.charCodeAt(s++);if(61===l&&a>1)break;if(void 0===(l=r[l]))throw Error("invalid encoding");switch(a){case 0:n=l,a=1;break;case 1:t[i++]=n<<2|(48&l)>>4,n=l,a=2;break;case 2:t[i++]=(15&n)<<4|(60&l)>>2,n=l,a=3;break;case 3:t[i++]=(3&n)<<6|l,a=0}}if(1===a)throw Error("invalid encoding");return i-o},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},function(e,t,i){"use strict";function n(){this._listeners={}}e.exports=n,n.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this},n.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this},n.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this}},function(e,t,i){"use strict";function n(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),i=new Uint8Array(t.buffer),n=128===i[3];function o(e,n,o){t[0]=e,n[o]=i[0],n[o+1]=i[1],n[o+2]=i[2],n[o+3]=i[3]}function r(e,n,o){t[0]=e,n[o]=i[3],n[o+1]=i[2],n[o+2]=i[1],n[o+3]=i[0]}function a(e,n){return i[0]=e[n],i[1]=e[n+1],i[2]=e[n+2],i[3]=e[n+3],t[0]}function s(e,n){return i[3]=e[n],i[2]=e[n+1],i[1]=e[n+2],i[0]=e[n+3],t[0]}e.writeFloatLE=n?o:r,e.writeFloatBE=n?r:o,e.readFloatLE=n?a:s,e.readFloatBE=n?s:a}():function(){function t(e,t,i,n){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,i,n);else if(isNaN(t))e(2143289344,i,n);else if(t>34028234663852886e22)e((o<<31|2139095040)>>>0,i,n);else if(t<11754943508222875e-54)e((o<<31|Math.round(t/1401298464324817e-60))>>>0,i,n);else{var r=Math.floor(Math.log(t)/Math.LN2);e((o<<31|r+127<<23|8388607&Math.round(t*Math.pow(2,-r)*8388608))>>>0,i,n)}}function i(e,t,i){var n=e(t,i),o=2*(n>>31)+1,r=n>>>23&255,a=8388607&n;return 255===r?a?NaN:o*(1/0):0===r?1401298464324817e-60*o*a:o*Math.pow(2,r-150)*(a+8388608)}e.writeFloatLE=t.bind(null,o),e.writeFloatBE=t.bind(null,r),e.readFloatLE=i.bind(null,a),e.readFloatBE=i.bind(null,s)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),i=new Uint8Array(t.buffer),n=128===i[7];function o(e,n,o){t[0]=e,n[o]=i[0],n[o+1]=i[1],n[o+2]=i[2],n[o+3]=i[3],n[o+4]=i[4],n[o+5]=i[5],n[o+6]=i[6],n[o+7]=i[7]}function r(e,n,o){t[0]=e,n[o]=i[7],n[o+1]=i[6],n[o+2]=i[5],n[o+3]=i[4],n[o+4]=i[3],n[o+5]=i[2],n[o+6]=i[1],n[o+7]=i[0]}function a(e,n){return i[0]=e[n],i[1]=e[n+1],i[2]=e[n+2],i[3]=e[n+3],i[4]=e[n+4],i[5]=e[n+5],i[6]=e[n+6],i[7]=e[n+7],t[0]}function s(e,n){return i[7]=e[n],i[6]=e[n+1],i[5]=e[n+2],i[4]=e[n+3],i[3]=e[n+4],i[2]=e[n+5],i[1]=e[n+6],i[0]=e[n+7],t[0]}e.writeDoubleLE=n?o:r,e.writeDoubleBE=n?r:o,e.readDoubleLE=n?a:s,e.readDoubleBE=n?s:a}():function(){function t(e,t,i,n,o,r){var a=n<0?1:0;if(a&&(n=-n),0===n)e(0,o,r+t),e(1/n>0?0:2147483648,o,r+i);else if(isNaN(n))e(0,o,r+t),e(2146959360,o,r+i);else if(n>17976931348623157e292)e(0,o,r+t),e((a<<31|2146435072)>>>0,o,r+i);else{var s;if(n<22250738585072014e-324)e((s=n/5e-324)>>>0,o,r+t),e((a<<31|s/4294967296)>>>0,o,r+i);else{var l=Math.floor(Math.log(n)/Math.LN2);1024===l&&(l=1023),e(4503599627370496*(s=n*Math.pow(2,-l))>>>0,o,r+t),e((a<<31|l+1023<<20|1048576*s&1048575)>>>0,o,r+i)}}}function i(e,t,i,n,o){var r=e(n,o+t),a=e(n,o+i),s=2*(a>>31)+1,l=a>>>20&2047,u=4294967296*(1048575&a)+r;return 2047===l?u?NaN:s*(1/0):0===l?5e-324*s*u:s*Math.pow(2,l-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,o,0,4),e.writeDoubleBE=t.bind(null,r,4,0),e.readDoubleLE=i.bind(null,a,0,4),e.readDoubleBE=i.bind(null,s,4,0)}(),e}function o(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}function r(e,t,i){t[i]=e>>>24,t[i+1]=e>>>16&255,t[i+2]=e>>>8&255,t[i+3]=255&e}function a(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=n(n)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(e,t,i){"use strict";var n=t;n.length=function(e){for(var t=0,i=0,n=0;n<e.length;++n)(i=e.charCodeAt(n))<128?t+=1:i<2048?t+=2:55296==(64512&i)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},n.read=function(e,t,i){if(i-t<1)return"";for(var n,o=null,r=[],a=0;t<i;)(n=e[t++])<128?r[a++]=n:n>191&&n<224?r[a++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,r[a++]=55296+(n>>10),r[a++]=56320+(1023&n)):r[a++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,r)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,r.slice(0,a))),o.join("")):String.fromCharCode.apply(String,r.slice(0,a))},n.write=function(e,t,i){for(var n,o,r=i,a=0;a<e.length;++a)(n=e.charCodeAt(a))<128?t[i++]=n:n<2048?(t[i++]=n>>6|192,t[i++]=63&n|128):55296==(64512&n)&&56320==(64512&(o=e.charCodeAt(a+1)))?(n=65536+((1023&n)<<10)+(1023&o),++a,t[i++]=n>>18|240,t[i++]=n>>12&63|128,t[i++]=n>>6&63|128,t[i++]=63&n|128):(t[i++]=n>>12|224,t[i++]=n>>6&63|128,t[i++]=63&n|128);return i-r}},function(e,t,i){"use strict";e.exports=function(e,t,i){var n=i||8192,o=n>>>1,r=null,a=n;return function(i){if(i<1||i>o)return e(i);a+i>n&&(r=e(n),a=0);var s=t.call(r,a,a+=i);return 7&a&&(a=1+(7|a)),s}}},function(e,t,i){"use strict";e.exports=o;var n=i(5);function o(e,t){this.lo=e>>>0,this.hi=t>>>0}var r=o.zero=new o(0,0);r.toNumber=function(){return 0},r.zzEncode=r.zzDecode=function(){return this},r.length=function(){return 1};var a=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(e){if(0===e)return r;var t=e<0;t&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return t&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new o(i,n)},o.from=function(e){if("number"==typeof e)return o.fromNumber(e);if(n.isString(e)){if(!n.Long)return o.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new o(e.low>>>0,e.high>>>0):r},o.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+4294967296*i)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;o.fromHash=function(e){return e===a?r:new o((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},o.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},o.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return 0===i?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}},function(e,t,i){"use strict";e.exports=r;var n=i(15);(r.prototype=Object.create(n.prototype)).constructor=r;var o=i(5);function r(){n.call(this)}function a(e,t,i){e.length<40?o.utf8.write(e,t,i):t.utf8Write?t.utf8Write(e,i):t.write(e,i)}r._configure=function(){r.alloc=o._Buffer_allocUnsafe,r.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&"set"===o.Buffer.prototype.set.name?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]}},r.prototype.bytes=function(e){o.isString(e)&&(e=o._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(r.writeBytesBuffer,t,e),this},r.prototype.string=function(e){var t=o.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},r._configure()},function(e,t,i){"use strict";e.exports=r;var n=i(17);(r.prototype=Object.create(n.prototype)).constructor=r;var o=i(5);function r(e){n.call(this,e)}r._configure=function(){o.Buffer&&(r.prototype._slice=o.Buffer.prototype.slice)},r.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},r._configure()},function(e,t,i){"use strict";t.Service=i(33)},function(e,t,i){"use strict";e.exports=o;var n=i(5);function o(e,t,i){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(i)}(o.prototype=Object.create(n.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function e(t,i,o,r,a){if(!r)throw TypeError("request must be specified");var s=this;if(!a)return n.asPromise(e,s,t,i,o,r);if(s.rpcImpl)try{return s.rpcImpl(t,i[s.requestDelimited?"encodeDelimited":"encode"](r).finish(),(function(e,i){if(e)return s.emit("error",e,t),a(e);if(null!==i){if(!(i instanceof o))try{i=o[s.responseDelimited?"decodeDelimited":"decode"](i)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",i,t),a(null,i)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){a(e)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,t,i){"use strict";e.exports={}},,function(e,t,i){"use strict";var n=i(20),o=n.Reader,r=n.Writer,a=n.util,s=n.roots.default||(n.roots.default={});s.RecordedLibrettos=function(){function e(e){if(this.librettos=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}var t,i;return e.prototype.librettos=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=r.create()),null!=e.librettos&&e.librettos.length)for(var i=0;i<e.librettos.length;++i)s.RecordedLibrettos.RecordedLibretto.encode(e.librettos[i],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var i=void 0===t?e.len:e.pos+t,n=new s.RecordedLibrettos;e.pos<i;){var r=e.uint32();if(r>>>3==1)n.librettos&&n.librettos.length||(n.librettos=[]),n.librettos.push(s.RecordedLibrettos.RecordedLibretto.decode(e,e.uint32()));else e.skipType(7&r)}return n},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.librettos&&e.hasOwnProperty("librettos")){if(!Array.isArray(e.librettos))return"librettos: array expected";for(var t=0;t<e.librettos.length;++t){var i=s.RecordedLibrettos.RecordedLibretto.verify(e.librettos[t]);if(i)return"librettos."+i}}return null},e.fromObject=function(e){if(e instanceof s.RecordedLibrettos)return e;var t=new s.RecordedLibrettos;if(e.librettos){if(!Array.isArray(e.librettos))throw TypeError(".RecordedLibrettos.librettos: array expected");t.librettos=[];for(var i=0;i<e.librettos.length;++i){if("object"!=typeof e.librettos[i])throw TypeError(".RecordedLibrettos.librettos: object expected");t.librettos[i]=s.RecordedLibrettos.RecordedLibretto.fromObject(e.librettos[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.librettos=[]),e.librettos&&e.librettos.length){i.librettos=[];for(var n=0;n<e.librettos.length;++n)i.librettos[n]=s.RecordedLibrettos.RecordedLibretto.toObject(e.librettos[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.Phoneme=(t={},(i=Object.create(t))[t[0]="i"]=0,i[t[1]="a"]=1,i[t[2]="e"]=2,i[t[3]="o"]=3,i[t[4]="sil"]=4,i[t[5]="r"]=5,i[t[6]="n"]=6,i[t[7]="l"]=7,i[t[8]="t"]=8,i[t[9]="s"]=9,i[t[10]="d"]=10,i[t[11]="u"]=11,i[t[12]="m"]=12,i[t[13]="p"]=13,i[t[14]="v"]=14,i[t[15]="ch"]=15,i[t[16]="c"]=16,i[t[17]="f"]=17,i[t[18]="j"]=18,i[t[19]="b"]=19,i[t[20]="h"]=20,i[t[21]="g"]=21,i[t[22]="qu"]=22,i[t[23]="sh"]=23,i[t[24]="ny"]=24,i[t[25]="y"]=25,i[t[26]="sk"]=26,i[t[27]="z"]=27,i[t[28]="tz"]=28,i),e.Note=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name=0,e.prototype.startTimeSeconds=0,e.prototype.endTimeSeconds=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),t.uint32(8).int32(e.name),t.uint32(21).float(e.startTimeSeconds),t.uint32(29).float(e.endTimeSeconds),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var i=void 0===t?e.len:e.pos+t,n=new s.RecordedLibrettos.Note;e.pos<i;){var r=e.uint32();switch(r>>>3){case 1:n.name=e.int32();break;case 2:n.startTimeSeconds=e.float();break;case 3:n.endTimeSeconds=e.float();break;default:e.skipType(7&r)}}if(!n.hasOwnProperty("name"))throw a.ProtocolError("missing required 'name'",{instance:n});if(!n.hasOwnProperty("startTimeSeconds"))throw a.ProtocolError("missing required 'startTimeSeconds'",{instance:n});if(!n.hasOwnProperty("endTimeSeconds"))throw a.ProtocolError("missing required 'endTimeSeconds'",{instance:n});return n},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";switch(e.name){default:return"name: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:}return"number"!=typeof e.startTimeSeconds?"startTimeSeconds: number expected":"number"!=typeof e.endTimeSeconds?"endTimeSeconds: number expected":null},e.fromObject=function(e){if(e instanceof s.RecordedLibrettos.Note)return e;var t=new s.RecordedLibrettos.Note;switch(e.name){case"i":case 0:t.name=0;break;case"a":case 1:t.name=1;break;case"e":case 2:t.name=2;break;case"o":case 3:t.name=3;break;case"sil":case 4:t.name=4;break;case"r":case 5:t.name=5;break;case"n":case 6:t.name=6;break;case"l":case 7:t.name=7;break;case"t":case 8:t.name=8;break;case"s":case 9:t.name=9;break;case"d":case 10:t.name=10;break;case"u":case 11:t.name=11;break;case"m":case 12:t.name=12;break;case"p":case 13:t.name=13;break;case"v":case 14:t.name=14;break;case"ch":case 15:t.name=15;break;case"c":case 16:t.name=16;break;case"f":case 17:t.name=17;break;case"j":case 18:t.name=18;break;case"b":case 19:t.name=19;break;case"h":case 20:t.name=20;break;case"g":case 21:t.name=21;break;case"qu":case 22:t.name=22;break;case"sh":case 23:t.name=23;break;case"ny":case 24:t.name=24;break;case"y":case 25:t.name=25;break;case"sk":case 26:t.name=26;break;case"z":case 27:t.name=27;break;case"tz":case 28:t.name=28}return null!=e.startTimeSeconds&&(t.startTimeSeconds=Number(e.startTimeSeconds)),null!=e.endTimeSeconds&&(t.endTimeSeconds=Number(e.endTimeSeconds)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.name=t.enums===String?"i":0,i.startTimeSeconds=0,i.endTimeSeconds=0),null!=e.name&&e.hasOwnProperty("name")&&(i.name=t.enums===String?s.RecordedLibrettos.Phoneme[e.name]:e.name),null!=e.startTimeSeconds&&e.hasOwnProperty("startTimeSeconds")&&(i.startTimeSeconds=t.json&&!isFinite(e.startTimeSeconds)?String(e.startTimeSeconds):e.startTimeSeconds),null!=e.endTimeSeconds&&e.hasOwnProperty("endTimeSeconds")&&(i.endTimeSeconds=t.json&&!isFinite(e.endTimeSeconds)?String(e.endTimeSeconds):e.endTimeSeconds),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RecordedLibretto=function(){function e(e){if(this.notes=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.notes=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=r.create()),null!=e.notes&&e.notes.length)for(var i=0;i<e.notes.length;++i)s.RecordedLibrettos.Note.encode(e.notes[i],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var i=void 0===t?e.len:e.pos+t,n=new s.RecordedLibrettos.RecordedLibretto;e.pos<i;){var r=e.uint32();if(r>>>3==1)n.notes&&n.notes.length||(n.notes=[]),n.notes.push(s.RecordedLibrettos.Note.decode(e,e.uint32()));else e.skipType(7&r)}return n},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.notes&&e.hasOwnProperty("notes")){if(!Array.isArray(e.notes))return"notes: array expected";for(var t=0;t<e.notes.length;++t){var i=s.RecordedLibrettos.Note.verify(e.notes[t]);if(i)return"notes."+i}}return null},e.fromObject=function(e){if(e instanceof s.RecordedLibrettos.RecordedLibretto)return e;var t=new s.RecordedLibrettos.RecordedLibretto;if(e.notes){if(!Array.isArray(e.notes))throw TypeError(".RecordedLibrettos.RecordedLibretto.notes: array expected");t.notes=[];for(var i=0;i<e.notes.length;++i){if("object"!=typeof e.notes[i])throw TypeError(".RecordedLibrettos.RecordedLibretto.notes: object expected");t.notes[i]=s.RecordedLibrettos.Note.fromObject(e.notes[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.notes=[]),e.notes&&e.notes.length){i.notes=[];for(var n=0;n<e.notes.length;++n)i.notes[n]=s.RecordedLibrettos.Note.toObject(e.notes[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e}(),e.exports=s},function(e,t,i){"use strict";var n=i(20),o=n.Reader,r=n.Writer,a=n.util,s=n.roots.default||(n.roots.default={});s.RecordingMessage=function(){function e(e){if(this.parts=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}var t,i;return e.prototype.theme=0,e.prototype.parts=a.emptyArray,e.prototype.location=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=r.create()),t.uint32(8).int32(e.theme),null!=e.parts&&e.parts.length)for(var i=0;i<e.parts.length;++i)s.RecordingMessage.Part.encode(e.parts[i],t.uint32(18).fork()).ldelim();return null!=e.location&&Object.hasOwnProperty.call(e,"location")&&t.uint32(24).int32(e.location),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var i=void 0===t?e.len:e.pos+t,n=new s.RecordingMessage;e.pos<i;){var r=e.uint32();switch(r>>>3){case 1:n.theme=e.int32();break;case 2:n.parts&&n.parts.length||(n.parts=[]),n.parts.push(s.RecordingMessage.Part.decode(e,e.uint32()));break;case 3:n.location=e.int32();break;default:e.skipType(7&r)}}if(!n.hasOwnProperty("theme"))throw a.ProtocolError("missing required 'theme'",{instance:n});return n},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";switch(e.theme){default:return"theme: enum value expected";case 0:case 1:case 2:}if(null!=e.parts&&e.hasOwnProperty("parts")){if(!Array.isArray(e.parts))return"parts: array expected";for(var t=0;t<e.parts.length;++t){var i=s.RecordingMessage.Part.verify(e.parts[t]);if(i)return"parts."+i}}if(null!=e.location&&e.hasOwnProperty("location"))switch(e.location){default:return"location: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:}return null},e.fromObject=function(e){if(e instanceof s.RecordingMessage)return e;var t=new s.RecordingMessage;switch(e.theme){case"Normal":case 0:t.theme=0;break;case"Christmas":case 1:t.theme=1;break;case"NewYears":case 2:t.theme=2}if(e.parts){if(!Array.isArray(e.parts))throw TypeError(".RecordingMessage.parts: array expected");t.parts=[];for(var i=0;i<e.parts.length;++i){if("object"!=typeof e.parts[i])throw TypeError(".RecordingMessage.parts: object expected");t.parts[i]=s.RecordingMessage.Part.fromObject(e.parts[i])}}switch(e.location){case"BlobperaHouse":case 0:t.location=0;break;case"London":case 1:t.location=1;break;case"NewYork":case 2:t.location=2;break;case"Hackney":case 3:t.location=3;break;case"Paris":case 4:t.location=4;break;case"CapeTown":case 5:t.location=5;break;case"MexicoCity":case 6:t.location=6;break;case"Seoul":case 7:t.location=7}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.parts=[]),t.defaults&&(i.theme=t.enums===String?"Normal":0,i.location=t.enums===String?"BlobperaHouse":0),null!=e.theme&&e.hasOwnProperty("theme")&&(i.theme=t.enums===String?s.RecordingMessage.Theme[e.theme]:e.theme),e.parts&&e.parts.length){i.parts=[];for(var n=0;n<e.parts.length;++n)i.parts[n]=s.RecordingMessage.Part.toObject(e.parts[n],t)}return null!=e.location&&e.hasOwnProperty("location")&&(i.location=t.enums===String?s.RecordingMessage.Location[e.location]:e.location),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.Phoneme=(t={},(i=Object.create(t))[t[0]="i"]=0,i[t[1]="a"]=1,i[t[2]="e"]=2,i[t[3]="o"]=3,i[t[4]="sil"]=4,i[t[5]="r"]=5,i[t[6]="n"]=6,i[t[7]="l"]=7,i[t[8]="t"]=8,i[t[9]="s"]=9,i[t[10]="d"]=10,i[t[11]="u"]=11,i[t[12]="m"]=12,i[t[13]="p"]=13,i[t[14]="v"]=14,i[t[15]="ch"]=15,i[t[16]="c"]=16,i[t[17]="f"]=17,i[t[18]="j"]=18,i[t[19]="b"]=19,i[t[20]="h"]=20,i[t[21]="g"]=21,i[t[22]="qu"]=22,i[t[23]="sh"]=23,i[t[24]="ny"]=24,i[t[25]="y"]=25,i[t[26]="sk"]=26,i[t[27]="z"]=27,i[t[28]="tz"]=28,i),e.PhonemeWithDuration=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name=0,e.prototype.duration=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),t.uint32(8).int32(e.name),t.uint32(21).float(e.duration),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var i=void 0===t?e.len:e.pos+t,n=new s.RecordingMessage.PhonemeWithDuration;e.pos<i;){var r=e.uint32();switch(r>>>3){case 1:n.name=e.int32();break;case 2:n.duration=e.float();break;default:e.skipType(7&r)}}if(!n.hasOwnProperty("name"))throw a.ProtocolError("missing required 'name'",{instance:n});if(!n.hasOwnProperty("duration"))throw a.ProtocolError("missing required 'duration'",{instance:n});return n},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";switch(e.name){default:return"name: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:}return"number"!=typeof e.duration?"duration: number expected":null},e.fromObject=function(e){if(e instanceof s.RecordingMessage.PhonemeWithDuration)return e;var t=new s.RecordingMessage.PhonemeWithDuration;switch(e.name){case"i":case 0:t.name=0;break;case"a":case 1:t.name=1;break;case"e":case 2:t.name=2;break;case"o":case 3:t.name=3;break;case"sil":case 4:t.name=4;break;case"r":case 5:t.name=5;break;case"n":case 6:t.name=6;break;case"l":case 7:t.name=7;break;case"t":case 8:t.name=8;break;case"s":case 9:t.name=9;break;case"d":case 10:t.name=10;break;case"u":case 11:t.name=11;break;case"m":case 12:t.name=12;break;case"p":case 13:t.name=13;break;case"v":case 14:t.name=14;break;case"ch":case 15:t.name=15;break;case"c":case 16:t.name=16;break;case"f":case 17:t.name=17;break;case"j":case 18:t.name=18;break;case"b":case 19:t.name=19;break;case"h":case 20:t.name=20;break;case"g":case 21:t.name=21;break;case"qu":case 22:t.name=22;break;case"sh":case 23:t.name=23;break;case"ny":case 24:t.name=24;break;case"y":case 25:t.name=25;break;case"sk":case 26:t.name=26;break;case"z":case 27:t.name=27;break;case"tz":case 28:t.name=28}return null!=e.duration&&(t.duration=Number(e.duration)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.name=t.enums===String?"i":0,i.duration=0),null!=e.name&&e.hasOwnProperty("name")&&(i.name=t.enums===String?s.RecordingMessage.Phoneme[e.name]:e.name),null!=e.duration&&e.hasOwnProperty("duration")&&(i.duration=t.json&&!isFinite(e.duration)?String(e.duration):e.duration),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.LibrettoChunk=function(){function e(e){if(this.suffix=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.vowel=null,e.prototype.suffix=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=r.create()),s.RecordingMessage.PhonemeWithDuration.encode(e.vowel,t.uint32(10).fork()).ldelim(),null!=e.suffix&&e.suffix.length)for(var i=0;i<e.suffix.length;++i)s.RecordingMessage.PhonemeWithDuration.encode(e.suffix[i],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var i=void 0===t?e.len:e.pos+t,n=new s.RecordingMessage.LibrettoChunk;e.pos<i;){var r=e.uint32();switch(r>>>3){case 1:n.vowel=s.RecordingMessage.PhonemeWithDuration.decode(e,e.uint32());break;case 2:n.suffix&&n.suffix.length||(n.suffix=[]),n.suffix.push(s.RecordingMessage.PhonemeWithDuration.decode(e,e.uint32()));break;default:e.skipType(7&r)}}if(!n.hasOwnProperty("vowel"))throw a.ProtocolError("missing required 'vowel'",{instance:n});return n},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(i=s.RecordingMessage.PhonemeWithDuration.verify(e.vowel))return"vowel."+i;if(null!=e.suffix&&e.hasOwnProperty("suffix")){if(!Array.isArray(e.suffix))return"suffix: array expected";for(var t=0;t<e.suffix.length;++t){var i;if(i=s.RecordingMessage.PhonemeWithDuration.verify(e.suffix[t]))return"suffix."+i}}return null},e.fromObject=function(e){if(e instanceof s.RecordingMessage.LibrettoChunk)return e;var t=new s.RecordingMessage.LibrettoChunk;if(null!=e.vowel){if("object"!=typeof e.vowel)throw TypeError(".RecordingMessage.LibrettoChunk.vowel: object expected");t.vowel=s.RecordingMessage.PhonemeWithDuration.fromObject(e.vowel)}if(e.suffix){if(!Array.isArray(e.suffix))throw TypeError(".RecordingMessage.LibrettoChunk.suffix: array expected");t.suffix=[];for(var i=0;i<e.suffix.length;++i){if("object"!=typeof e.suffix[i])throw TypeError(".RecordingMessage.LibrettoChunk.suffix: object expected");t.suffix[i]=s.RecordingMessage.PhonemeWithDuration.fromObject(e.suffix[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.suffix=[]),t.defaults&&(i.vowel=null),null!=e.vowel&&e.hasOwnProperty("vowel")&&(i.vowel=s.RecordingMessage.PhonemeWithDuration.toObject(e.vowel,t)),e.suffix&&e.suffix.length){i.suffix=[];for(var n=0;n<e.suffix.length;++n)i.suffix[n]=s.RecordingMessage.PhonemeWithDuration.toObject(e.suffix[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.Note=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeSeconds=0,e.prototype.midiPitch=0,e.prototype.librettoChunk=null,e.prototype.controlled=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),t.uint32(13).float(e.timeSeconds),t.uint32(21).float(e.midiPitch),s.RecordingMessage.LibrettoChunk.encode(e.librettoChunk,t.uint32(26).fork()).ldelim(),null!=e.controlled&&Object.hasOwnProperty.call(e,"controlled")&&t.uint32(32).bool(e.controlled),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var i=void 0===t?e.len:e.pos+t,n=new s.RecordingMessage.Note;e.pos<i;){var r=e.uint32();switch(r>>>3){case 1:n.timeSeconds=e.float();break;case 2:n.midiPitch=e.float();break;case 3:n.librettoChunk=s.RecordingMessage.LibrettoChunk.decode(e,e.uint32());break;case 4:n.controlled=e.bool();break;default:e.skipType(7&r)}}if(!n.hasOwnProperty("timeSeconds"))throw a.ProtocolError("missing required 'timeSeconds'",{instance:n});if(!n.hasOwnProperty("midiPitch"))throw a.ProtocolError("missing required 'midiPitch'",{instance:n});if(!n.hasOwnProperty("librettoChunk"))throw a.ProtocolError("missing required 'librettoChunk'",{instance:n});return n},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if("number"!=typeof e.timeSeconds)return"timeSeconds: number expected";if("number"!=typeof e.midiPitch)return"midiPitch: number expected";var t=s.RecordingMessage.LibrettoChunk.verify(e.librettoChunk);return t?"librettoChunk."+t:null!=e.controlled&&e.hasOwnProperty("controlled")&&"boolean"!=typeof e.controlled?"controlled: boolean expected":null},e.fromObject=function(e){if(e instanceof s.RecordingMessage.Note)return e;var t=new s.RecordingMessage.Note;if(null!=e.timeSeconds&&(t.timeSeconds=Number(e.timeSeconds)),null!=e.midiPitch&&(t.midiPitch=Number(e.midiPitch)),null!=e.librettoChunk){if("object"!=typeof e.librettoChunk)throw TypeError(".RecordingMessage.Note.librettoChunk: object expected");t.librettoChunk=s.RecordingMessage.LibrettoChunk.fromObject(e.librettoChunk)}return null!=e.controlled&&(t.controlled=Boolean(e.controlled)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.timeSeconds=0,i.midiPitch=0,i.librettoChunk=null,i.controlled=!1),null!=e.timeSeconds&&e.hasOwnProperty("timeSeconds")&&(i.timeSeconds=t.json&&!isFinite(e.timeSeconds)?String(e.timeSeconds):e.timeSeconds),null!=e.midiPitch&&e.hasOwnProperty("midiPitch")&&(i.midiPitch=t.json&&!isFinite(e.midiPitch)?String(e.midiPitch):e.midiPitch),null!=e.librettoChunk&&e.hasOwnProperty("librettoChunk")&&(i.librettoChunk=s.RecordingMessage.LibrettoChunk.toObject(e.librettoChunk,t)),null!=e.controlled&&e.hasOwnProperty("controlled")&&(i.controlled=e.controlled),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.Part=function(){function e(e){if(this.notes=[],this.startSuffix=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.notes=a.emptyArray,e.prototype.startSuffix=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=r.create()),null!=e.notes&&e.notes.length)for(var i=0;i<e.notes.length;++i)s.RecordingMessage.Note.encode(e.notes[i],t.uint32(10).fork()).ldelim();if(null!=e.startSuffix&&e.startSuffix.length)for(i=0;i<e.startSuffix.length;++i)s.RecordingMessage.PhonemeWithDuration.encode(e.startSuffix[i],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var i=void 0===t?e.len:e.pos+t,n=new s.RecordingMessage.Part;e.pos<i;){var r=e.uint32();switch(r>>>3){case 1:n.notes&&n.notes.length||(n.notes=[]),n.notes.push(s.RecordingMessage.Note.decode(e,e.uint32()));break;case 2:n.startSuffix&&n.startSuffix.length||(n.startSuffix=[]),n.startSuffix.push(s.RecordingMessage.PhonemeWithDuration.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return n},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.notes&&e.hasOwnProperty("notes")){if(!Array.isArray(e.notes))return"notes: array expected";for(var t=0;t<e.notes.length;++t)if(i=s.RecordingMessage.Note.verify(e.notes[t]))return"notes."+i}if(null!=e.startSuffix&&e.hasOwnProperty("startSuffix")){if(!Array.isArray(e.startSuffix))return"startSuffix: array expected";for(t=0;t<e.startSuffix.length;++t){var i;if(i=s.RecordingMessage.PhonemeWithDuration.verify(e.startSuffix[t]))return"startSuffix."+i}}return null},e.fromObject=function(e){if(e instanceof s.RecordingMessage.Part)return e;var t=new s.RecordingMessage.Part;if(e.notes){if(!Array.isArray(e.notes))throw TypeError(".RecordingMessage.Part.notes: array expected");t.notes=[];for(var i=0;i<e.notes.length;++i){if("object"!=typeof e.notes[i])throw TypeError(".RecordingMessage.Part.notes: object expected");t.notes[i]=s.RecordingMessage.Note.fromObject(e.notes[i])}}if(e.startSuffix){if(!Array.isArray(e.startSuffix))throw TypeError(".RecordingMessage.Part.startSuffix: array expected");for(t.startSuffix=[],i=0;i<e.startSuffix.length;++i){if("object"!=typeof e.startSuffix[i])throw TypeError(".RecordingMessage.Part.startSuffix: object expected");t.startSuffix[i]=s.RecordingMessage.PhonemeWithDuration.fromObject(e.startSuffix[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.notes=[],i.startSuffix=[]),e.notes&&e.notes.length){i.notes=[];for(var n=0;n<e.notes.length;++n)i.notes[n]=s.RecordingMessage.Note.toObject(e.notes[n],t)}if(e.startSuffix&&e.startSuffix.length)for(i.startSuffix=[],n=0;n<e.startSuffix.length;++n)i.startSuffix[n]=s.RecordingMessage.PhonemeWithDuration.toObject(e.startSuffix[n],t);return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.Theme=function(){var e={},t=Object.create(e);return t[e[0]="Normal"]=0,t[e[1]="Christmas"]=1,t[e[2]="NewYears"]=2,t}(),e.Location=function(){var e={},t=Object.create(e);return t[e[0]="BlobperaHouse"]=0,t[e[1]="London"]=1,t[e[2]="NewYork"]=2,t[e[3]="Hackney"]=3,t[e[4]="Paris"]=4,t[e[5]="CapeTown"]=5,t[e[6]="MexicoCity"]=6,t[e[7]="Seoul"]=7,t}(),e}(),e.exports=s},function(e,t,i){"use strict";var n=i(41),o=i.n(n)()((function(e){return e[1]}));o.push([e.i,'html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:"";content:none}table{border-collapse:collapse;border-spacing:0}.prompt{position:fixed;color:#000;font-weight:300;font-size:16px;line-height:20px;padding:10px;text-align:center;background:#ffffffcc;border-radius:10px;z-index:1}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.prompt{font-size:12px;line-height:16px;padding:6px}}.voice-prompt{will-change:transform;transform:translateZ(0)}#pitch-prompt{will-change:transform;transform:translateZ(0)}.voice-prompt span{font-weight:800}#pitch-prompt-pitch{font-weight:400;transition:font-weight .1s linear}#pitch-prompt-pitch.sounding{font-weight:600}.prompt-right-arrow{margin-left:10px}.prompt-right-arrow:after{position:absolute;left:100%;border-top:5px solid transparent;border-bottom:5px solid transparent;border-left:5px solid #ffffffcc;content:" ";margin-top:-5px;top:50%}.prompt-left-arrow{margin-right:10px}.prompt-left-arrow:after{position:absolute;right:100%;border-top:5px solid transparent;border-bottom:5px solid transparent;border-right:5px solid #ffffffcc;content:" ";margin-top:-5px;top:50%}.prompt-bottom-arrow:after{position:absolute;top:100%;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid #ffffffcc;content:" ";margin-left:-5px;left:50%}#vowel-prompt{transform:translate(-50%, 0)}#vowel-prompt-vowel{font-weight:400;transition:font-weight .1s linear}#vowel-prompt-vowel.sounding{font-weight:600}#stop-recording-prompt{left:90px;bottom:45px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#stop-recording-prompt{left:75px;bottom:40px}}.share-prompt{bottom:100px;left:105px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.share-prompt{left:85px;bottom:80px}}.share-prompt:after{left:25px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.share-prompt:after{left:15px}}#festive-prompt{bottom:85px;right:90px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#festive-prompt{bottom:75px;right:85px}}#festive-prompt:after{left:auto;right:30px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#festive-prompt:after{right:20px}}#carols-prompt{bottom:100px;right:100px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#carols-prompt{bottom:80px;right:90px}}#carols-prompt:after{left:auto;right:80px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#carols-prompt:after{right:70px}}#location-selection-prompt{bottom:100px;right:22px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#location-selection-prompt{bottom:100px;right:27px}}#location-selection-prompt:after{left:auto;right:30px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#location-selection-prompt:after{right:20px}}#location-songs-prompt{bottom:100px;right:81px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#location-songs-prompt{bottom:101px;right:56px}}#location-songs-prompt:after{left:auto;right:30px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#location-songs-prompt:after{right:49px}}#loading{width:300px;margin:30px auto 0 auto;color:#fff;text-align:center}.loading-visible{-moz-animation:fade .3s;-webkit-animation:fade .3s;animation:fade .3s;opacity:1}.loading-hidden{-moz-animation:fade-out .3s !important;-webkit-animation:fade-out .3s !important;animation:fade-out .3s !important;opacity:0}#loading-bar{width:200px;height:15px;margin:0 auto 0 auto;border-width:1px;border-style:solid;border-color:#fff;border-radius:15px;overflow:hidden;transition:width .3s,height .3s,margin .3s,border-radius .3s,border-color .3s}#loading-fill{background-color:#fff;height:100%;width:0%;transition:background-color .3s linear,width .2s linear;position:relative;overflow:hidden}.loading-button{width:120px !important;height:50px !important;margin-top:-10px !important;border-radius:25px !important;border-color:transparent !important;cursor:pointer;pointer-events:auto;-webkit-tap-highlight-color:rgba(255,255,255,0)}.loading-button #loading-fill{background:#22b82e;box-shadow:0px 0px 6px #0000008e}#loading-play{position:absolute;height:30px;width:100%;top:50%;margin-top:-15px;line-height:30px;text-align:center;color:#fff;font-size:20px;opacity:0;display:none}.loading-button #loading-play{display:block !important}.loading-button #loading-fill #loading-play{opacity:1 !important}#audio-prompt{font-weight:200;font-size:16px;margin-top:20px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#audio-prompt{font-size:14px}}#silent-hint{display:none;font-weight:100}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#silent-hint{font-size:14px}}.silent-hint-show{display:block !important}#error{text-align:center;font-size:20px}#disclaimer{position:fixed;left:20px;bottom:20px;right:20px;color:#fff;text-align:center}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#disclaimer{font-size:14px;left:10px;right:10px;bottom:10px}}#info-overlay{top:0;left:0;background:#000000cc;position:fixed;width:100%;height:100%;overflow:auto}#info-container{margin:100px auto;padding:20px;max-width:500px;color:#fff;font-weight:300;font-size:16px;line-height:20px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#info-container{margin:10px auto;font-size:12px;line-height:14px}}#info-container p{margin-top:1em}#info-container span{font-weight:bold}#info-container a{color:#fff}#info-container a:visited{color:#fff}#info-title{color:#fff;font-size:24px;margin-bottom:1em}#info-title-image{width:auto;height:auto;max-width:180px}#close-info{color:#000;position:relative;margin-top:40px}.menu-container{bottom:95px;right:20px;width:250px;position:fixed;color:#000;font-weight:300;font-size:14px;text-align:left;background:#ffffffcc;padding:5px;border-radius:10px;white-space:nowrap;z-index:100;user-select:none}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.menu-container{left:50%;margin-left:-125px;font-size:12px}}.menu-container:after{left:auto;right:80px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.menu-container:after{display:none}}.menu-container .menu-items .material-icons{vertical-align:middle;padding-bottom:3px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.menu-container .menu-items .material-icons{font-size:18px}}.menu-container .menu-items li{position:relative;padding:5px;border-top:1px solid #aaa;cursor:pointer;transition:background-color .1s linear}.menu-container .menu-items li:first-child{border-top:none}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.menu-container .menu-items li .spinner{position:absolute;width:12px;height:12px;left:3px;top:3px;border-radius:50%;border:3px solid currentColor;border-top-color:currentcolor;border-right-color:currentcolor;border-bottom-color:currentcolor;border-left-color:currentcolor;border-color:currentColor transparent currentColor transparent;display:none}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.menu-container .menu-items li .spinner{left:0;top:0}}.menu-container .menu-items li.loading .spinner{display:block;animation:spin 1.2s linear infinite}.menu-container .menu-items li.loading .material-icons{opacity:0}.menu-container .menu-items .song-name{margin-left:5px}.menu-container .menu-items .song-description{display:block;margin-left:32px;margin-bottom:5px;color:#666}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.menu-container .menu-items .song-description{margin-left:25px}}.menu-container .menu-items .song-description.hidden{display:none}.menu-container .menu-items .loaded,.menu-container .menu-items .playing{color:#22b82e}.menu-items .list-item-icon{display:inline-block;position:relative;top:1px}#location-songs.menu-items .list-item-icon{top:11px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#location-songs.menu-items .list-item-icon{top:9px}}.festive-button{position:fixed;width:55px;height:55px;line-height:55px;border-radius:50%;box-shadow:0px 0px 12px #00000063;background-color:#eee;cursor:pointer;transition:background-color .1s linear,box-shadow .1s linear,fill .1s linear,#fff .1s linear;color:#000;text-align:center;user-select:none}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.festive-button{width:40px;height:40px;line-height:40px}}.festive-button.depressed{color:#fff;background-color:#666}#festive-playlist{right:160px;bottom:30px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#festive-playlist{right:145px;bottom:30px}}#festive-songs-container{bottom:95px;right:100px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#festive-songs-container{left:50%;margin-left:-125px;font-size:12px}}#festive-songs-container:after{left:auto;right:80px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#festive-songs-container:after{display:none}}#festive-switch-container{position:absolute;right:100px;bottom:45px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#festive-switch-container{right:90px;bottom:45px}}.switch{position:relative;display:inline-block;width:48px;height:20px}.switch input{opacity:0;width:0;height:0}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#eee;-webkit-transition:.4s;transition:.4s;border-radius:34px}.slider:before{position:absolute;content:"";height:32px;width:32px;left:0px;bottom:-6px;background-color:#fff;box-shadow:0px 0px 12px #00000063;-webkit-transition:.4s;transition:125ms;border-radius:50%;background-repeat:no-repeat;background-position:center}.christmas .slider:before{background-image:url("./tree.svg")}.newyears .slider:before{background-image:url("./hat.svg")}input:checked+.slider:before{background-color:#22b82e}input:checked+.slider{background-color:#afdab3}input:focus+.slider{box-shadow:0 0 1px #afdab3}input:checked+.slider:before{-webkit-transform:translateX(19px);-ms-transform:translateX(19px);transform:translateX(19px)}.location-button{width:55px;height:55px;line-height:55px;background-color:#eee;border-radius:27.5px;box-shadow:0px 0px 12px #00000063;cursor:pointer;transition:background-color .1s linear,box-shadow .1s linear,fill .1s linear,#fff .1s linear;color:#000;text-align:center;user-select:none}.playlist-button{position:absolute;top:6px;left:5px;width:44px;height:44px;line-height:44px;background-color:#eee;border-radius:22px;box-shadow:0px 0px 12px #00000063;cursor:pointer;transition:background-color .1s linear,box-shadow .1s linear,fill .1s linear,#fff .1s linear;color:#000;text-align:center;user-select:none}.location-button.depressed,.playlist-button.depressed{color:#fff;background-color:#666}#location-selector-button{position:fixed;right:30px;bottom:30px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#location-selector-button{right:25px;bottom:30px}}#location-selector-container{bottom:95px;right:20px;width:250px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#location-selector-container{left:50%;margin-left:-125px;font-size:12px}}#location-selector-container:after{left:auto;right:33px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#location-selector-container:after{display:none}}#location-playlist-tray{position:fixed;width:112px;height:55px;line-height:55px;right:30px;bottom:30px;background-color:#333333cc;border-radius:55px;box-shadow:0px 0px 12px #00000063;cursor:pointer;transition:background-color .1s linear,box-shadow .1s linear,fill .1s linear,#fff .1s linear;color:#000;text-align:center;user-select:none;text-align:left}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#location-playlist-tray{right:25px;bottom:30px}}#location-label{position:absolute;top:6px;left:30px;color:#fff;display:none}#location-songs-container.menu-container:after{right:91px}.indicator{position:fixed;width:20px;height:20px;border-radius:20px;margin-left:-10px;margin-top:-10px;left:0;right:0;opacity:0;transition:opacity .2s linear;pointer-events:none;border:2px solid #fff}.indicator.active{opacity:1}#multiplayer-container{position:absolute;right:170px;bottom:10px;pointer-events:none;text-align:center;width:80px}#multiplayer-status{background:#00000080;padding:8px 10px;display:inline-block;vertical-align:middle;margin-bottom:5px}#multiplayer-people-label{font-weight:300;color:#fff;font-weight:200;margin-top:10px}#multiplayer-people{margin-left:-100%;margin-right:-100%;white-space:nowrap}.multiplayer-person{font-family:"Material Icons";vertical-align:middle;transition:width .3s linear,height .3s linear,margin .3s linear,opacity .2s linear;animation:slidein .3s forwards;opacity:.4;overflow:hidden}.multiplayer-person.self{-webkit-text-stroke:1px #fff}.multiplayer-person.inactive{animation:slideout .3s forwards}.multiplayer-person.connected{opacity:1}@keyframes slidein{from{font-size:0px}to{font-size:30px}}@keyframes slideout{from{font-size:30px}to{font-size:0px}}.tutorial-prompt{position:fixed;color:#fff;font-size:24px;top:20%;text-align:center;width:90%;padding:0 5% 0 5%}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.tutorial-prompt{font-size:16px}}body{margin:0;padding:0;overflow:hidden;font-family:"Google Sans",sans-serif;width:100%;height:100%;background:url("./background.jpg") no-repeat center center fixed,#000;-webkit-background-size:cover;-moz-background-size:cover;-o-background-size:cover;background-size:cover}#skip{position:fixed;bottom:20px;right:20px;font-size:16px;font-weight:300;cursor:pointer;color:#fff}.hideable-clickable{opacity:0;pointer-events:none;transition:opacity .2s}.hideable-clickable.visible{opacity:1;pointer-events:auto}.hideable-unclickable{opacity:0;pointer-events:none;transition:opacity .4s}.hideable-unclickable.visible{opacity:1}#intro{font-size:21px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#intro{font-size:16px}}#title{margin-top:20px}.title{color:#fff;pointer-events:none}#title-image{width:auto;height:auto;max-width:455px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#title-image{max-width:300px}}#splash{position:fixed;width:100%;top:25%;text-align:center;color:#fff}#tagline{font-weight:200;margin-top:20px;font-size:21px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#tagline{font-size:16px}}#title-small{position:fixed;font-size:32px;left:20px;top:20px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#title-small{left:10px;font-size:24px}}#title-small-image{width:auto;height:auto;max-width:180px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#title-small-image{max-width:120px}}#record-container{left:10px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#record-container{left:0px}}#record,#stop-record{position:absolute;border-width:6px;border-style:solid;border-color:#fff;bottom:24px;width:46px;height:46px;border-radius:50%;box-shadow:0px 0px 12px #00000063;cursor:pointer;left:50%;transform:translate(-50%, 0)}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#record,#stop-record{width:36px;height:36px;bottom:20px;border-width:5px}}@keyframes pulse{from{border-color:#fff}50%{border-color:#ffffffcc}to{border-color:#fff}}#record-start{position:absolute;width:40px;height:40px;border-radius:50%;background:#ff3030;margin:0 auto;position:absolute;left:50%;top:50%;transform:translate(-50%, -50%);box-shadow:0px 0px 12px #00000063;transition:width .1s linear,height .1s linear,border-radius .1s linear}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#record-start{width:30px;height:30px}}.recording #record-start{width:20px;height:20px;border-radius:0}#stop-recording-container{left:50%;margin-left:-40px}#record-text{opacity:1}.recording #record-text{opacity:0}#finish-text{opacity:0}.recording #finish-text{opacity:1}.timecode{transition:opacity .1s linear;opacity:0;position:absolute;top:-35px;text-align:center;pointer-events:none;user-select:none;width:100%;font-size:14px;font-family:"Roboto Mono",monospace;color:#fff;padding:5px 0 5px 0;border-radius:10px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.timecode{font-size:12px;top:-10px;width:90%;left:10%}}#recording-timecode{background:#ff3030}.recording #recording-timecode{opacity:1}#playback-timecode{opacity:1;background:#0000008a}.button-container{position:fixed;bottom:10px;width:80px;height:80px}.button{width:55px;height:55px;line-height:55px;border-radius:27.5px;text-align:center;position:absolute;bottom:24px;left:50%;transform:translate(-50%, 0);box-shadow:0px 0px 12px #00000063;background-color:#eee;cursor:pointer;transition:background-color .1s linear,box-shadow .1s linear;user-select:none}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.button{font-size:18px;width:40px;height:40px;line-height:40px;bottom:20px}}.button-text{position:absolute;text-align:center;color:#fff;font-weight:200;bottom:0;pointer-events:none;width:100%;transition:opacity .1s linear;user-select:none;font-size:16px;white-space:nowrap}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.button-text{font-size:14px;font-weight:300}}.button-text-small{font-size:12px;bottom:2px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.button-text-small{font-size:10px;font-weight:300}}#save-container{left:90px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#save-container{left:60px}}#save-text{opacity:1}.saving #save-text{opacity:0}#saving-text{opacity:0}.saving #saving-text{opacity:1}#discard-container{left:160px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#discard-container{left:110px}}#startstop-container{left:10px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#startstop-container{left:0px}}#recording-copy-link-container{left:90px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#recording-copy-link-container{left:60px}}.copy-link-text{opacity:1}.copying .copy-link-text{opacity:0}.copying-link-text{opacity:0}.copying .copying-link-text{opacity:1}#back-container{left:160px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#back-container{left:110px}}#startstop{position:absolute;bottom:31px;left:50%;transform:translate(-50%, 0);width:40px;height:40px;border-radius:50%;box-shadow:0px 0px 12px #00000063;background-color:#eee;cursor:pointer;transition:background-color .1s linear,box-shadow .1s linear}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#startstop{width:30px;height:30px;bottom:28px}}.playing #startstop-stop{opacity:1}.playing #startstop-play{opacity:0}#startstop-stop{position:absolute;background:#333;width:15px;height:15px;left:50%;top:50%;transform:translate(-50%, -50%);transition:opacity .1s linear;opacity:0}#startstop-ring{width:58px;height:58px;border-radius:50%;box-shadow:0px 0px 12px #00000063;position:absolute;left:50%;bottom:22px;transform:translate(-50%, 0%)}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#startstop-ring{width:46px;height:46px;bottom:20px}}#startstop-play{position:absolute;width:0;height:0;left:50%;top:50%;transform:translate(-40%, -50%);border-radius:2px;border-top:10px solid transparent;border-bottom:10px solid transparent;border-left:15px solid #333;transition:opacity .1s linear;opacity:1}#play-text{opacity:1}.playing #play-text{opacity:0}#stop-text{opacity:0}.playing #stop-text{opacity:1}#play{background:#22b82e;color:#fff;text-align:center;position:fixed;right:20px;bottom:20px;width:150px;height:60px;border-radius:30px;font-weight:100;line-height:60px;cursor:pointer;font-size:20px;box-shadow:0px 0px 6px #0000008e}#muted-container{position:fixed;width:150px;height:150px;left:50%;top:50%;margin-left:-75px;margin-top:-75px;background:#ffffff33;pointer-events:none;border-radius:75px}#muted-text{color:#fff;font-weight:300;text-align:center;margin-top:10px}.silence-button{position:fixed;width:50px;height:50px;margin-left:-25px;border-radius:50%;background:#ffffff33;cursor:pointer}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.silence-button{width:36px;height:36px;margin-left:-18px}}.silence-button .silence-line{transform-origin:20% 20%;transform:scale(0);transition:transform .1s linear}.silenced .silence-line{transform:scale(1)}#error{color:#fff;position:absolute;width:400px;left:50%;margin-left:-200px;top:50%;margin-top:-25px;pointer-events:none}#info{color:#fff;position:fixed;width:25px;height:25px;top:20px;left:220px;border:1px solid #fff;line-height:25px;border-radius:50%;cursor:pointer;user-select:none;text-align:center;font-size:16px;font-weight:900;z-index:999;background-color:rgba(255,255,255,0);transition:background-color .1s linear}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#info{width:20px;height:20px;line-height:20px;font-size:11px;left:140px}}#recording-indicator{position:fixed;top:90px;left:40px;color:#fff;font-size:24px;padding-left:25px}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#recording-indicator{left:35px;top:85px;font-size:18px;padding-left:20px}}#recording-icon{position:absolute;left:0;top:2px;width:20px;height:20px;border-radius:50%;background:#ff3030;margin-right:10px;opacity:1}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){#recording-icon{width:15px;height:15px;margin-right:5px}}@keyframes recording-pulse{from{opacity:.7}50%{opacity:1}to{opacity:.7}}#recording-frame{position:fixed;top:50px;bottom:0;left:0;right:0}.recording-frame-corner{display:block;position:fixed;stroke:rgba(255,255,255,.7);width:60px;height:60px;stroke-width:.15}@media screen and (max-width: 499.5px),screen and (max-height: 499.5px){.recording-frame-corner{width:40px;height:40px;stroke-width:.1}}@keyframes recording-frame-pulse{from{stroke:rgba(255,255,255,.7)}50%{stroke:#fff}to{stroke:rgba(255,255,255,.7)}}#recording-frame-top-left{top:70px;left:20px}#recording-frame-top-right{top:70px;right:20px}#recording-frame-bottom-left{bottom:20px;left:20px}#recording-frame-bottom-right{bottom:20px;right:20px}#landscape-warning-overlay{display:none;position:fixed;width:100%;height:100%;overflow:none;background:#000;z-index:99999999;align-items:center !important;justify-content:center !important}.landscape-warning-icon{position:auto;width:24px;height:24px;padding:16px;background:#fff;border-radius:50%;margin-left:auto;margin-right:auto}.landscape-warning-text{color:#fff;font-size:20px;text-align:center;margin-top:15px}#timer{font-family:"Roboto Mono",monospace;font-weight:bold;position:fixed;left:10px;top:80px;color:#fff;font-size:20px}#performance-warning{display:flex;position:fixed;left:0;right:0;top:0;bottom:0;overflow:none;margin:30px;z-index:9999999;align-items:center !important;justify-content:center !important;text-align:center}#performance-warning-content{border-radius:10px;background:rgba(0,0,0,.9);padding:20px;max-width:500px}#performance-warning-icon{color:#fff;position:auto;font-size:48px;margin-left:auto;margin-right:auto}#performance-warning-text{color:#fff;font-size:20px;text-align:center;margin-top:10px}#performance-warning-dismiss{display:inline-block;background:#333;color:#fff;padding:10px;margin-top:15px;border-radius:5px;cursor:pointer;user-select:none}#credit{cursor:pointer;text-decoration:underline}#info-link{cursor:pointer;text-decoration:underline}',""]),t.a=o},function(e,t){e.exports=[["Name","en-US","af","es-ES","fr-FR","hi","it-function p(e, t, n) {IT","pt-BR","sw","ja","ko","zh-CN","zh-TW","de","ru","es-419","id","cs","da","hr","hu","lv","nl","pl","pt-PT","ro","uk"],["splash_intro","","","","","","","","","","","","","","","","","","","","","","","","","",""],["splash_title","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera"," ","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Blob Opera","Opera cu bule","Blob Opera"],["splash_description","Play four voices in cities around the world, with the help of machine learning","Speel vier sangstemme in stede wreldwyd met behulp van masjienleer","Haz cantar a cuatro voces por ciudades de todo el mundo con la ayuda del aprendizaje automtico","Faites chanter quatre voix dans des villes du monde entier grce au machine learning (apprentissage automatique)","    ,       -    ","Fai cantare quattro voci nelle citt di tutto il mondo con l'aiuto del machine learning","Toque quatro vozes em cidades do mundo todo com ajuda do aprendizado de mquina","Cheza sauti nne katika miji kote ulimwenguni, kwa usaidizi wa mashine kujifunza"," 4 ","         ."," 4 ","","Geben Sie mithilfe von maschinellem Lernen ein vierstimmiges Konzert in verschiedenen Metropolen","      ,     .","Con ayuda del aprendizaje automtico, reproduce las cuatro voces en distintas ciudades del mundo","Mainkan empat suara di berbagai kota di seluruh dunia dengan bantuan machine learning","Puste si s pomoc strojovho uen zpv ty hlas ve mstech po celm svt","Afspil fire stemmer i byer rundt omkring i verden takket vre maskinlring",'"Svirajte" etiri glasa u gradovima diljem svijeta uz pomo strojnog uenja',"Jtsszon ngy hangon a vilg vrosaiban a gpi tanuls segtsgvel","Atskaojiet etrbalsgu dziedanu pasaules lielpilsts ar manmcans paldzbu.","Speel 4 stemmen in steden over de hele wereld af met de hulp van machine learning","Skorzystaj z pomocy systemw uczcych si i odtwrz 4 gosy w miastach na caym wiecie","Toque quatro vozes em cidades de todo o mundo com a ajuda da aprendizagem automtica","Redai patru voci n orae din toat lumea, cu ajutorul nvrii automate","         "],["splash_sound_hint","Turn up your sound!","Maak jou volume harder!","Sube el volumen!","Montez le son !","   !","Alza il volume!","Aumente o volume!","Ongeza sauti ya kifaa chako!",""," .","","","Drehen Sie die Lautstrke auf."," !","Sube el volumen!","Keraskan suara perangkat Anda","Zesilte zvuk!","Skru op for lyden!","Pojaajte zvuk!","Nvelje a hangert!","Iesldziet skau!","Zet je geluid aan","Wcz dwik!","Aumente o volume!","Cretei volumul!"," !"],["splash_silent_hint","Make sure your device isn't on silent","Maak seker dat jou toestel nie stilgemaak is nie","Asegrate de que tu dispositivo no est silenciado\n","Vrifiez que votre appareil n'est pas en mode silencieux","          ","Assicurati che l'audio del tuo dispositivo non sia disattivato","Confira se o dispositivo no est silenciado","Hakikisha kuwa sauti ya kifaa chako haijazimwa","","    .","","","Ihr Gert darf nicht stummgeschaltet sein",",     .","Asegrate de que el dispositivo no est en silencio","Jangan bisukan audio perangkat Anda","Zkontrolujte, zda zazen nen ztlumen","Srg for, at lyden ikke er slet fra p din enhed","Provjerite da zvuk na ureaju nije iskljuen","Gyzdjn meg rla, hogy eszkze nincs lenmtva","Prbaudiet, vai ierces skaa ir ieslgta.","Zorg dat het geluid op je apparaat aanstaat","Upewnij si, e Twoje urzdzenie nie jest wyciszone","Certifique-se de que o seu dispositivo no est em silncio","Asigurai-v c sunetul dispozitivului nu este dezactivat",",      "],["label_skip_tutorial","Skip tutorial","Slaan tutoriaal oor","Saltar el tutorial","Ignorer le tutoriel"," ","Salta il tutorial","Pular tutorial","Ruka mafunzo",""," ","","","Anleitung berspringen"," ","Omitir instructivo","Lewati tutorial","Peskoit vukov program","Spring selvstudie over","Preskoi vodi","tmutat kihagysa","Izlaist apmcbu","Tutorial overslaan","Pomi samouczek","Ignorar tutorial","Omitei tutorialul","  "],["button_begin","Ready!","Gereed!","Listo!","C'est parti !"," !","Tutto pronto!","Pronto","Tayari!","","","","","Bereit!","","Listo","Siap!","Pipraveno!","Klar!","Spremno!","Ksz","Gatavs!","Klaar","Gotowe","Pronto!","Gata!","!"],["label_record","Record","Neem op","Grabar","Enregistrer"," ","Registra","Gravar","Rekodi","","","","","Aufnehmen"," ","Grabar","Rekam","Nahrt","Optag","Snimi","Felvtel","Ierakstt","Opnemen","Nagraj","Gravar","nregistrai",""],["label_finish","Finish","Voltooi","Finalizar","Terminer"," ","Fine","Finalizar","Maliza","","","","","Fertigstellen","","Finalizar","Selesai","Dokonit","Udfr","Zavri","Befejezs","Pabeigt","Afronden","Zakocz","Terminar","Finalizai",""],["label_back","Back","Terug","Atrs","Retour"," ","Indietro","Voltar","Rudi nyuma","","","","","Zurck","","Atrs","Kembali","Zpt","Tilbage","Natrag","Vissza","Atpaka","Terug","Wstecz","Anterior","napoi",""],["label_share","Share","Deel","Compartir","Partager"," ","Condividi","Compartilhar","Shiriki","","","","","Teilen","","Compartir","Bagikan","Sdlet","Del","Dijeli","Megoszts","Kopgot","Delen","Udostpnij","Partilhar","Distribuii",""],["label_play","Play","Speel","Reproducir","Lire","","Riproduci","Iniciar","Cheza","","","","","Abspielen","","Reproducir","Putar","Pehrt","Afspil","Sviraj","Lejtszs","Atskaot","Afspelen","Odtwrz","Reproduzir","Redai",""],["label_stop","Stop","Stop","Detener","Arrter","","Interrompi","Parar","Simamisha","","","","","Stopp","","Detener","Berhenti","Zastavit","Stop","Zaustavi","Lellts","Apturt","Stoppen","Zatrzymaj","Parar","Oprii",""],["label_saving","Saving...","Stoor tans ","Guardando...","Enregistrement","   ...","Salvataggio in corso...","Salvando...","Inahifadhi...","..."," ...","","...","Wird gespeichert","","Guardando","Menyimpan...","Ukldn","Gemmer...","Spremanje...","Ments","Notiek saglabana","Opslaan...","Zapisuj","A guardar...","Se salveaz...",""],["label_discard","Discard","Gooi weg","Descartar","Supprimer"," ","Ignora","Descartar","Futa","","","","","Verwerfen","","Descartar","Hapus","Zahodit","Kassr","Odbaci","Elvets","Atmest","Niet opslaan","Odrzu","Rejeitar","Renunai",""],["label_copy_link","Copy link","Kopieer skakel","Copiar enlace","Copier le lien","  ","Copia link","Copiar link","Nakili kiungo",""," ","","","Link kopieren"," ","Copiar vnculo","Salin link","Koprovat odkaz","Kopir link","Kopiraj vezu","Link msolsa","Kopt saiti","Link kopiren","Kopiuj link","Copiar link","Copiai linkul"," "],["label_copied_link","Copied!","Gekopieer!","Copiado!","Copi !","  !","Copiato.","Copiado.","Umenakili!",""," ","","","Kopiert!","","Se copi.","Disalin!","Zkoprovno.","Kopieret!","Kopirano!","Msolva","Nokopta!","Gekopieerd","Skopiowano","Copiado!","S-a copiat!","."],["label_leave","Leave","Verlaat","Salir","Quitter","","Esci","Sair","Ondoka","","","","","Beenden","","Salir","Keluar","Opustit","Forlad","Napusti","Kilps","Iziet","Verlaten","Wyjd","Sair","Ieii",""],["tutorial_pitch","Drag blobs up and down to sing different pitches","Sleep blertse op en af om op verskillende toonhoogtes te sing","Arrastra los blobs hacia arriba y hacia abajo para obtener diferentes tonos.","Faites glisser les blobs vers le haut et vers le bas pour obtenir diffrentes hauteurs de voix","-     ,          ","Trascina i blob verso l'alto e verso il basso per cambiare il tono con cui cantano","Arraste os blobs para cima e para baixo para cantar em tons diferentes","Buruta blobu juu na chini ili ziimbe viwango tofauti vya uzito wa sauti","","    ."," blob ","","Ziehen Sie die Blobs nach oben und unten, um die Tonhhe zu ndern","    ,     .","Arrastra los blobs hacia arriba y abajo para que canten en diferentes tonos","Tarik blob ke atas dan bawah untuk menyanyikan nada yang berbeda","Petaenm blob nahoru a dol zmnte vku zpvanho tnu","Trk klumperne op og ned for at synge forskellige tonehjder","Povlaite blobove prema gore ili dolje da bi pjevali razliite visine glasa","Hzza a blobokat fel s le klnbz hangmagassgok kineklshez","Velciet burbuus uz augu un leju, lai tiktu izdziedti dadi toi.","Sleep de blobs omhoog en omlaag om verschillende toonhoogtes te zingen","Przecigaj bloby w gr i w d, aby zmienia ton piewu","Arraste os blobs para cima e para baixo para cantar em tons diferentes","Tragei bulele n sus i n jos pentru a reda diferite tonaliti","    ,      "],["tutorial_vowel","Drag blobs forwards and backwards to sing different vowels","Sleep blertse vorentoe en agtertoe om verskillende vokale te sing","Arrastra los blobs hacia delante y hacia atrs para obtener diferentes vocales.","Faites glisser les blobs vers l'avant et vers l'arrire pour obtenir diffrentes voyelles","-     ,          ","Trascina i blob avanti e indietro per cambiare le vocali con cui cantano","Arraste os blobs para frente e para trs para cantar vogais diferentes","Buruta blobu mbele na nyuma ili ziimbe vokali tofauti","","     ."," blob ","","Ziehen Sie die Blobs vor und zurck, um verschiedene Vokale zu singen","    ,      .","Arrastra los blobs hacia adelante y atrs para que canten diferentes vocales","Tari blob ke depan dan belakang untuk menyanyikan suara vokal yang berbeda","Petaenm blob dopedu a dozadu zmnte zpvan hlsky","Trk klumperne fremad og tilbage for at synge forskellige vokaler","Povlaite blobove prema naprijed ili natrag da bi pjevali razliite samoglasnike","Hzza a blobokat elre s htra klnbz magnhangzk kineklshez","Velciet burbuus uz prieku un atpaka, lai tiktu izdziedti dadi patskai.","Sleep de blobs naar voren en achteren om verschillende klinkers te zingen","Przecigaj bloby do przodu i do tyu, aby zmienia piewane samogoski","Arraste os blobs para a frente e para trs para cantar vogais diferentes","Tragei bulele nainte i napoi pentru a reda diferite vocale","    ,      "],["tutorial_harmonization","The highest voice leads the harmony","Die hoogste sangstem lei die harmonie","La voz ms aguda dirige la armona.","La voix la plus aigu dirige l'harmonie","      ,   ","La voce con il tono pi alto conduce l'armonia","A voz mais alta conduz a harmonia","Sauti ya juu zaidi ndiyo itakayoongoza ulinganifu wa sauti","","    ."," blob ","","Die hchste Stimme ist die fhrende Stimme","    .","La voz ms aguda lidera la armona","Suara dengan nada tertinggi akan memimpin harmoni","Nejvy hlas udv harmonii","Den hjeste stemme leder harmonien","Najvii je glas primarni u harmoniji","A legmagasabb hangra pl az sszhang","Harmoniju veido augstk balss.","De hoogste stem leidt de harmonie","Najwyszy gos prowadzi harmoni","A voz mais alta conduz a harmonia","Cea mai nalt voce produce armonia","   "],["tutorial_mute","All together now! Use the mute buttons to silence blobs","Almal saam! Gebruik die dempknoppies om blertse stil te maak","Ahora todos juntos! Usa los botones de silencio para silenciar los blobs.","Tous en chur, maintenant ! Utilisez le bouton du son pour faire taire les blobs.","      !       , ' '   ","Ora tutti insieme! Utilizza i pulsanti di disattivazione del suono per far restare in silenzio i blob","Todos juntos agora! Use os botes de desativar o som para silenciar os blobs","Kwa pamoja sasa! Tumia vitufe vya kuzima sauti ili uzime sauti ya blobu","","  .    ."," blob ","","Und jetzt alle! Mit den Lautsprecher-Schaltflchen knnen Sie die Blobs stummschalten","   !    ,     .","Ahora todos juntos! Usa los botones para silenciar los blobs.","1, 2, 3, bersama-sama! Gunakan tombol bisukan untuk membisukan blob","Te vechny najednou! Pomoc tlatek ztlumen bloby umlte","Alle sammen nu! Brug mikrofonknapperne til at sl klumpernes lyd fra","A sad svi zajedno! Pomou gumba za iskljuivanje zvuka moete utiati blobove","Minden a helyn van. Hasznlja a nmts gombokat a blobok elnmtshoz.","Tagad visi kop! Lai izslgtu burbuu skau, izmantojiet skaas izslganas pogas.","En nu allemaal samen! Je kunt het geluid van de blobs uitzetten met de knop Dempen","A teraz razem! Uyj przyciskw wyciszenia, aby wyciszy bloby","Todos juntos agora! Utilize os botes desativar som para silenciar os blobs","Acum toi mpreun! Folosii butoanele de dezactivare a sunetului pentru ca bulele s tac","  !    ,    "],["tutorial_end","That's it! Now sing your own opera. Hit record to share what you make.","Mooi so! Sing nou jou eie opera. Neem dit op om te deel wat jy skep.","Ya est! Ahora canta tu propia pera. Pulsa el botn Grabar para compartir tu obra.",'Et voil !  prsent, faites-les chanter votre propre opra. Appuyez sur "Enregistrer" pour partager votre uvre.',",  !     .         , ' '  .","Ecco fatto! Ora puoi far cantare loro la tua opera. Seleziona Registra per condividere la tua creazione.","Pronto. Agora voc pode ouvir sua prpria pera. Grave para compartilhar sua criao.","Ni hivyo tu! Sasa imba opera yako mwenyewe. Gusa rekodi ili ushiriki utunzi wako.","",".     .      .","","","Das wars schon! Singen Sie jetzt Ihre eigene Oper. Klicken Sie auf Aufnehmen, um Ihr Werk anschlieend zu teilen.","!      .           .","Listo. Ahora canta tu propia pera. Presiona Grabar para compartir tu versin.","Bagus! Sekarang nyanyikan opera Anda sendiri. Tekan tombol rekam untuk membagikan hasil kreasi Anda.","To je cel! Nyn mete zpvat vlastn operu. Sv dlo mete nahrt pomoc tlatka a potom sdlet.","Lige prcis! Syng nu din egen opera. Tryk p Optag for at dele det, du skaber.","To je to! Sad pjevajte vlastitu operu. Pritisnite Snimi da biste podijelili svoje djelo.","Ennyi az egsz. Most mr elnekelheti sajt operjt. Kattintson a felvtelre az alkots megosztshoz.","Tas ar viss! Tagad dziediet savu operu! Nospiediet Ierakstt, lai kopgotu savu sacerto skadarbu.","Dat is alles! Nu kun je je eigen opera zingen. Druk op Opnemen om te delen wat je hebt gemaakt.","I to wszystko. Teraz zapiewaj wasn oper. Nacinij przycisk Nagraj, aby udostpni swoje dzieo.",'J est! Agora, cante a sua prpria pera. Clique em "Gravar para partilhar a sua criao.',"Asta este tot! Acum creai propria compoziie. Atingei butonul de nregistrare pentru a distribui creaia.","  .    .   ,  ."],["prompt_in_playback_shared","Have a go!","Probeer dit!","Intntalo!"," vous de jouer !","!","Provaci!","Experimente!","Jaribu!","","","","","Probieren Sie es aus!","!","Intntalo!","Ayo coba","Vyzkouejte to!","Prv det!","Pokuajte!","Kezdjk el!","Aiziet!","Probeer het zelf eens","Dalej!","Experimente!","ncercai!","!"],["prompt_in_playback_creator","Start again","Begin oor","Volver a empezar","Recommencez","   ","Ricomincia","Comear novamente","Anza tena",""," ","","","Neu starten"," ","Vuelve a empezar","Mulai lagi","Zat znovu","Start forfra","Zaponi ponovo","jrakezds","Sciet vlreiz","Begin opnieuw","Rozpocznij od nowa","Recomear","ncepei din nou"," "],["prompt_share","Share your creation","Deel jou skepping","Compartir tu creacin","Partagez votre cration","    ","Condividi la tua creazione","Compartilhar sua criao","Shiriki utunzi wako",""," ","","","Werk teilen","  ","Comparte tu creacin","Bagikan kreasi Anda","Sdlet dlo","Del dit vrk","Podijelite svoje djelo","Alkots megosztsa","Kopgojiet savu skadarbu","Deel wat je hebt gemaakt","Udostpnij swoje dzieo","Partilhe a sua criao","Distribuii-v creaia","  "],["prompt_share_carol","Share this carol","Deel hierdie Kersliedjie","Compartir este villancico","Partagez ce chant de Nol","    ","Condividi questo canto natalizio","Compartilhar esta cano","Shiriki wimbo huu wa krismasi",""," ","","","Dieses Weihnachtslied teilen","  ","Comparte este villancico","Bagikan nyanyian ini","Sdlet koledu","Del denne sang","Podijelite ovu pjesmu","nnepi nek megosztsa","Kopgojiet o korli","Deel dit kerstlied","Udostpnij t kold","Partilhe esta cano","Distribuii acest colind","  "],["prompt_unmute","Click to unmute","Klik om te ontdemp","Haz clic para activar el sonido","Cliquez pour ractiver le son","     ","Fai clic per riattivare l'audio","Clique para ativar o som","Bofya ili urejeshe sauti","","  ","","","Klicken, um Stummschaltung aufzuheben",",   ","Haz clic para activar el sonido","Klik untuk membunyikan audio","Kliknutm zapnete zvuk","Klik for at sl lyden til","Kliknite da biste ukljuili zvuk","Kattintson a nmts feloldshoz","Noklikiniet, lai ieslgtu skau","Klik om het geluid aan te zetten","Kliknij, aby wyczy wyciszenie","Clique para reativar o som","Dai clic pentru a activa sunetul",",   "],["prompt_soprano","Drag to sing *soprano*","Sleep om *sopraan* te sing","Arrastrar para usar la voz *soprano*","Faites glisser pour entendre la voix de *soprano*","**     ,    ","Trascina per usare la voce *soprano*","Arraste para cantar *soprano*","Buruta ili uimbe *soprano*"," ** "," ** ","**","**","Ziehen, um *Sopran* zu singen",",    **","Arrastra para cantar en *soprano*","Tarik untuk menyanyikan suara *sopran*","Petaenm zane zpvat *soprn*","Trk for at synge *sopran*","Povucite da bi pjevao *sopran*","A *szoprn* hangnemben neklshez hzza valamelyik irnyba","Velciet, lai dziedtu *soprns*","Sleep om *sopraan* te zingen","Przecignij, aby piewa *sopranem*","Arraste para cantar *soprano*","Tragei pentru a reda vocea de *sopran*",",    **"],["prompt_mezzo","Drag to sing *mezzo-soprano*","Sleep om *mezzosopraan* te sing","Arrastrar para usar la voz *mezzosoprano*","Faites glisser pour entendre la voix de *mezzo-soprano*","*-*     ,    ","Trascina per usare la voce *mezzosoprano*","Arraste para cantar *mezzo-soprano*","Buruta ili uimbe *mezzo-soprano*"," ** "," ** ","**","**","Ziehen, um *Mezzosopran* zu singen",",    *-*","Arrastra para cantar en *mezzosoprano*","Tarik untuk menyanyikan suara *mezzosopran*","Petaenm zane zpvat *mezzosoprn*","Trk for at synge *mezzosopran*","Povucite da bi pjevao *mezzosopran*","A *mezzoszoprn* hangnemben neklshez hzza valamelyik irnyba","Velciet, lai dziedtu *mecosoprns*","Sleep om *mezzosopraan* te zingen","Przecignij, aby piewa *mezzosopranem*","Arraste para cantar *mezzo-soprano*","Tragei pentru a reda vocea de *mezzo-sopran*",",    *-*"],["prompt_tenor","Drag to sing *tenor*","Sleep om *tenoor* te sing","Arrastrar para usar la voz *tenor*","Faites glisser pour entendre la voix de *tnor*","**     ,    ","Trascina per usare la voce *tenore*","Arraste para cantar *tenor*","Buruta ili uimbe *sauti ya tatu*"," ** "," ** ","**","**","Ziehen, um *Tenor* zu singen",",    **","Arrastra para cantar en *tenor*","Tarik untuk menyanyikan suara *tenor*","Petaenm zane zpvat *tenor*","Trk for at synge *tenor*","Povucite da bi pjevao *tenor*","A *tenor* hangnemben neklshez hzza valamelyik irnyba","Velciet, lai dziedtu *tenors*","Sleep om *tenor* te zingen","Przecignij, aby piewa *tenorem*","Arraste para cantar *tenor*","Tragei pentru a reda vocea de *tenor*",",    **"],["prompt_bass","Drag to sing *bass*","Sleep om *bas* te sing","Arrastrar para usar la voz *bajo*","Faites glisser pour entendre la voix de *basse*","**     ,    ","Trascina per usare la voce *basso*","Arraste para cantar *baixo*","Buruta ili uimbe *besi*"," ** "," ** ","**","**","Ziehen, um *Bass* zu singen",",    **","Arrastra para cantar en *bajo*","Tarik untuk menyanyikan suara *bas*","Petaenm zane zpvat *bas*","Trk for at synge *bas*","Povucite da bi pjevao *bas*","A *basszus* hangnemben neklshez hzza valamelyik irnyba","Velciet, lai dziedtu *bass*","Sleep om *bas* te zingen","Przecignij, aby piewa *basem*","Arraste para cantar *baixo*","Tragei pentru a reda vocea de *bas*",",    **"],["prompt_pitch","Pitch:","Toonhoogte:","Tono:","Hauteur de voix :",":","Tono:","Tom:","Uzito wa sauti:",":",":","","","Tonhhe:",":","Tono:","Nada:","Vka:","Tonehjde:","Visina glasa:","Hangmagassg:","Tonis:","Toonhoogte:","Ton:","Tonalidade:","Tonalitate:",":"],["prompt_vowel","Vowel:","Vokaal:","Vocal:","Voyelle :",":","Vocale:","Vogal:","Vokali:",":",":","","","Vokal:",":","Vocal:","Vokal:","Hlska:","Vokal:","Samoglasnik:","Magnhangz:","Patskanis:","Klinker:","Samogoska:","Vogal:","Vocal:"," :"],["prompt_stop_recording","Press to finish your recording","Druk om jou opname te voltooi","Pulsa para finalizar la grabacin","Appuyez pour terminer l'enregistrement","       ","Premi per terminare la registrazione","Pressione para concluir sua gravao","Bonyeza ili ukamilishe kurekodi","","  ","","","Klicken, um Aufnahme zu beenden",",   ","Presiona para terminar tu grabacin","Tekan tombol untuk menyelesaikan rekaman Anda","Stisknutm dokonete nahrvn","Tryk for at afslutte din optagelse","Pritisnite da biste dovrili snimanje","Nyomja meg a felvtel befejezshez","Nospiediet, lai pabeigtu ierakstanu","Druk om te stoppen met opnemen","Nacinij, aby zakoczy nagrywanie","Prima para terminar a sua gravao","Apsai pentru a termina nregistrarea",",   "],["prompt_festive","Let it snow!","Laat dit sneeu!","Deja que nieve!","Faites qu'il neige !","  !","Lascia che nevichi!","Boas festas!","Acha igonge!","","   ","","","Let it snow!","Let it snow!","Celebra las fiestas!","Let it snow!","Puste se do toho!","Let it snow!","Let it snow!","Let it snow!","Lai tik snieg!","Laat de sneeuw maar komen!","Let it snow!","Let it snow!","S ning!"," !"],["prompt_harmonization","The highest voice type leads the harmony","Die hoogste sangstem lei die harmonie","El tipo de voz ms agudo dirige la armona.","Le type de voix le plus aigu dirige l'harmonie","         ","Il tipo di voce pi alto conduce l'armonia","O tipo de voz mais alto conduz a harmonia","Aina ya sauti ya juu zaidi ndiyo itakayoongoza ulinganifu wa sauti","","    "," blob ","","Die hchste Stimmlage ist die fhrende Stimme","    .","El tipo de voz ms aguda lidera la armona","Jenis suara dengan nada tertinggi akan memimpin harmoni","Nejvy hlas udv harmonii","Den hjeste stemmetype leder harmonien","Najvia je vrsta glasa primarni glas u harmoniji","A legmagasabb hangnemre pl az sszhang","Harmoniju veido augstk balss","De hoogste stem leidt de harmonie","Najwyszy rodzaj gosu prowadzi harmoni","O tipo de voz mais alto conduz a harmonia","Cel mai nalt tip de voce produce armonia","   "],["prompt_carols","Hear some festive songs!","Hoor 'n paar feestelike liedjies!","Escucha canciones navideas","coutez des chants de Nol !","    !","Ascolta alcuni brani natalizi.","Oua msicas festivas","Sikiliza baadhi ya nyimbo za msimu wa sikukuu!","","   ","","","Hren Sie sich festliche Lieder an!","  !","Escucha canciones navideas!","Dengarkan lagu-lagu yang penuh suka ria","Poslechnte si svten psn!","Hr nogle julesange!","Posluajte neke blagdanske pjesme!","Hallgasson meg nhny nnepi dalt!","Noklausieties daas svtku dziesmas!","Luister naar feestelijke nummers","Posuchaj witecznych utworw!","Oua msicas festivas!","Ascultai cteva cntece festive!","  !"],["prompt_location_songs","Hear a local song!","Hoor 'n plaaslike liedjie!","Escucha una cancin local","coutez un chant local !","   !","Ascolta un brano locale.","Oua uma msica local","Sikiliza wimbo wa mahali ulipo!",""," ","","","Hren Sie sich ein Lied aus der Region an!","  !","Escucha una cancin local!","Dengarkan lagu lokal","Poslechnte si mstn pse.","Hr en lokal sang!","Posluajte lokalnu pjesmu!","Hallgasson meg egy helyi dalt!","Noklausieties kdu vietjo dziesmu!","Luister naar een lokaal nummer","Posuchaj lokalnego utworu!","Oua uma msica local!","Ascultai un cntec local!","  !"],["info_body","","","","","","","","","","","","","","","","","","","","","","","","","",""],["info_performing_arts_link","","","","","","","","","","","","","","","","","","","","","","","","","",""],["axl_share_recording_ugc","Blob Opera is on tour! Play four opera voices and see them perform in cities around the world. Here's one I made for <city>  ","Blob Opera toer tans! Speel vier operastemme en sien hoe hulle optree in stede wreldwyd. Hier is een wat ek gemaak het vir <city>","Blob Opera est de gira! Haz cantar a cuatro voces de pera y disfruta de sus actuaciones en distintas ciudades de todo el mundo. Aqu hay una que grab en <city> .","Blob Opera en tourne ! Faites chanter quatre voix d'opra et regardez-les se produire dans des villes du monde entier. Voici une uvre que j'ai compose pour <city> ","Blob Opera   !    -             .  <city>      ","Blob Opera  in tour! Fai cantare quattro voci liriche e guardale mentre si esibiscono nelle citt di tutto il mondo. Ecco uno spettacolo che ho creato per <city>","A Blob Opera est em uma turn mundial! Toque quatro vozes de pera e veja-as se apresentando em cidades do mundo todo. Oua esta que eu criei para <city>","Blob Opera iko katika ziara! Cheza sauti nne za opera na uone zikiimbwa katika miji kote ulimwenguni. Nilitunga sauti hii kwa ajili ya <city> ","Blob Opera 4  <city>  ","   .           . <city>()     . ","Blob Opera  4 <city> ","Blob Opera <>","Blob Opera ist auf Tour! Lasse vier Opernstimmen singen und in verschiedenen Metropolen der Welt auftreten. Hier ist eine Komposition, die ich fr <city> gemacht habe ","Blob Opera   .       . <city>,    ! ","Blob Opera est de gira! Reproduce cuatro voces de pera y mralas actuar en ciudades de todo el mundo. Aqu hay uno que hice para <city> ","Blob Opera sedang melakukan tur! Mainkan empat suara opera dan saksikan penampilan mereka di seluruh dunia. Ini kreasi yang saya buat untuk <city>. ","Blob Opera jede na turn! Pehrvejte zpv ty opernch hlas a sledujte jejich vystoupen v mstech po celm svt. Tohle je mj vtvor z msta <city> ","Blob Opera er p turn! Afspil fire operastemmer, og se dem optrde i byer rundt omkring i verden. Her er en opera, jeg har lavet til <city> ",'Blob Opera je na turneji! "Svirajte" etiri operna glasa i gledajte njihove nastupe u gradovima diljem svijeta. Evo jednog mojeg za <city> ',"A Blob Opera turnzik! Jtsszon ngy operanekes hangjn, s ljn be az eladsokra a vilg vrosaiban. me az egyik, amelyet <city> vroshoz komponltam. ","Blob Opera dziedtji ir devuies turnej! Atskaojiet etras operdziedtju balsis un skatiet uzstanos pasaules lielpilsts. du programmu es izveidoju pilstai <city> ","Blob Opera gaat op tournee. Speel 4 operastemmen af en zie ze optreden in steden over de hele wereld. Deze heb ik gemaakt voor <city> ","Blob Opera w trasie koncertowej! Odtwrz 4 gosy operowe i obejrzyj wystpy w miastach na caym wiecie. Tem dla tego wystpu jest <city> ","O Blob Opera est em digresso! Toque quatro vozes de pera e veja apresentaes em vrias cidades de todo o mundo. Oua esta que eu que fiz para <city> ","Opera cu bule pleac n turneu! Redai patru voci de oper i ascultai-le n orae din ntreaga lume. Iat o melodie compus pentru <city> ","Blob Opera   !         .   .  <city>! "],["axl_share_recording_cc","Blob Opera is on tour! Hear them sing <song> in <city> then create your own composition ","Blob Opera toer tans! Hoor hoe hulle <song> in <city> sing, en skep dan jou eie komposisie","Blob Opera est de gira! Oye cmo cantan <song> en <city> y luego crea tu propia obra .",'Blob Opera en tourne ! coutez-les chanter "<song>" dans la ville de <city>, puis crez votre propre composition ',"Blob Opera   ! <city>   <song>   .  ,    ","Blob Opera  in tour! Ascolta i blob cantare <song> a <city> e poi crea la tua composizione","A Blob Opera est em uma turn mundial! Oua uma apresentao da msica <song> em <city> e crie sua prpria composio","Blob Opera iko katika ziara! Zisikilize zikiimba <song> mjini <city> kisha utunge wimbo wako mwenyewe ","Blob Opera <city>  <song>  4  ","   . <city>  <song>()    . ","Blob Opera <city><song> ","Blob Opera <city><song>","Blob Opera ist auf Tour! Hr dir an, wie die Blobs das Lied <song> in <city> singen, und komponiere dann ein eigenes Stck ",'Blob Opera   .  <city>! ,     "<song>",    . ',"Blob Opera est de gira! Escchalos cantar <song> en <city> y, luego, crea tu propia composicin ","Blob Opera sedang melakukan tur! Nikmati lagu <song> yang mereka bawakan di <city>, lalu ciptakan komposisi Anda sendiri. ","Blob Opera jede na turn! Poslechnte si pse <song> ve mst <city> a pak vytvote vlastn skladbu ","Blob Opera er p turn! Hr dem synge <song> i <city>, og skab derefter din egen komposition ","Blob Opera je na turneji! Posluajte kako pjevaju pjesmu <song> u gradu <city>, a zatim skladajte vlastitu skladbu ","A Blob Opera turnzik! Hallgassa meg, ahogy a(z) <song> dalt neklik <city> vrosban, majd szerezzen sajt zent. ","Blob Opera dziedtji ir devuies turnej! Klausieties dziesmu <song> pilst <city>, pc tam saceriet savu skadarbu ","Blob Opera gaat op tournee. Hoor ze <song> zingen in <city> en maak dan je eigen compositie ","Blob Opera w trasie koncertowej! Posuchaj, jak <city> wypenia si brzmieniem utworu <song>, a potem stwrz wasn kompozycj ","O Blob Opera est em digresso! Oua essas vozes a cantarem <song> em <city>. Em seguida, crie a sua prpria composio ","Opera cu bule pleac n turneu! Ascultai bulele care cnt <song> n <city>, apoi creai propria compoziie ","Blob Opera   !  <city>! ,     <song>,      "],["landscape_warning_desktop","Expand the height of your window to view this experiment","Maak jou venster se hoogte groter om hierdie eksperiment te bekyk","Ampla la altura de tu ventana para ver este experimento","Agrandissez votre fentre pour voir cette exprience","     ,     ","Espandi l'altezza della finestra per vedere questo esperimento","Aumente a altura da janela para ver este experimento","Panua urefu wa dirisha lako ili uone jaribio hili","","    .","","","Maximieren Sie die Hhe des Fensters, damit Sie das Experiment vollstndig sehen knnen","  ,   .","Expande la altura de la ventana para ver este experimento","Luaskan tinggi jendela untuk melihat eksperimen ini","Chcete-li tento experiment zobrazit, zvtete vku okna","Gr vinduet hjere for at se dette eksperiment","Poveajte prozor u visinu da biste vidjeli ovaj eksperiment","A ksrlet megtekintshez nvelje az ablak magassgt","Lai skattu o eksperimentu, izvrsiet loga augstumu.","Maak je venster hoger om dit experiment te bekijken","Powiksz okno, aby wywietli ten eksperyment","Expanda a altura da janela para ver esta experincia","Extindei nlimea ferestrei pentru a viziona acest experiment","   ,   "],["landscape_warning_mobile","This experiment is best viewed in portrait mode","Die eksperiment kan die beste in portretmodus bekyk word","Este experimento se ve mejor en modo vertical","Pour bien visualiser cette exprience, passez en mode portrait","        ","Questo esperimento si vede in modo ottimale in modalit Ritratto","Este experimento pode ser visualizado melhor em Modo retrato","Jaribio hili hutazamwa vyema zaidi katika mkao wima","","     .","","","Am besten lsst sich das Experiment im Hochformat betrachten","      .","Este experimento se ve mejor en modo vertical","Eksperimen ini paling optimal dilihat dalam mode potret","Tento experiment je nejlep zobrazit na vku","Eksperimentet fungerer bedst i portrttilstand","Ovaj eksperiment najbolje je gledati u portretnom nainu","A legjobb lmny rdekben portr mdban tekintse meg a ksrletet","o eksperimentu ieteicams skatt portreta rem.","Je kunt dit experiment het best bekijken in de portretmodus","Ten eksperyment najlepiej jest wywietla w orientacji pionowej","Conseguir visualizar melhor esta experincia no modo vertical.","Experimentul poate fi vizionat cel mai bine n modul portret","      "],["performance_warning","We've detected that you may not be having an optimal experience. Why not try this on a desktop device!","Ons het bespeur dat jy dalk nie 'n optimale ervaring beleef nie. Hoekom probeer jy dit nie eerder op 'n rekenaar nie!","Puede que no ests disfrutando de una experiencia ptima. Prueba con un ordenador.","Nous avons constat que vous ne profitiez peut-tre pas d'une exprience optimale. Pourquoi ne pas essayer avec un ordinateur ?","            .       !","Abbiamo rilevato che la tua esperienza potrebbe non essere ottimale. Prova a usare un dispositivo desktop.","Detectamos que sua experincia pode no ser a ideal. Tente usar um dispositivo desktop.","Tumegundua kuwa huenda hupati hali bora ya utumiaji. Kwa nini usiijaribu kwenye kompyuta ya aina yoyote!"," ","     .    .","","","Wir haben festgestellt, dass das Experiment auf Ihrem Gert womglich nicht optimal funktioniert. Probieren Sie es doch einmal auf einem Desktop-Gert aus!"," ,    -  .     .","Detectamos que es posible que no tengas una experiencia ptima. Prueba en un dispositivo de escritorio.","Kami mendeteksi bahwa Anda mungkin tidak memiliki pengalaman yang optimal. Sebaiknya coba eksperimen ini di perangkat desktop.","Zjistili jsme, e vm experiment mon nefunguje sprvn. Zkuste ho spustit na potai.","Vi har registreret, at din oplevelse muligvis ikke er optimal. Prv eksperimentet p en computer i stedet!","Otkrili smo da moda nemate optimalan doivljaj. Mogli biste pokuati na raunalu!","szrevettk, hogy nem optimlis a felhasznli lmny. Prblja meg asztali eszkzn.","Esam konstatjui, ka js, iespjams, negstat optimlu pieredzi. Izminiet o eksperimentu dator!","We merken dat het niet optimaal voor je werkt. Probeer het eens op een desktop.","Wykrylimy nieoptymaln jako. Sprbuj na komputerze!","Detetmos que pode no estar a ter uma experincia ideal. Tente abri-lo num computador!","Am detectat c este posibil s nu beneficiai de o experien optim. ncercai pe un computer!"," ,    . ,   ?"],["performance_warning_dismiss","Continue with current device","Gaan voort op huidige toestel","Continuar con el dispositivo actual","Continuer avec l'appareil actuel","     ","Continua con il dispositivo corrente","Continuar com o dispositivo atual","Endelea kutumia kifaa unachotumia sasa","","  ","","","Mit aktuellem Gert fortfahren","   ","Contina con el dispositivo actual","Lanjutkan dengan perangkat saat ini","Pokraovat v aktulnm zazen","Fortst med den aktuelle enhed","Nastavite na trenutanom ureaju","Folytats a jelenlegi eszkzn","Turpint pareizj ierc","Doorgaan met het huidige apparaat","Kontynuuj na biecym urzdzeniu","Continuar com o dispositivo atual","Continuai pe dispozitivul actual","   "],["disclaimer_ios","This is an experiment using the latest web audio technology. It may not perform optimally on iPhone 6 and older devices","Dit is 'n eksperiment wat die jongste weboudiotegnologie gebruik. Dit sal dalk nie optimaal op iPhone 6 en ouer toestelle werk nie","Este experimento utiliza la tecnologa de audio web ms reciente. Es posible que no funcione de forma ptima en el iPhone 6 y en dispositivos ms antiguos.","Cette exprience utilise la technologie audio Web la plus rcente. Il est possible que les performances ne soient pas optimales sur un iPhone 6 et des appareils plus anciens","              .      iPhone 6           ","Questo  un esperimento che utilizza la tecnologia audio sul Web di ultima generazione. Potrebbe non funzionare in modo ottimale su iPhone 6 e dispositivi meno recenti","Este experimento usa tecnologias recentes de udio da Web. Talvez ele no funcione de maneira ideal no iPhone 6 e em dispositivos mais antigos","Hili ni jaribio linalotumia teknolojia mpya zaidi ya sauti kwenye wavuti. Huenda isifanye kazi vyema zaidi kwenye iPhone 6 na vifaa vya zamani","  iPhone 6 ","      . iPhone 6       ."," iPhone 6 ","iPhone 6 ","Dieses Experiment basiert auf der neuesten Web-Audiotechnologie. Auf dem iPhone 6 und lteren Gerten funktioniert es mglicherweise nicht optimal.","      ,      iPhone 6    .","Este experimento usa lo ltimo en tecnologa de audio web. Es posible que no funcione correctamente en iPhone 6 ni dispositivos ms antiguos.","Ini adalah eksperimen yang menggunakan teknologi audio web terbaru. Eksperimen ini mungkin tidak berfungsi optimal di iPhone 6 dan perangkat yang lebih lama.","Tento experiment vyuv nejnovj technologie zpracovn webovho zvuku. Na iPhonu 6 a starch zazench nemus fungovat sprvn","Dette er et eksperiment, der anvender den nyeste weblydsteknologi. Det fungerer muligvis ikke optimalt p iPhone 6 og ldre enheder","Ovo je eksperiment u kojem se koristi najnovija audiotehnologija za web. Moda nee optimalno funkcionirati na iPhoneu 6 i starijim ureajima","Ez egy ksrlet, amely a legfejlettebb internetes audiotechnolgit hasznlja. Elfordulhat, hogy az iPhone 6 vagy annl rgebbi eszkzkn nem optimlis a felhasznli lmny.","is ir eksperiments, kur tiek izmantota jaunk tmeka audio tehnoloija. Iespjams, tlrun iPhone 6 un vecks iercs eksperimenta darbba nebs optimla.","Dit is een experiment met de nieuwste webaudiotechnologie. Het werkt misschien niet optimaal op een iPhone 6 of oudere apparaten","To eksperyment wykorzystujcy najnowsze internetowe technologie dwiku. Moe nie dziaa optymalnie na iPhonie 6 i starszych urzdzeniach","Esta experincia utiliza a tecnologia mais recente de udio da Web. Pode no funcionar de forma perfeita no iPhone 6 e em dispositivos mais antigos","Acesta este un experiment care folosete cea mai recent tehnologie audio pentru web. Este posibil s nu funcioneze optim pe iPhone 6 i dispozitive mai vechi","     ,   iPhone 6        "],["info_body_disclaimer_ios","Blob Opera is an experiment using the latest web audio technology and may not perform optimally on iPhone 6 and older devices","Blob Opera is 'n eksperiment wat die jongste weboudiotegnologie gebruik en sal dalk nie optimaal op iPhone 6 en ouer toestelle werk nie","Blob Opera es un experimento que utiliza la tecnologa de audio web ms reciente y puede que no funcione de forma ptima en el iPhone 6 y en dispositivos ms antiguos.","Blob Opera est une exprience qui utilise la technologie audio Web la plus rcente. Il est possible que les performances ne soient pas optimales sur un iPhone 6 et des appareils plus anciens.","Blob Opera              .      iPhone 6           ","Blob Opera  un esperimento che utilizza la tecnologia audio sul Web di ultima generazione e potrebbe non funzionare in modo ottimale su iPhone 6 e dispositivi meno recenti","A Blob Opera  um experimento que usa tecnologias recentes de udio da Web e talvez no funcione de maneira ideal no iPhone 6 e em dispositivos mais antigos.","Blob Opera ni jaribio linalotumia teknolojia mpya zaidi ya sauti kwenye wavuti na huenda lisifanye kazi vyema kwenye iPhone 6 na vifaa vya zamani","Blob Opera   iPhone 6 ","        iPhone 6       .","Blob Opera  iPhone 6 ","Blob Opera iPhone 6 ","Blob Opera ist ein Experiment, das auf der neuesten Web-Audiotechnologie basiert, und funktioniert deshalb mglicherweise auf dem iPhone 6 und lteren Gerten nicht optimal","  Blob Opera    ,      iPhone 6    .","Blob Opera es un experimento que usa lo ltimo en tecnologa de audio web y es posible que no funcione correctamente en iPhone 6 y dispositivos ms antiguos","Blob Opera merupakan eksperimen yang menggunakan teknologi audio web terbaru dan mungkin tidak berfungsi optimal di iPhone 6 dan perangkat yang lebih lama","Blob Opera je experiment, kter vyuv nejnovj technologie zpracovn webovho zvuku a na iPhonu 6 a starch zazench nemus fungovat sprvn","Blob Opera er et eksperiment, der anvender den nyeste weblydsteknologi, hvorfor det muligvis ikke fungerer optimalt p iPhone 6 og ldre enheder","Blob Opera je eksperiment u kojem se koristi najnovija audiotehnologija za web, pa moda nee optimalno funkcionirati na iPhoneu 6 i starijim ureajima","A Blob Opera egy ksrlet, amely a legfejlettebb internetes audiotechnolgit hasznlja, ezrt elfordulhat, hogy az iPhone 6 vagy annl rgebbi eszkzkn nem nyjt optimlis lmnyt.","Blob Opera ir eksperiments, kur tiek izmantota jaunk tmeka audio tehnoloija. Iespjams, tlrun iPhone 6 un vecks iercs eksperimenta darbba nebs optimla.","Blob Opera is een experiment met de nieuwste webaudiotechnologie en werkt misschien niet optimaal op een iPhone 6 of oudere apparaten","Blob Opera to eksperyment wykorzystujcy najnowsze internetowe technologie dwiku i moe nie dziaa optymalnie na iPhonie 6 i starszych urzdzeniach","O Blob Opera  uma experincia que utiliza a tecnologia mais recente de udio da Web e pode no funcionar de forma perfeita no iPhone 6 e em dispositivos mais antigos","Opera cu bule este un experiment care folosete cea mai recent tehnologie audio pentru web i poate s nu funcioneze optim pe iPhone 6 i dispozitive mai vechi","Blob Opera       ,   iPhone 6        "],["disclaimer","This is an experiment using the latest web audio technology. It may not perform optimally on older devices.","Dit is 'n eksperiment wat die jongste weboudiotegnologie gebruik. Dit sal dalk nie optimaal op ouer toestelle werk nie.","Este experimento utiliza la tecnologa de audio web ms reciente. Es posible que no funcione de forma ptima en dispositivos antiguos.","Cette exprience utilise la technologie audio Web la plus rcente. Il est possible que les performances ne soient pas optimales sur des appareils plus anciens.","              .              .","Questo  un esperimento che utilizza la tecnologia audio sul Web di ultima generazione. Potrebbe non funzionare in modo ottimale su dispositivi meno recenti.","Este experimento usa tecnologias recentes de udio da Web. Talvez ele no funcione de maneira ideal em dispositivos mais antigos","Hili ni jaribio linalotumia teknolojia mpya zaidi ya sauti kwenye wavuti. Huenda lisifanye kazi vyema kwenye vifaa vya zamani.","  ","      .       .","","","Dieses Experiment basiert auf der neuesten Web-Audiotechnologie. Auf lteren Gerten funktioniert es deshalb mglicherweise nicht optimal.","      ,        .","Este experimento usa lo ltimo en tecnologa de audio web. Es posible que no funcione correctamente en dispositivos antiguos.","Ini adalah eksperimen yang menggunakan teknologi audio web terbaru. Eksperimen ini mungkin tidak berfungsi optimal di perangkat lama.","Tento experiment vyuv nejnovj technologie zpracovn webovho zvuku. Na starch zazench nemus fungovat sprvn.","Dette er et eksperiment, der anvender den nyeste weblydsteknologi. Det fungerer muligvis ikke optimalt p ldre enheder.","Ovo je eksperiment u kojem se koristi najnovija audiotehnologija za web. Moda nee optimalno funkcionirati na starijim ureajima","Ez egy ksrlet, amely a legfejlettebb internetes audiotechnolgit hasznlja. Elfordulhat, hogy rgebbi eszkzkn nem optimlis a felhasznli lmny.","is ir eksperiments, kur tiek izmantota jaunk tmeka audio tehnoloija. Iespjams, vecks iercs eksperimenta darbba nebs optimla.","Dit is een experiment met de nieuwste webaudiotechnologie. Het werkt misschien niet optimaal op oudere apparaten.","To eksperyment wykorzystujcy najnowsze internetowe technologie dwiku. Moe nie dziaa optymalnie na starszych urzdzeniach.","Esta experincia utiliza a tecnologia mais recente de udio da Web. Pode no funcionar de forma perfeita em dispositivos mais antigos.","Acesta este un experiment care folosete cea mai recent tehnologie audio pentru web. Poate s nu funcioneze optim pe dispozitive mai vechi.","     ,         ."],["prompt_locations","Take the blobs on tour!","Neem die blertse op toer!","Llvate a los blobs de gira!","Partez en tourne avec les blobs !","     !","Porta i blob in tour!","Leve os blobs em uma turn mundial!","Peleka blobu kwenye ziara!","","  "," blob ","","Gehen Sie mit den Blobs auf Tour!","    !","Lleva a los blobs de gira!","Ajak para blob melakukan tur","Vezmte bloby na turn!","Tag klumperne med p turn!","Povedite blobove na turneju!","Turnzzon a blobokkal!","Dodieties ar burbuiem turnej!","Ga met de blobs op tournee","Zabierz bloby w tras koncertow!","Leve os blobs em digresso!","Mergei cu bulele n turneu!","    !"],["location_blobpera_house","The Blobpera House","Die Blobpera-huis","The Blobpera House","La Blobpera House","The Blobpera House","La Blobpera House","Casa de Blobpera","The Blobpera House","","  ","The Blobpera House","","Das Blobpera House"," ","Blobpera House","Gedung Blobpera","Blobpern dm","Blobperahuset","Blobperna kua","A Blobperahz","The Blobpera House","Het Blobpera House","The Blobpera House","The Blobpera House","Opera cu bule","  "],["location_london","London, UK","Londen, VK","Londres (Reino Unido)","Londres, Royaume-Uni",", ","Londra, Regno Unito","Londres, Reino Unido","London, Uingereza",""," ","","","London, Vereinigtes Knigreich",", ","Londres, Reino Unido","London, Inggris Raya","Londn, Velk Britnie","London, Storbritannien","London, Ujedinjeno Kraljevstvo","London, Egyeslt Kirlysg","Londona, Lielbritnija","Londen (VK)","Londyn, Wielka Brytania","Londres, Reino Unido","Londra, Marea Britanie",", "],["location_paris","Paris, France","Parys, Frankryk","Pars (Francia)","Paris, France",", ","Parigi, Francia","Paris, Frana","Paris, Ufaransa",""," ","","","Paris, Frankreich",", ","Pars, Francia","Paris, Prancis","Pa, Francie","Paris, Frankrig","Pariz, Francuska","Prizs, Franciaorszg","Parze, Francija","Parijs, Frankrijk","Pary, Francja","Paris, Frana","Paris, Frana",", "],["location_new_york","New York, USA","New York, VSA","Nueva York (Estados Unidos)","New York, tats-Unis",", ","New York, Stati Uniti","Nova York, EUA","New York, Marekani",""," ","","","New York, USA","-, ","Nueva York, Estados Unidos","New York, Amerika Serikat","New York, USA","New York City, USA","New York, SAD","New York, Amerikai Egyeslt llamok","ujorka, ASV","New York, Verenigde Staten","Nowy Jork, Stany Zjednoczone","Nova Iorque, EUA","New York, Statele Unite","-, "],["location_cape_town","Cape Town, South Africa","Kaapstad, Suid-Afrika","Ciudad del Cabo (Sudfrica)","Le Cap, Afrique du Sud"," ,  ","Citt del Capo, Sudafrica","Cidade do Cabo, frica do Sul","Cape Town, Afrika Kusini","","  ","","","Kapstadt, Sdafrika",", ","Ciudad del Cabo, Sudfrica","Cape Town, Afrika Selatan","Kapsk Msto, Jihoafrick republika","Cape Town, Sydafrika","Cape Town, Junoafrika Republika","Fokvros, Dl-Afrika","Keiptauna, Dienvidfrika","Kaapstad, Zuid-Afrika","Kapsztad, RPA","Cidade do Cabo, frica do Sul","Cape Town, Africa de Sud",",  "],["location_mexico_city","Mexico City, Mexico","Meksikostad, Meksiko","Ciudad de Mxico (Mxico)","Mexico, Mexique"," , ","Citt del Messico, Messico","Cidade do Mxico, Mxico","Mexico City, Meksiko",""," ","","","Mexiko-Stadt, Mexiko",", ","Ciudad de Mxico, Mxico","Mexico City, Meksiko","Ciudad de Mxico, Mexiko","Mexico City, Mexico","Mexico City, Meksiko","Mexikvros, Mexik","Mehiko, Meksika","Mexico-Stad, Mexico","Meksyk (miasto), Meksyk","Cidade do Mxico, Mxico","Mexico City, Mexic",", "],["location_seoul","Seoul, South Korea","Seoel, Suid-Korea","Sel (Corea del Sur)","Soul, Core du Sud",",  ","Seul, Corea del Sud","Seul, Coreia do Sul","Seoul, Korea Kusini",""," ","","","Seoul, Sdkorea",",  ","Sel, Corea del Sur","Seoul, Korea Selatan","Soul, Jin Korea","Seoul, Sydkorea","Seoul, Juna Koreja","Szul, Dl-Korea","Seula, Dienvidkoreja","Seoel, Zuid-Korea","Seul, Korea Poudniowa","Seul, Coreia do Sul","Seoul, Coreea de Sud",",  "],["song_hallelujah_chorus_name","Hallelujah (Chorus)","Halleluja (koor)","Hallelujah (coros)","Hallelujah (chur)"," ()","Hallelujah (Chorus)","Hallelujah (refro)","Hallelujah (Kiitikio)","","Hallelujah()","Hallelujah","()","Halleluja (Chorstck)","Hallelujah (Chorus)","Coro de aleluya","Hallelujah (Chorus)","Aleluja (sbor)","Hallelujah (omkvd)","Aleluja (zbor)","Halleluja (krus)","Hallelujah (koris)","Hallelujah (Koor)","Alleluja (chr)","Hallelujah (refro)","Hallelujah (refren)","Hallelujah ()"],["song_hallelujah_chorus_description","George Frideric Handel","George Frideric Handel","George Frideric Handel","Georg Friedrich Haendel","  ","George Frideric Handel","George Frideric Handel","George Frideric Handel","  ","  ","","","Georg Friedrich Hndel","  ","George Frideric Handel","George Frideric Handel","Georg Friedrich Hndel","Georg Friedrich Hndel","George Frideric Handel","Georg Friedrich Hndel","Georgs Frdrihs Hendelis","George Frideric Handel","Georg Friedrich Hndel","George Frideric Handel","George Frideric Handel","  "],["song_londonderry_air_name","Londonderry Air","Londonderry Air","Londonderry Air","Londonderry Air"," ","Londonderry Air","Londonderry Air","Londonderry Air","","Londonderry Air","Londonderry Air","","Londonderry Air","Londonderry Air","Londonderry Air","Londonderry Air","Londonderry Air","Londonderry Air","Londonderry Air","Londonderry Air","Londonderry Air","Londonderry Air","Londonderry Air","Londonderry Air","Londonderry Air","Londonderry Air"],["song_londonderry_air_description","Traditional Irish song","Tradisionele Ierse liedjie","Cancin tradicional irlandesa","Chant traditionnel irlandais","  ","Brano tradizionale irlandese","Cano tradicional irlandesa","Wimbo wa kitamaduni wa Kiayalandi",""," ","","","Irisches Volkslied","  ","Cancin irlandesa tradicional","Lagu tradisional Irlandia","Tradin irsk pse","Traditionel irsk sang","Tradicionalna irska pjesma","Hagyomnyos r dal","Tradicionla ru dziesma","Traditioneel Iers nummer","Tradycyjna pie irlandzka","Cano tradicional irlandesa","Cntec tradiional irlandez","  "],["song_loch_lomond_name","Loch Lomond","Loch Lomond","Loch Lomond","Loch Lomond"," ","Loch Lomond","Loch Lomond","Loch Lomond"," ","Loch Lomond","Loch Lomond","","Loch Lomond","Loch Lomond","Loch Lomond","Loch Lomond","Loch Lomond","Loch Lomond","Loch Lomond","Loch Lomond","Loch Lomond","Loch Lomond","Loch Lomond","Loch Lomond","Loch Lomond","Loch Lomond"],["song_loch_lomond_description","Traditional Scottish song","Tradisionele Skotse liedjie","Cancin tradicional escocesa","Chant traditionnel cossais","  ","Brano tradizionale scozzese","Cano tradicional escocesa","Wimbo wa kitamaduni wa Uskoti",""," ","","","Schottisches Volkslied","  ","Cancin escocesa tradicional","Lagu tradisional Skotlandia","Tradin skotsk pse","Traditionel skotsk sang","Tradicionalna kotska pjesma","Hagyomnyos skt dal","Tradicionla skotu dziesma","Traditioneel Schots nummer","Tradycyjna pie szkocka","Cano tradicional escocesa","Cntec tradiional scoian","  "],["song_wellerman_name","Wellerman","Wellerman","Wellerman","Wellerman","","Wellerman","Wellerman","Wellerman","","Wellerman","Wellerman","Wellerman","Wellerman","Wellerman","Wellerman","Wellerman","Wellerman","Wellerman","Wellerman","Wellerman","Wellerman","Wellerman","Wellerman","Wellerman","Wellerman","Wellerman"],["song_wellerman_description","Traditional sea shanty","Tradisionele matroosliedjie","Cancin marinera tradicional","Chant de marin traditionnel","  ","Canto marinaresco tradizionale","Cano martima tradicional","Wimbo wa kitamaduni wa mabaharia",""," ","","","Traditionelles Seemannslied","  ","Sea shanty tradicional","Yel-yel laut tradisional","Tradin nmonick popvek","Traditionel shanty","Tradicionalna mornarska pjesma","Hagyomnyos tengersznta","Tradicionla jrnieku dziesma","Traditioneel matrozenliedje","Tradycyjna szanta","Cano martima tradicional","Cntec tradiional marinresc","  "],["song_ar_hyd_y_nos_name","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","   ","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos","Ar Hyd Y Nos"],["song_ar_hyd_y_nos_description","Traditional Welsh song","Tradisionele Walliese liedjie","Cancin tradicional galesa","Chant traditionnel gallois","  ","Brano tradizionale gallese","Cano tradicional galesa","Wimbo wa kitamaduni wa Wales",""," ","","","Walisisches Volkslied","  ","Cancin galesa tradicional","Lagu tradisional Wales","Tradin velsk pse","Traditionel walisisk sang","Tradicionalna velka pjesma","Hagyomnyos walesi dal","Tradicionla velsieu dziesma","Traditioneel Welsh nummer","Tradycyjna pie walijska","Cano tradicional galesa","Cntec tradiional galez","  "],["song_hun_honge_kamiyab_name","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","  ","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab","Hum Honge Kamiyab"],["song_hun_honge_kamiyab_description","A traditional Hindi song","n Tradisionele Hindi-liedjie","Cancin tradicional india","Chant traditionnel hindi","  ","Brano tradizionale hindi","Cano tradicional hindi","Wimbo wa kitamaduni wa Kihindi",""," ","","","Traditionelles Hindi-Lied","  ","Cancin hind tradicional","Lagu tradisional Hindi","Tradin hindsk pse","En traditionel hindisang","Tradicionalna hindska pjesma","Hagyomnyos hindi dal","Tradicionla hindu dziesma","Een traditioneel Hindi nummer","Tradycyjna pie w hindi","Uma cano tradicional em hindi","Cntec tradiional indian","  "],["song_new_world_symphony_name","Symphony No. 9 ","Symphony No. 9 (Negende simfonie)","Sinfona n. 9 ","Symphonie n 9","  9","Sinfonia n. 9","Sinfonia n 9","Symphony No. 9"," 9 ","Symphony No. 9","Symphony No. 9","","Symphonie Nr. 9","  9","Sinfona n. 9","Simfoni No. 9","Symfonie . 9","9. symfoni","Simfonija br. 9","9. (j vilg) szimfnia","9. simfonija","Symfonie nr. 9","Symfonia nr 9","Sinfonia N. 9","Simfonia nr. 9"," 9"],["song_new_world_symphony_description","Antonn Dvok","Antonn Dvok","Antonn Dvok","Antonn Dvok"," ","Antonn Dvok","Antonn Dvok","Antonn Dvok"," "," ","","","Antonn Dvok"," ","Antonn Dvok","Antonn Dvok","Antonn Dvok","Antonn Dvok","Antonn Dvok","Antonn Dvok","Antonns Dvorks","Antonn Dvok","Antonn Dvok","Antonn Dvok","Antonn Dvok"," "],["song_down_to_the_river_name","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","     ","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray","Down to the River to Pray"],["song_down_to_the_river_description","American folk song","Amerikaanse volksliedjie","Cancin popular norteamericana","Chanson populaire amricaine","  ","Brano tradizionale statunitense","Cano folclrica americana","Wimbo wa kitamaduni wa Marekani",""," ","","","Amerikanisches Spiritual","  ","Cancin popular estadounidense","Lagu rakyat Amerika","Americk lidov pse","Amerikansk folkesang","Amerika narodna pjesma","Amerikai npdal","Ameriku tautas dziesma","Amerikaans volksnummer","Amerykaska piosenka folkowa","Cano folclrica americana","Cntec folk american","  "],["song_frere_jacques_name","Frre Jacques","Frre Jacques (Vader Jakob)","Frre Jacques","Frre Jacques"," ","Fra' Martino","Frre Jacques","Frre Jacques"," ","Frre Jacques","Frre Jacques","","Frre Jacques","Frre Jacques","Frre Jacques","Frre Jacques","Frre Jacques","Mester Jakob","Frre Jacques","Frre Jacques","Frre Jacques","Vader Jacob","Frre Jacques","Frre Jacques","Frre Jacques","Frre Jacques"],["song_frere_jacques_description","Jean-Phillippe Rameau","Jean-Phillippe Rameau","Jean-Phillippe Rameau","Jean-Philippe Rameau","  ","Jean-Phillippe Rameau","Jean-Phillippe Rameau","Jean-Phillippe Rameau"," "," ","-","","Jean-Phillippe Rameau","- ","Jean-Phillippe Rameau","Jean-Phillippe Rameau","Jean-Phillippe Rameau","Jean-Philippe Rameau","Jean-Phillippe Rameau","Jean-Phillippe Rameau","ans Filips Ramo","Jean-Phillippe Rameau","Jean-Phillippe Rameau","Jean-Phillippe Rameau","Jean-Phillippe Rameau","- "],["song_gymnopedie_name","Gymnopdie No. 1","Gymnopdie No. 1","Gymnopdie No. 1","Gymnopdie n 1"," . 1","Gymnopdie No. 1","Gymnopdie n 1","Gymnopdie No. 1"," 1 ","Gymnopdie No. 1","Gymnopdie No. 1","Gymnopdie No. 1","Gymnopdie Nr. 1","Gymnopdie No. 1","Gymnopdie n. 1","Gymnopdie No. 1","Gymnopdie . 1","Gymnopdie nr. 1","Gimnopedija br. 1","1. Gymnopdies","Gymnopdie No. 1","Gymnopdie No. 1","Gymnopdie nr 1","Gymnopdie N. 1","Gymnopdie No. 1","Gymnopdie No. 1"],["song_gymnopedie_description","Erik Satie","Erik Satie","Erik Satie","Erik Satie"," ","Erik Satie","Erik Satie","Erik Satie"," "," ","","","Erik Satie"," ","Erik Satie","Erik Satie","Erik Satie","Erik Satie","Erik Satie","Erik Satie","Eriks Sat","Erik Satie","Erik Satie","Erik Satie","Erik Satie"," "],["song_habanera_name","Habaera (Carmen)","Habaera (Carmen)","Habanera (Carmen)","Habaera (Carmen)"," ()","Habaera (Carmen)","Habaera (Carmen)","Habaera (Carmen)","","Habaera(Carmen)","Habaera","Habaera()","Habaera (Carmen)",' ( "")',"Habanera (Carmen)","Habaera (Carmen)","Habaera (Carmen)","Habaera (Carmen)","Habaera (Carmen)","Habanera (Carmen)","Habaera (Karmena)","Habaera (Carmen)","Habaera (Carmen)","Habaera (Carmen)","Habaera (Carmen)","Habaera (Carmen)"],["song_habanera_description","Georges Bizet","Georges Bizet","Georges Bizet","Georges Bizet"," ","Georges Bizet","Georges Bizet","Georges Bizet"," "," ","","","Georges Bizet"," ","Georges Bizet","Georges Bizet","Georges Bizet","Georges Bizet","Georges Bizet","Georges Bizet","ors Biz","Georges Bizet","Georges Bizet","Georges Bizet","Georges Bizet"," "],["song_shosholoza_name","Shosholoza","Shosholoza","Shosholoza","Shosholoza","","Shosholoza","Shosholoza","Shosholoza","","Shosholoza","Shosholoza","Shosholoza","Shosholoza","Shosholoza","Shosholoza","Shosholoza","Shosholoza","Shosholoza","Shosholoza","Shosholoza","Shosholoza","Shosholoza","Shosholoza","Shosholoza","Shosholoza","Shosholoza"],["song_shosholoza_description","South African folk song","Suid-Afrikaanse volksliedjie","Cancin popular sudafricana","Chanson populaire sud-africaine","   ","Brano tradizionale sudafricano","Cano folclrica sul-africana","Wimbo wa kitamaduni wa Afrika Kusini","","  ","","","Sdafrikanisches Volkslied","  ","Cancin popular de Sudfrica","Lagu rakyat Afrika Selatan","Jihoafrick lidov pse","Sydafrikansk folkesang","Junoafrika narodna pjesma","Dl-afrikai npdal","Dienvidfriku tautas dziesma","Zuid-Afrikaans volksnummer","Poudniowoafrykaska piosenka ludowa","Cano folclrica sul-africana","Cntec folk sud-african","  "],["song_when_the_saints_name","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In","     ","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In","","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In","When the Saints Go Marching In","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In","When the Saints go Marching In"],["song_when_the_saints_description","American gospel song","Amerikaanse gospelliedjie","Cancin gospel norteamericana","Chanson gospel amricaine","       ","Brano gospel statunitense","Cano gospel americana","Wimbo wa injili wa Kimarekani",""," ","","","Amerikanischer Gospelsong","    ","Cancin gspel estadounidense","Lagu gospel Amerika","Americk gospel","Amerikansk gospelsang","Amerika gospel pjesma","Amerikai gospel himnusz","Ameriku gospelis","Amerikaans gospelnummer","Amerykaska piosenka gospel","Cano gospel americana","Cntec gospel american","    "],["song_lakdi_ki_kathi_name","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","  ","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi","Lakdi Ki Kathi"],["song_lakdi_ki_kathi_description","Traditional Hindi song","Tradisionele Hindi-liedjie","Cancin tradicional india","Chant traditionnel hindi","  ","Brano tradizionale hindi","Cano tradicional hindi","Wimbo wa kitamaduni wa Kihindi",""," ","","","Traditionelles Hindi-Lied","  ","Cancin hind tradicional","Lagu tradisional Hindi","Tradin hindsk pse","Traditionel hindisang","Tradicionalna hindska pjesma","Hagyomnyos hindi dal","Tradicionla hindu dziesma","Traditioneel Hindi nummer","Tradycyjna pie w hindi","Cano tradicional em hindi","Cntec tradiional indian","  "],["song_thula_baba_name","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana"," ,  ","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana","Thula Baba, Thula Sana"],["song_thula_baba_description","Zulu lullaby","Zoeloe-wiegeliedjie","Cancin de cuna zul","Berceuse zouloue","   ","Ninna nanna zul","Cano de ninar zulu","Bembezi ya Kizulu",""," ","","","Zulu-Schlaflied"," ","Cancin de cuna zul","Lagu tidur Zulu","Zulusk ukolbavka","Zuluvise","Zulu uspavanka","Zulu altat","Zulu pudziesma","Zulu slaapliedje","Koysanka zuluska","Cano de embalar zulu","Cntec de leagn Zulu"," "],["song_country_club_name","Country Club","Country Club","Country Club","Country Club"," ","Country Club","Country Club","Country Club"," ","Country Club","Country Club","Country Club","Country Club","Country Club","Country Club","Country Club","Country Club","Country Club","Country Club","Country Club","Country Club","Countryclub","Country Club","Country Club","Country Club","Country Club"],["song_country_club_description","Scott Joplin","Scott Joplin","Scott Joplin","Scott Joplin"," ","Scott Joplin","Scott Joplin","Scott Joplin"," "," ","","","Scott Joplin"," ","Scott Joplin","Scott Joplin","Scott Joplin","Scott Joplin","Scott Joplin","Scott Joplin","Skots Doplins","Scott Joplin","Scott Joplin","Scott Joplin","Scott Joplin"," "],["song_la_bamba_name","La Bamba","La Bamba","La bamba","La Bamba"," ","La Bamba","La Bamba","La Bamba"," ","La Bamba","La Bamba","La Bamba","La Bamba","La bamba","La bamba","La Bamba","La Bamba","La Bamba","La Bamba","La Bamba","La Bamba","La Bamba","La Bamba","La Bamba","La Bamba","La Bamba"],["song_la_bamba_description","Mexican folk song","Meksikaanse volksliedjie","Cancin popular mexicana","Chanson populaire mexicaine","  ","Brano tradizionale messicano","Cano folclrica mexicana","Wimbo wa kitamaduni wa Kimeksiko",""," ","","","Mexikanisches Volkslied","  ","Cancin popular mexicana","Lagu rakyat Meksiko","Mexick lidov pse","Mexicansk folkesang","Meksika narodna pjesma","Mexiki npdal","Meksiku tautas dziesma","Mexicaans volksnummer","Meksykaska piosenka ludowa","Cano folclrica mexicana","Cntec folk mexican","  "],["song_summertime_name","Summertime","Summertime","Summertime","Summertime","","Summertime","Summertime","Summertime","","Summertime","Summertime","","Summertime","Summertime","Summertime","Summertime","Summertime","Summertime","Summertime","Summertime","Summertime","Summertime","Summertime","Summertime","Summertime","Summertime"],["song_summertime_description","George Gershwin","George Gershwin","George Gershwin","George Gershwin"," ","George Gershwin","George Gershwin","George Gershwin"," "," ","","","George Gershwin"," ","George Gershwin","George Gershwin","George Gershwin","George Gershwin","George Gershwin","George Gershwin","Dords Grvins","George Gershwin","George Gershwin","George Gershwin","George Gershwin"," "],["song_la_llorona_name","La Llorona","La Llorona","La llorona","La Llorona"," ","La Llorona","La Llorona","La Llorona"," ","La Llorona","La Llorona","La Llorona","La Llorona","La Llorona","La llorona","La Llorona","La Llorona","La Llorona","La Llorona","La Llorona","La Llorona","La Llorona","La Llorona","La Llorona","La Llorona","La Llorona"],["song_la_llorona_description","Mexican folk song","Meksikaanse volksliedjie","Cancin popular mexicana","Chanson populaire mexicaine","  ","Brano tradizionale messicano","Cano folclrica mexicana","Wimbo wa kitamaduni wa Kimeksiko",""," ","","","Mexikanisches Volkslied","  ","Cancin popular mexicana","Lagu rakyat Meksiko","Mexick lidov pse","Mexicansk folkesang","Meksika narodna pjesma","Mexiki npdal","Meksiku tautas dziesma","Mexicaans volksnummer","Meksykaska piosenka ludowa","Cano folclrica mexicana","Cntec folk mexican","  "],["song_dynamite_name","Dynamite ","Dynamite","Dynamite ","Dynamite","","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite","Dynamite"],["song_dynamite_description","BTS","BTS","BTS","BTS","","BTS","BTS","BTS","BTS","","","","BTS","BTS","BTS","BTS","BTS","BTS","BTS","BTS","BTS","BTS","BTS","BTS","BTS","BTS"],["song_dios_nunca_muera_name","Dios Nunca Muere","Dios Nunca Muere","Dios nunca muere","Dios Nunca Muere","  ","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere","Dios Nunca Muere"],["song_dios_nunca_muera_description","Macedonio Alcal","Macedonio Alcal","Macedonio Alcal","Macedonio Alcal"," ","Macedonio Alcal","Macedonio Alcal","Macedonio Alcal"," "," ","","","Macedonio Alcal"," ","Macedonio Alcal","Macedonio Alcal","Macedonio Alcal","Macedonio Alcal","Macedonio Alcal","Macedonio Alcal","Masedonio Alkala","Macedonio Alcal","Macedonio Alcal","Macedonio Alcal","Macedonio Alcal"," "],["song_nkosi_name","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","  ","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika","Nkosi Sikelel' iAfrika"],["song_nkosi_description","Enoch Sontonga","Enoch Sontonga","Enoch Sontonga","Enoch Sontonga"," ","Enoch Sontonga","Enoch Sontonga","Enoch Sontonga"," "," ","","","Enoch Sontonga"," ","Enoch Sontonga","Enoch Sontonga","Enoch Sontonga","Enoch Sontonga","Enoch Sontonga","Enoch Sontonga","Enohs Sontonga","Enoch Sontonga","Enoch Sontonga","Enoch Sontonga","Enoch Sontonga"," "],["song_arirang_name","Arirang","Arirang","Arirang","Arirang","","Arirang","Arirang","Arirang","","","","","Arirang","Arirang","Arirang","Arirang","Arirang","Arirang","Arirang","Arirang","Arirang","Arirang","Arirang","Arirang","Arirang","Arirang"],["song_arirang_description","Korean folk song","Koreaanse volksliedjie","Cancin popular coreana","Chanson populaire corenne","  ","Brano tradizionale coreano","Cano folclrica coreana","Wimbo wa kitamaduni wa Kikorea",""," ","","","Koreanisches Volkslied","  ","Cancin popular coreana","Lagu rakyat Korea","Korejsk lidov pse","Koreansk folkesang","Korejska narodna pjesma","Koreai npdal","Korejieu tautas dziesma","Koreaans volksnummer","Koreaska piosenka ludowa","Cano folclrica coreana","Cntec folk coreean","  "],["song_han_river_name","Han River","Han River","Han River","Han River"," ","Han River","Han River","Han River","","","","","Han River","Han River","Han River","Han River","eka Han","Han-floden","Han River","Han","Han River","Han River","Han River","Han River","Han River","Han River"],["song_han_river_description","Korean folk song","Koreaanse volksliedjie","Cancin popular coreana","Chanson populaire corenne","  ","Brano tradizionale coreano","Cano folclrica coreana","Wimbo wa kitamaduni wa Kikorea",""," ","","","Koreanisches Volkslied","  ","Cancin popular coreana","Lagu rakyat Korea","Korejsk lidov pse","Koreansk folkesang","Korejska narodna pjesma","Koreai npdal","Korejieu tautas dziesma","Koreaans volksnummer","Koreaska piosenka ludowa","Cano folclrica coreana","Cntec folk coreean","  "],["song_doraji_name","Doraji Taryeong","Doraji Taryeong","Doraji Taryeong","Doraji Taryeong"," ","Doraji Taryeong","Doraji Taryeong","Doraji Taryeong","","","","","Doraji Taryeong","Doraji Taryeong","Doraji Taryeong","Doraji Taryeong","Doraji Taryeong","Doraji Taryeong","Doraji Taryeong","Doraji taryeong","Doraji Taryeong","Doraji Taryeong","Doraji Taryeong","Doraji Taryeong","Doraji Taryeong","Doraji Taryeong"],["song_doraji_description","Korean folk song","Koreaanse volksliedjie","Cancin popular coreana","Chanson populaire corenne","  ","Brano tradizionale coreano","Cano folclrica coreana","Wimbo wa kitamaduni wa Kikorea",""," ","","","Koreanisches Volkslied","  ","Cancin popular coreana","Lagu rakyat Korea","Korejsk lidov pse","Koreansk folkesang","Korejska narodna pjesma","Koreai npdal","Korejieu tautas dziesma","Koreaans volksnummer","Koreaska piosenka ludowa","Cano folclrica coreana","Cntec folk coreean","  "],["song_jingle_bells_name","Jingle Bells","Jingle Bells","Jingle Bells","Jingle Bells"," ","Jingle Bells","Jingle Bells","Jingle Bells","","Jingle Bells","","","Jingle Bells","Jingle Bells","Jingle Bells","Jingle Bells","Rolniky","Jingle Bells","Jingle Bells","Jingle Bells","Jingle Bells (Zvani skan)","Jingle Bells","Jingle Bells","Jingle Bells","Jingle Bells","Jingle Bells"],["song_silent_night_name","Silent Night","Silent Night (Stille nag)","Silent Night","Silent Night"," ","Astro del Ciel","Silent Night","Silent Night","","Silent Night","Silent Night","","Silent Night","Silent Night","Silent Night","Silent Night","Tich noc","Silent Night","Silent Night","Csendes j","Silent Night (Klusa nakts)","Stille Nacht","Silent Night","Silent Night","Silent Night","Silent Night"],["song_joy_to_the_world_name","Joy to the World","Joy to the World","Joy to the World","Joy to the World","   ","Joy to the World","Joy to the World","Joy to the World","","Joy to the World","Joy to the World","","Joy to the World","Joy to the World","Joy to the World","Joy to the World","Joy to the World","Joy to the World","Joy to the World","Joy to the World","Joy to the World (Prieks pasaulei)","Joy to the World","Joy to the World","Joy to the World","Joy to the World","Joy to the World"],["song_hark_the_herald_angels_sing_name","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","!    ","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing","Hark! The Herald Angels Sing"],["song_away_in_a_manger_name","Away in a Manger","Away in a Manger (Al was ek nie daar nie)","Away in a Manger","Away in a Manger","   ","Away in a Manger","Away in a Manger","Away in a Manger","","Away in a Manger","Away in a Manger","","Away in a Manger","Away in a Manger","Away in a Manger","Away in a Manger","Away in a Manger","Away in a Manger","Away in a Manger","Away in a Manger","Away in a Manger (Tur Btlem, silt)","Away in a Manger","Away in a Manger","Away in a Manger","Away in a Manger","Away in a Manger"],["song_o_come_all_ye_faithful_name","O Come All Ye Faithful","O Come All Ye Faithful (Kom alle getroues)","O Come All Ye Faithful","O Come All Ye Faithful","    ","Adeste fideles","O Come All Ye Faithful","O Come All Ye Faithful","","O Come All Ye Faithful","O Come All Ye Faithful","","O Come All Ye Faithful","O Come All Ye Faithful","O Come All Ye Faithful","O Come All Ye Faithful","O Come All Ye Faithful","O Come All Ye Faithful","O Come All Ye Faithful","Adeste fideles","O Come All Ye Faithful (Ak, ticgie, nciet)","O Come All Ye Faithful","O Come All Ye Faithful","O Come All Ye Faithful","O Come All Ye Faithful","O Come All Ye Faithful"],["song_the_first_noel_name","The First Noel","The First Noel","The First Noel","The First Noel","  ","The First Noel","The First Noel","The First Noel","","The First Noel","The First Noel","","The First Noel","The First Noel","The First Noel","The First Noel","The First Noel","The First Noel","The First Noel","The First Noel","The First Noel","The First Noel","The First Noel","The First Noel","The First Noel","The First Noel"],["song_once_in_royal_davids_city_name","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City","    ","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City","","Once in Royal David's City","Once in Royal David's City","","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City","Once in Royal David's City"],["song_auld_lang_syne_name","Auld Lang Syne","Auld Lang Syne","Auld Lang Syne","Auld Lang Syne","  ","Auld Lang Syne","Auld Lang Syne","Auld Lang Syne","","Auld Lang Syne","","","Auld Lang Syne","Auld Lang Syne","Auld Lang Syne","Auld Lang Syne","Auld Lang Syne","Auld Lang Syne","Auld Lang Syne","Gyertyafny kering","Auld Lang Syne","Auld Lang Syne","Auld Lang Syne","Auld Lang Syne","Auld Lang Syne","Auld Lang Syne"],["prompt_newyear","Ring in the New Year!","Lui die nuwe jaar in!","Ring in the New Year!","Ftez la nouvelle anne !","    !","Accogli il nuovo anno in musica!","Feliz Ano Novo!","Ring in the New Year!","","Ring in the New Year!","","","Lute das neue Jahr ein!","  !","Canta en Ao Nuevo!","Ring in the New Year!","Pivtejte nov rok!","Ring nytret ind!","Ring in the New Year!","Ring in the New Year!","Ring in the New Year! (Ieskandiniet Jauno gadu!)","Luid het nieuwe jaar in","Ring in the New Year!","Ring in the New Year!","S srbtorim intrarea n noul an!","  !"],["prompt_newyear_song","Sing Auld Lang Syne ","Sing Auld Lang Syne","Sing Auld Lang Syne ",'Chantez "Auld Lang Syne"',"   ","Canta Auld Lang Syne","Cante Auld Lang Syne","Sing Auld Lang Syne","","Sing Auld Lang Syne","","","Auld Lang Syne singen"," Auld Lang Syne","Canta Auld Lang Syne","Sing Auld Lang Syne","Zazpvejte si Auld Lang Syne","Syng Auld Lang Syne","Pjevajte Auld Lang Syne","nekelje a Gyertyafny keringt","Dziediet dziesmu Auld Lang Syne","Zing Auld Lang Syne","Zapiewaj Auld Lang Syne","Sing Auld Lang Syne","Cntai Auld Lang Syne"," Auld Lang Syne"],["axl_share_festive_recording_cc","Listen to <song> performed by Blob Opera. Then play four opera voices to create your own composition  ","Luister na <song>, uitgevoer deur Blob Opera. Speel dan vier operastemme om jou eie komposisie te skep","Escucha <song> interpretada por Blob Opera. Luego, reproduce las cuatro voces de pera para crear tu propia composicin ",'coutez "<song>" interprte par le Blob Opera. Faites ensuite chanter quatre voix d\'opra pour crer votre propre uvre '," <song>   Blob Opera   ,    .  ,     ,      ","Ascolta <song> eseguita da Blob Opera. Poi fai cantare quattro voci liriche per creare la tua composizione","Oua a cano <song> cantada pela Blob Opera. Em seguida, toque quatro vozes de pera para criar sua prpria composio","Sikiliza <song> unaoimbwa na Blob Opera. Kisha ucheze sauti nne za opera ili utunge wimbo wako mwenyewe ","Blob Opera  <song>  4  ","   <song>() .        . "," Blob Opera <song> 4  "," Blob Opera <song>","Hren Sie sich <song> an, vorgetragen von Blob Opera. Kreieren Sie dann mit den vier Opernstimmen eine eigene Komposition ",'  "<song>"   Blob Opera,        . ',"Escucha <song> interpretada por Blob Opera. Luego, reproduce las cuatro voces de pera para crear tu propia composicin ","Dengarkan lagu <song> yang dibawakan oleh Blob Opera. Kemudian mainkan empat suara opera untuk menciptakan komposisi Anda sendiri. ","Poslechnte si <song> v podn Blob Opera. Potom si hrajte se tymi opernmi hlasy a vytvote z nich vlastn skladbu ","Hr <song> af Blob Opera. Afspil derefter fire operastemmer for at skabe din egen komposition ",'Sluajte pjesmu <song> u izvedbi Blob Opere. Zatim "svirajte" etiri operna glasa da biste skladali vlastitu skladbu ',"Hallgassa meg a(z) <song> cm dalt a Blob Opera eladsban. Jtsszon ngy operanekes hangjn, majd szerezzen sajt zent. ","Klausieties, k dziesmu <song> atskao Blob Opera dziedtji. Pc tam atskaojiet etras operdziedtju balsis, lai sacertu savu skadarbu. ","Luister naar <song> uitgevoerd door Blob Opera. Speel daarna 4 operastemmen af en stel je eigen compositie samen ","Posuchaj utworu <song> w wykonaniu Blob Opera. Nastpnie odtwrz 4 gosy operowe i stwrz wasn kompozycj ","Oua <song> interpretada pelo Blob Opera. Em seguida, toque quatro vozes de pera para criar a sua prpria composio ","Ascultai <song> interpretat de Opera cu bule. Apoi redai patru voci de oper pentru a crea propria compoziie ","  <song>   Blob Opera,         "]]},function(e,t,i){"use strict";var n,o=function(){var e={};return function(t){if(void 0===e[t]){var i=proxiesWindow.document.querySelector(t);if(proxiesWindow.HTMLIFrameElement&&i instanceof proxiesWindow.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),r=[];function a(e){for(var t=-1,i=0;i<r.length;i++)if(r[i].identifier===e){t=i;break}return t}function s(e,t){for(var i={},n=[],o=0;o<e.length;o++){var s=e[o],l=t.base?s[0]+t.base:s[0],u=i[l]||0,c="".concat(l," ").concat(u);i[l]=u+1;var h=a(c),d={css:s[1],media:s[2],sourceMap:s[3]};-1!==h?(r[h].references++,r[h].updater(d)):r.push({identifier:c,updater:m(d,t),references:1}),n.push(c)}return n}function l(e){var t=proxiesWindow.document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var r=i.nc;r&&(n.nonce=r)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var a=o(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function h(e,t,i,n){var o=i?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=c(t,o);else{var r=proxiesWindow.document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(r,a[t]):e.appendChild(r)}}function d(e,t,i){var n=i.css,o=i.media,r=i.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),r&&void 0!==proxiesWindow.btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(proxiesWindow.btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(proxiesWindow.document.createTextNode(n))}}var f=null,p=0;function m(e,t){var i,n,o;if(t.singleton){var r=p++;i=f||(f=l(t)),n=h.bind(null,i,r,!1),o=h.bind(null,i,r,!0)}else i=l(t),n=d.bind(null,i,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===n&&(n=Boolean(proxiesWindow&&proxiesWindow.document&&proxiesWindow.document.all&&!proxiesWindow.atob)),n));var i=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<i.length;n++){var o=a(i[n]);r[o].references--}for(var l=s(e,t),u=0;u<i.length;u++){var c=a(i[u]);0===r[c].references&&(r[c].updater(),r.splice(c,1))}i=l}}}},function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=e(t);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,n){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(n)for(var r=0;r<this.length;r++){var a=this[r][0];null!=a&&(o[a]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);n&&o[l[0]]||(i&&(l[2]?l[2]="".concat(i," and ").concat(l[2]):l[2]=i),t.push(l))}},t}},function(e,t,i){(function(e){!function(e){"use strict";var t,i=function(){try{if(e.URLSearchParams&&"bar"===new e.URLSearchParams("foo=bar").get("foo"))return e.URLSearchParams}catch(e){}return null}(),n=i&&"a=1"===new i({a:1}).toString(),o=i&&"+"===new i("s=%2B").get("s"),r=!i||((t=new i).append("s"," &"),"s=+%26"===t.toString()),a=c.prototype,s=!(!e.Symbol||!e.Symbol.iterator);if(!(i&&n&&o&&r)){a.append=function(e,t){m(this.__URLSearchParams__,e,t)},a.delete=function(e){delete this.__URLSearchParams__[e]},a.get=function(e){var t=this.__URLSearchParams__;return this.has(e)?t[e][0]:null},a.getAll=function(e){var t=this.__URLSearchParams__;return this.has(e)?t[e].slice(0):[]},a.has=function(e){return b(this.__URLSearchParams__,e)},a.set=function(e,t){this.__URLSearchParams__[e]=[""+t]},a.toString=function(){var e,t,i,n,o=this.__URLSearchParams__,r=[];for(t in o)for(i=h(t),e=0,n=o[t];e<n.length;e++)r.push(i+"="+h(n[e]));return r.join("&")};var l=!!o&&i&&!n&&e.Proxy;Object.defineProperty(e,"URLSearchParams",{value:l?new Proxy(i,{construct:function(e,t){return new e(new c(t[0]).toString())}}):c});var u=e.URLSearchParams.prototype;u.polyfill=!0,u.forEach=u.forEach||function(e,t){var i=p(this.toString());Object.getOwnPropertyNames(i).forEach((function(n){i[n].forEach((function(i){e.call(t,i,n,this)}),this)}),this)},u.sort=u.sort||function(){var e,t,i,n=p(this.toString()),o=[];for(e in n)o.push(e);for(o.sort(),t=0;t<o.length;t++)this.delete(o[t]);for(t=0;t<o.length;t++){var r=o[t],a=n[r];for(i=0;i<a.length;i++)this.append(r,a[i])}},u.keys=u.keys||function(){var e=[];return this.forEach((function(t,i){e.push(i)})),f(e)},u.values=u.values||function(){var e=[];return this.forEach((function(t){e.push(t)})),f(e)},u.entries=u.entries||function(){var e=[];return this.forEach((function(t,i){e.push([i,t])})),f(e)},s&&(u[e.Symbol.iterator]=u[e.Symbol.iterator]||u.entries)}function c(e){((e=e||"")instanceof URLSearchParams||e instanceof c)&&(e=e.toString()),this.__URLSearchParams__=p(e)}function h(e){var t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'\(\)~]|%20|%00/g,(function(e){return t[e]}))}function d(e){return e.replace(/[ +]/g,"%20").replace(/(%[a-f0-9]{2})+/gi,(function(e){return decodeURIComponent(e)}))}function f(t){var i={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return s&&(i[e.Symbol.iterator]=function(){return i}),i}function p(e){var t={};if("object"==typeof e)if(g(e))for(var i=0;i<e.length;i++){var n=e[i];if(!g(n)||2!==n.length)throw new TypeError("Failed to construct 'URLSearchParams': Sequence initializer must only contain pair elements");m(t,n[0],n[1])}else for(var o in e)e.hasOwnProperty(o)&&m(t,o,e[o]);else{0===e.indexOf("?")&&(e=e.slice(1));for(var r=e.split("&"),a=0;a<r.length;a++){var s=r[a],l=s.indexOf("=");-1<l?m(t,d(s.slice(0,l)),d(s.slice(l+1))):s&&m(t,d(s),"")}}return t}function m(e,t,i){var n="string"==typeof i?i:null!=i&&"function"==typeof i.toString?i.toString():JSON.stringify(i);b(e,t)?e[t].push(n):e[t]=[n]}function g(e){return!!e&&"[object Array]"===Object.prototype.toString.call(e)}function b(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(void 0!==e?e:"undefined"!=typeof proxiesWindow?proxiesWindow:this)}).call(this,i(16))},function(e,t,i){"use strict";function n(e,t,i,n){var r=e.createProgram(),a=o(e,e.VERTEX_SHADER,t),s=o(e,e.FRAGMENT_SHADER,i);for(var l in e.attachShader(r,a),e.attachShader(r,s),n)e.bindAttribLocation(r,n[l],l);e.linkProgram(r);for(var u={},c=e.getProgramParameter(r,e.ACTIVE_UNIFORMS),h=0;h<c;h+=1){var d=e.getActiveUniform(r,h),f=e.getUniformLocation(r,d.name);u[d.name]=f}return{program:r,uniformLocations:u,vertexShaderSource:t,fragmentShaderSource:i}}function o(e,t,i){var n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)||console.log(e.getShaderInfoLog(n)),n}function r(e,t,i,n,o,r,a,s,l,u,c){var h=e.createTexture();return e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,h),e.texImage2D(e.TEXTURE_2D,0,i,o,r,0,i,n,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,l),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,u),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,c),h}function a(e,t,i,n,o,r,a,s,l,u,c,h){return e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,n,r,a,0,n,o,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,l),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,u),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,c),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,h),t}function s(e,t,i,n,o,r,a,s){void 0===s&&(s=!1);var l=e.createTexture();return e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,l),s&&e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,a),r!==e.LINEAR_MIPMAP_LINEAR&&r!==e.LINEAR_MIPMAP_NEAREST||e.generateMipmap(e.TEXTURE_2D),l}function l(e,t,i,n){var o=e.createRenderbuffer();return e.bindRenderbuffer(e.RENDERBUFFER,o),e.renderbufferStorage(e.RENDERBUFFER,t,i,n),o}function u(e,t,i,n){var o=e.createBuffer();return e.bindBuffer(t,o),e.bufferData(t,i,n),o}i.r(t);var c,h,d={set:function(e,t,i,n,o,r,a,s,l,u,c,h,d,f,p,m,g){e[0]=t,e[1]=i,e[2]=n,e[3]=o,e[4]=r,e[5]=a,e[6]=s,e[7]=l,e[8]=u,e[9]=c,e[10]=h,e[11]=d,e[12]=f,e[13]=p,e[14]=m,e[15]=g},copy:function(e,t){for(var i=0;i<16;i++)e[i]=t[i]},makeIdentity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},makeTranslation:function(e,t,i,n){return d.makeIdentity(e),e[12]=t,e[13]=i,e[14]=n,e},makeScale:function(e,t,i,n){return e[0]=t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},makeXRotation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=Math.cos(t),e[6]=Math.sin(t),e[7]=0,e[8]=0,e[9]=-Math.sin(t),e[10]=Math.cos(t),e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},makeYRotation:function(e,t){return e[0]=Math.cos(t),e[1]=0,e[2]=-Math.sin(t),e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=Math.sin(t),e[9]=0,e[10]=Math.cos(t),e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},transformPosition:function(e,t,i){var n=t[0],o=t[1],r=t[2];return e[0]=i[0]*n+i[4]*o+i[8]*r+i[12],e[1]=i[1]*n+i[5]*o+i[9]*r+i[13],e[2]=i[2]*n+i[6]*o+i[10]*r+i[14],e[3]=i[3]*n+i[7]*o+i[11]*r+i[15],e},transformDirection:function(e,t,i){var n=t[0],o=t[1],r=t[2];return e[0]=i[0]*n+i[4]*o+i[8]*r,e[1]=i[1]*n+i[5]*o+i[9]*r,e[2]=i[2]*n+i[6]*o+i[10]*r,e[3]=i[3]*n+i[7]*o+i[11]*r,e},multiplyVector:function(e,t,i){var n=i[0],o=i[1],r=i[2],a=i[3];return e[0]=t[0]*n+t[4]*o+t[8]*r+t[12]*a,e[1]=t[1]*n+t[5]*o+t[9]*r+t[13]*a,e[2]=t[2]*n+t[6]*o+t[10]*r+t[14]*a,e[3]=t[3]*n+t[7]*o+t[11]*r+t[15]*a,e},premultiply:function(e,t,i){var n=i[0],o=i[4],r=i[8],a=i[12],s=i[1],l=i[5],u=i[9],c=i[13],h=i[2],d=i[6],f=i[10],p=i[14],m=i[3],g=i[7],b=i[11],v=i[15],y=t[0],x=t[1],_=t[2],w=t[3];return e[0]=n*y+o*x+r*_+a*w,e[1]=s*y+l*x+u*_+c*w,e[2]=h*y+d*x+f*_+p*w,e[3]=m*y+g*x+b*_+v*w,y=t[4],x=t[5],_=t[6],w=t[7],e[4]=n*y+o*x+r*_+a*w,e[5]=s*y+l*x+u*_+c*w,e[6]=h*y+d*x+f*_+p*w,e[7]=m*y+g*x+b*_+v*w,y=t[8],x=t[9],_=t[10],w=t[11],e[8]=n*y+o*x+r*_+a*w,e[9]=s*y+l*x+u*_+c*w,e[10]=h*y+d*x+f*_+p*w,e[11]=m*y+g*x+b*_+v*w,y=t[12],x=t[13],_=t[14],w=t[15],e[12]=n*y+o*x+r*_+a*w,e[13]=s*y+l*x+u*_+c*w,e[14]=h*y+d*x+f*_+p*w,e[15]=m*y+g*x+b*_+v*w,e},transpose:function(e,t){if(e===t){var i=t[1],n=t[2],o=t[3],r=t[6],a=t[7],s=t[11];t[1]=t[4],t[4]=i,t[2]=t[8],t[8]=n,t[3]=t[12],t[12]=o,t[6]=t[9],t[9]=r,t[7]=t[13],t[13]=a,t[11]=t[14],t[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]},invert:function(e,t){var i=t[0],n=t[4],o=t[8],r=t[12],a=t[1],s=t[5],l=t[9],u=t[13],c=t[2],h=t[6],d=t[10],f=t[14],p=t[3],m=t[7],g=t[11],b=t[15],v=d*b,y=f*g,x=h*b,_=f*m,w=h*g,P=d*m,S=c*b,k=f*p,A=c*g,T=d*p,E=c*m,M=h*p,R=o*u,B=r*l,C=n*u,F=r*s,L=n*l,I=o*s,D=i*u,j=r*a,O=i*l,z=o*a,N=i*s,H=n*a,U=v*s+_*l+w*u-(y*s+x*l+P*u),G=y*a+S*l+T*u-(v*a+k*l+A*u),W=x*a+k*s+E*u-(_*a+S*s+M*u),V=P*a+A*s+M*l-(w*a+T*s+E*l),Y=1/(i*U+n*G+o*W+r*V);return e[0]=Y*U,e[1]=Y*G,e[2]=Y*W,e[3]=Y*V,e[4]=Y*(y*n+x*o+P*r-(v*n+_*o+w*r)),e[5]=Y*(v*i+k*o+A*r-(y*i+S*o+T*r)),e[6]=Y*(_*i+S*n+M*r-(x*i+k*n+E*r)),e[7]=Y*(w*i+T*n+E*o-(P*i+A*n+M*o)),e[8]=Y*(R*m+F*g+L*b-(B*m+C*g+I*b)),e[9]=Y*(B*p+D*g+z*b-(R*p+j*g+O*b)),e[10]=Y*(C*p+j*m+N*b-(F*p+D*m+H*b)),e[11]=Y*(I*p+O*m+H*g-(L*p+z*m+N*g)),e[12]=Y*(C*d+I*f+B*h-(L*f+R*h+F*d)),e[13]=Y*(O*f+R*c+j*d-(D*d+z*f+B*c)),e[14]=Y*(D*h+H*f+F*c-(N*f+C*c+j*h)),e[15]=Y*(N*d+L*c+z*h-(O*h+H*d+I*c)),e},fromQuaternion:function(e,t){var i=t[3],n=t[0],o=t[1],r=t[2];return e[0]=1-2*o*o-2*r*r,e[1]=2*n*o+2*i*r,e[2]=2*n*r-2*i*o,e[3]=0,e[4]=2*n*o-2*i*r,e[5]=1-2*n*n-2*r*r,e[6]=2*o*r+2*i*n,e[7]=0,e[8]=2*n*r+2*i*o,e[9]=2*o*r-2*i*n,e[10]=1-2*n*n-2*o*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},makePerspective:function(e,t,i,n,o){var r=1/Math.tan(t/2),a=1/(n-o);return e[0]=r/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(o+n)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*o*n*a,e[15]=0,e},makeInfinitePerspective:function(e,t,i,n,o){var r=1/Math.tan(t/2);return e[0]=r/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=-.99999999,e[11]=-1,e[12]=0,e[13]=0,e[14]=-1.99999999*n,e[15]=0,e},makePerspectiveHorizontal:function(e,t,i,n,o){var r=1/Math.tan(t/2),a=1/(n-o);return e[0]=r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r*i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(o+n)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*o*n*a,e[15]=0,e},makeLookAt:function(e,t,i,n){var o=t[0],r=t[1],a=t[2],s=n[0],l=n[1],u=n[2],c=o-i[0],h=r-i[1],d=a-i[2],f=c*c+h*h+d*d;f>0&&(c*=f=1/Math.sqrt(f),h*=f,d*=f);var p=l*d-u*h,m=u*c-s*d,g=s*h-l*c;return(f=p*p+m*m+g*g)>0&&(p*=f=1/Math.sqrt(f),m*=f,g*=f),e[0]=p,e[1]=m,e[2]=g,e[3]=0,e[4]=h*g-d*m,e[5]=d*p-c*g,e[6]=c*m-h*p,e[7]=0,e[8]=c,e[9]=h,e[10]=d,e[11]=0,e[12]=o,e[13]=r,e[14]=a,e[15]=1,e},makeOrthographic:function(e,t,i,n,o,r,a){return e[0]=2/(i-t),e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2/(o-n),e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=-2/(a-r),e[11]=0,e[12]=-(i+t)/(i-t),e[13]=-(o+n)/(o-n),e[14]=-(a+r)/(a-r),e[15]=1,e}},f=i(2),p=i(0),m=i(3),g=function(){function e(e,t,i){this.centerPosition=new Float32Array(3),this.attachPosition=new Float32Array(3),this.lookPitch=0,this.lookYaw=0,this.lookDirection=new Float32Array([0,0,1]),this.localLookDirection=new Float32Array([0,0,1]),this.gl=e,this.module=t,this.eyePointer=i,this.vertexCount=this.module._eyeGetVertexCount(this.eyePointer),this.indexCount=this.module._eyeGetIndexCount(this.eyePointer);var n=this.module.HEAPU16.subarray(this.module._eyeGetIndices(this.eyePointer)>>1,(this.module._eyeGetIndices(this.eyePointer)>>1)+this.indexCount);this.indexBuffer=u(e,e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW),this.positionsBuffer=e.createBuffer(),this.normalsBuffer=e.createBuffer();var o=this.module.HEAPF32.subarray(this.module._eyeGetRestPositions(this.eyePointer)>>2,(this.module._eyeGetRestPositions(this.eyePointer)>>2)+3*this.vertexCount);this.restPositionsBuffer=u(e,e.ARRAY_BUFFER,o,e.STATIC_DRAW);var r=this.module.HEAPF32.subarray(this.module._eyeGetUVs(this.eyePointer)>>2,(this.module._eyeGetUVs(this.eyePointer)>>2)+2*this.vertexCount);this.uvsBuffer=u(e,e.ARRAY_BUFFER,r,e.STATIC_DRAW)}return e.prototype.step=function(e,t){var i=this.module.HEAPF32.subarray(this.module._eyeGetPositions(this.eyePointer)>>2,(this.module._eyeGetPositions(this.eyePointer)>>2)+3*this.vertexCount),n=this.module.HEAPF32.subarray(this.module._eyeGetNormals(this.eyePointer)>>2,(this.module._eyeGetNormals(this.eyePointer)>>2)+3*this.vertexCount),o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,this.positionsBuffer),o.bufferData(o.ARRAY_BUFFER,i,o.DYNAMIC_DRAW),o.bindBuffer(o.ARRAY_BUFFER,this.normalsBuffer),o.bufferData(o.ARRAY_BUFFER,n,o.DYNAMIC_DRAW);var r=this.module._eyeGetCenterPosition(this.eyePointer);this.centerPosition[0]=this.module.HEAPF32[0+(r>>2)],this.centerPosition[1]=this.module.HEAPF32[1+(r>>2)]+.02,this.centerPosition[2]=this.module.HEAPF32[2+(r>>2)];var a=this.module._eyeGetAttachPosition(this.eyePointer);this.attachPosition[0]=this.module.HEAPF32[0+(a>>2)],this.attachPosition[1]=this.module.HEAPF32[1+(a>>2)],this.attachPosition[2]=this.module.HEAPF32[2+(a>>2)],f.a.subtract(this.localLookDirection,e,this.attachPosition),f.a.normalize(this.localLookDirection,this.localLookDirection);var s=Object(p.b)(Math.atan2(this.localLookDirection[0],this.localLookDirection[2]),-Math.PI/2,Math.PI/2*.3),l=Object(p.b)(Math.acos(this.localLookDirection[1]),t,.5*Math.PI);this.lookYaw=Object(p.q)(this.lookYaw,s,.5),this.lookPitch=Object(p.q)(this.lookPitch,l,.5),this.lookDirection[0]=Math.sin(this.lookPitch)*Math.sin(this.lookYaw),this.lookDirection[1]=Math.cos(this.lookPitch),this.lookDirection[2]=Math.sin(this.lookPitch)*Math.cos(this.lookYaw)},e}(),b=function(){function e(e,t){this.vertexCount=0,this.gl=e,this.positionsBuffer=e.createBuffer(),this.colorsBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.positionsData=new Float32Array(3*t*3),this.colorsData=new Float32Array(3*t*4),this.clear()}return e.prototype.clear=function(){this.vertexCount=0},e.prototype.drawTriangle=function(e,t,i,n,o,r,a,s,l,u,c,h,d){this.positionsData[3*this.vertexCount+0]=e,this.positionsData[3*this.vertexCount+1]=t,this.positionsData[3*this.vertexCount+2]=i,this.positionsData[3*this.vertexCount+3]=n,this.positionsData[3*this.vertexCount+4]=o,this.positionsData[3*this.vertexCount+5]=r,this.positionsData[3*this.vertexCount+6]=a,this.positionsData[3*this.vertexCount+7]=s,this.positionsData[3*this.vertexCount+8]=l;for(var f=0;f<3;++f)this.colorsData[4*this.vertexCount+4*f+0]=u,this.colorsData[4*this.vertexCount+4*f+1]=c,this.colorsData[4*this.vertexCount+4*f+2]=h,this.colorsData[4*this.vertexCount+4*f+3]=d;this.vertexCount+=3},e.prototype.commit=function(){var e=this.gl;this.vertexCount>0&&(e.bindBuffer(e.ARRAY_BUFFER,this.positionsBuffer),e.bufferData(e.ARRAY_BUFFER,this.positionsData.subarray(0,3*this.vertexCount),e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.colorsBuffer),e.bufferData(e.ARRAY_BUFFER,this.colorsData.subarray(0,4*this.vertexCount),e.DYNAMIC_DRAW))},e}(),v=function(){function e(e,t){this.gl=e,this.maxVertices=t,this.clear(),this.positionsBuffer=e.createBuffer(),this.colorsBuffer=e.createBuffer(),this.positionsData=new Float32Array(3*t),this.colorsData=new Float32Array(4*t)}return e.prototype.clear=function(){this.vertexCount=0},e.prototype.addLine=function(e,t,i,n){for(var o=0;o<3;++o)this.positionsData[3*this.vertexCount+o]=e[o];for(o=0;o<3;++o)this.positionsData[3*this.vertexCount+3+o]=t[o];for(o=0;o<4;++o)this.colorsData[4*this.vertexCount+o]=i[o];for(o=0;o<4;++o)this.colorsData[4*this.vertexCount+4+o]=n[o];this.vertexCount+=2},e.prototype.commit=function(){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,this.positionsBuffer),e.bufferData(e.ARRAY_BUFFER,this.positionsData.subarray(0,3*this.vertexCount),e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.colorsBuffer),e.bufferData(e.ARRAY_BUFFER,this.colorsData.subarray(0,4*this.vertexCount),e.DYNAMIC_DRAW)},e}(),y=function(){function e(e,t,i,n,o){this.indicatorY=new m.a(0),this.alpha=new m.a(0),this.overrideAlpha=new m.a(1),this.soundingAlphas=[],this.yOffset=new m.a(0),this.gl=e,this.scale=t,this.minY=i,this.maxY=n,this.modelMatrix=o;for(var r=0;r<t.length;++r)this.soundingAlphas.push(new m.a(0));this.lines=new v(e,2*(this.scale.length+1)),this.triangles=new b(e,2*this.scale.length+1);var a=[1,1,1,.5];for(r=0;r<=this.scale.length;++r){var s=Object(p.q)(this.minY,this.maxY,r/this.scale.length);this.lines.addLine([0,s,0],[.2,s,0],a,a)}this.lines.commit()}return e.prototype.getModelMatrix=function(){return d.premultiply(new Float32Array(16),this.modelMatrix,d.makeTranslation([],0,this.yOffset.evaluate(),0))},e.prototype.drawRect=function(e,t,i,n,o){this.triangles.drawTriangle(e,t,0,e+i,t,0,e+i,t+n,0,1,1,1,o),this.triangles.drawTriangle(e,t,0,e+i,t+n,0,e,t+n,0,1,1,1,o)},e.prototype.update=function(e,t,i){this.triangles.clear();var n=-1;if(e){this.currentDraggedValue=t;var o=this.scale.indexOf(t);n=o;var r=Object(p.q)(this.minY,this.maxY,(o+.5)/this.scale.length);this.indicatorY.change(r,.05)}this.alpha.change(e?1:0,.2);var a=this.indicatorY.evaluate();this.triangles.drawTriangle(0,a,0,-.1,a-.05,0,-.1,a+.05,0,1,1,1,1),this.currentSoundedValue=i;var s=-1;null!==i&&(s=this.scale.indexOf(i));for(var l=0;l<this.soundingAlphas.length;++l){var u=this.soundingAlphas[l];l===s?u.change(1,.1):l===n?u.change(.1,.1):u.change(0,.1);var c=u.evaluate();if(c>0){var h=(this.maxY-this.minY)/this.scale.length;this.drawRect(0,this.minY+l*h,.2,h,c)}}this.triangles.commit()},e}(),x=i(6),_=function(){function e(e,t){this.module=e,this.hatPointer=t,this.splinePointCount=this.module._hatGetPointCount(this.hatPointer)}return e.prototype.getSplinePositions=function(){return this.module.HEAPF32.subarray(this.module._hatGetPositions(this.hatPointer)>>2,(this.module._hatGetPositions(this.hatPointer)>>2)+3*this.splinePointCount)},e.prototype.getSplineTangents=function(){return this.module.HEAPF32.subarray(this.module._hatGetTangents(this.hatPointer)>>2,(this.module._hatGetTangents(this.hatPointer)>>2)+3*this.splinePointCount)},e.prototype.getSplineNormals=function(){return this.module.HEAPF32.subarray(this.module._hatGetNormals(this.hatPointer)>>2,(this.module._hatGetNormals(this.hatPointer)>>2)+3*this.splinePointCount)},e.prototype.getBrimPositions=function(){return this.module.HEAPF32.subarray(this.module._hatGetBrimPositions(this.hatPointer)>>2,48+(this.module._hatGetBrimPositions(this.hatPointer)>>2))},e}(),w=i(1);function P(e){return e===h.BlobperaHouse?"default":e===h.London?"london":e===h.NewYork?"new_york":e===h.Hackney?"hackney":e===h.Paris?"paris":e===h.CapeTown?"cape_town":e===h.MexicoCity?"mexico_city":e===h.Seoul?"seoul":"default"}!function(e){e[e.Normal=0]="Normal",e[e.Christmas=1]="Christmas",e[e.NewYears=2]="NewYears"}(c||(c={})),function(e){e[e.BlobperaHouse=0]="BlobperaHouse",e[e.London=1]="London",e[e.NewYork=2]="NewYork",e[e.Hackney=3]="Hackney",e[e.Paris=4]="Paris",e[e.CapeTown=5]="CapeTown",e[e.MexicoCity=6]="MexicoCity",e[e.Seoul=7]="Seoul"}(h||(h={}));var S=function(){return(S=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function k(e,t){for(var i=e._malloc(t.length),n=e.HEAPU8.subarray(i,i+t.length),o=0;o<t.length;++o)n[o]=t[o];return i}function A(e,t,i,n){var o=d.makeScale(new Float32Array(16),n,n,n),r=d.makeYRotation(new Float32Array(16),i),a=d.makeXRotation(new Float32Array(16),t),s=d.makeTranslation(new Float32Array(16),e[0],e[1],e[2]),l=o;return d.premultiply(l,l,a),d.premultiply(l,l,r),d.premultiply(l,l,s),l}function T(e,t,i){var n=d.makeScale(new Float32Array(16),i,i,i),o=d.fromQuaternion([],t),r=d.makeTranslation(new Float32Array(16),e[0],e[1],e[2]),a=n;return d.premultiply(a,a,o),d.premultiply(a,a,r),a}var E,M=function(){function e(){this.lastBlinkTime=0,this.lastBlinkTime=Date.now()-Object(p.q)(3e3,6e3,Math.random()),this.msToNextBlink=Object(p.q)(3e3,6e3,Math.random())}return e.prototype.evaluate=function(){var e=Date.now();e-this.lastBlinkTime>this.msToNextBlink&&(this.lastBlinkTime=e,this.msToNextBlink=Object(p.q)(3e3,6e3,Math.random()));var t=Math.max(e-this.lastBlinkTime,0);return 1-Object(p.o)(0,120,t)*Object(p.o)(300,180,t)},e}();function R(e,t){return e.midiPitch===t.midiPitch&&e.vowel===t.vowel}function B(e,t,i,n){var o=e.indexOf(i);return-1!==o&&t>(o-n)/e.length&&t<(o+1+n)/e.length?i:e[Object(p.b)(Math.floor(t*e.length),0,e.length-1)]}!function(e){e[e.Offscreen=0]="Offscreen",e[e.Falling=1]="Falling",e[e.Rising=2]="Rising",e[e.Idle=3]="Idle"}(E||(E={}));var C={scale:[1.3,.2,1],bend:0},F={scale:[1.3,.2,1],bend:0},L={};L[w.b.a]={scale:[1.8,1.8,1],bend:.4},L[w.b.e]={scale:[1.2,1,1],bend:.5},L[w.b.i]={scale:[1.5,.7,1],bend:.5},L[w.b.o]={scale:[.8,.8,2],bend:0},L[w.b.u]={scale:[.4,.4,3],bend:0};var I=[w.b.a,w.b.e,w.b.i,w.b.o,w.b.u];function D(e,t,i){if(e.state===E.Idle){var n=e.rayIntersect(t,i);if(-1!==n){e.indices[3*n+0];var o=e.getIntersectedRestPosition();return{draggingRestPosition:[o[0],o[1],o[2]]}}return null}}var j=[0,0,1],O=function(){function e(e,t){this.draggingRestPosition=[0,0,0],this.yScale=1,this.zOffset=0,this.localRayOrigin=[0,0,0],this.localRayDirection=[0,0,0],this.localZDirection=[0,0,0],this.planeIntersection=[0,0,0],this.blob=e,this.draggingRestPosition=t}return e.prototype.step=function(e,t){d.transformPosition(this.localRayOrigin,e,this.blob.inverseModelMatrix),d.transformDirection(this.localRayDirection,t,this.blob.inverseModelMatrix),f.a.normalize(this.localRayDirection,this.localRayDirection),d.transformDirection(this.localZDirection,j,this.blob.inverseModelMatrix),Object(p.k)(this.planeIntersection,this.draggingRestPosition,this.localZDirection,this.localRayOrigin,this.localRayDirection),this.localPosition=this.planeIntersection;var i=.55*this.blob.config.stretch;this.yScale=Math.max(1+(this.planeIntersection[1]-this.draggingRestPosition[1])*i,.5),this.yScale/=this.blob.config.stretch,this.zOffset=Object(p.b)(.4*(this.planeIntersection[2]-this.draggingRestPosition[2])*this.blob.config.stretch,-.15*this.blob.config.stretch,.35*this.blob.config.stretch)},e}(),z=function(){function e(e,t,i,n,o,r,a,s,l,h,f){this.MIN_Y=1.85,this.MAX_Y=6.25,this.MIN_Z=0,this.MAX_Z=1.7,this.eyes=[],this.hat=null,this.modelMatrix=new Float32Array(16),this.inverseModelMatrix=new Float32Array(16),this.offset=[0,0,0],this.blinker=new M,this.state=E.Offscreen,this.timeCurrentNoteReached=0,this.frame=0,this.fallStartFrame=0,this.fallStartY=0,this.riseStartFrame=0,this.riseStartY=0,this.exiting=!1,this.exitStartFrame=0,this.lookPosition=[0,0,0],this.localLookPosition=[0,0,0],this.yScale=1,this.zOffset=0,this.mouthScaleX=new m.a(F.scale[0]),this.mouthScaleY=new m.a(F.scale[1]),this.mouthScaleZ=new m.a(F.scale[2]),this.mouthBend=new m.a(F.bend),this.mouthRotation=new m.a(0),this.isSinging=!1,this.lastSoundedVowel=null,this.isDragging=!1,this.hatOffset=new m.a(1,(function(e){return Object(p.w)(0,1,e)})),this.eyeBottomOpenness=new m.a(0),this.eyeTopOpenness=new m.a(1),this.eyeOverrideOpenness=new m.a(.2),this.overrideHipnotized=!1,this.smoothIsSinging=new m.a(0,(function(e){return Object(p.w)(0,1,e)})),this.rimLevel=new m.a(0,(function(e){return Object(p.w)(0,1,e)})),this.topPosition=new Float32Array(3),this.tempMatrix=new Float32Array(16),this.hatModelMatrix=new Float32Array(16),this.gl=e,this.module=t,this.config=S(S({},{mouthYScale:1,partyHatHue:0,festiveHatBrimRadius:0,partyHatBrimRadius:0}),s),this.scale=r,this.mouthRotation.change(s.mouthRotation,0),this.assets=o;var b=k(this.module,o.meshBuffer),v=k(this.module,i),P=f===c.Christmas||f===c.NewYears;1!==s.stretch&&(s.parameters.baseStretch=s.stretch);var R={blobDensity:1.2,blobMu:5,eyeDensity:1.2,eyeMu:5,eyeAttachOffset:.1,baseStretch:1,brimRadius:f===c.Christmas?s.festiveHatBrimRadius:f===c.NewYears?s.partyHatBrimRadius:.01,hatFixedPointCount:f===c.NewYears?20:3,hatY:0},B=S(S({},R),s.parameters);this.config.parameters=B;var C=function(e,t){var i=e._malloc(76),n=e.HEAPF32.subarray(i>>2,19+(i>>2)),o=e.HEAP32.subarray(i>>2,19+(i>>2));return n[0]=t.leftEyeScale[0],n[1]=t.leftEyeScale[1],n[2]=t.leftEyeScale[2],n[3]=t.rightEyeScale[0],n[4]=t.rightEyeScale[1],n[5]=t.rightEyeScale[2],n[6]=t.leftEyeX,n[7]=t.leftEyeZ,n[8]=t.rightEyeX,n[9]=t.rightEyeZ,n[10]=t.blobDensity,n[11]=t.blobMu,n[12]=t.eyeDensity,n[13]=t.eyeMu,n[14]=t.eyeAttachOffset,n[15]=t.baseStretch,n[16]=t.hatY,n[17]=t.brimRadius,o[18]=t.hatFixedPointCount,i}(this.module,B),L=s.scale;this.blobPointer=this.module._createBlob(b,o.meshBuffer.length,o.isJSONMesh?1:0,v,i.length,n?1:0,C,a,L,s.inflation,P?1:0),this.module._free(b),this.module._free(v),this.module._free(C),this.topIndex=this.module._blobGetTopIndex(this.blobPointer),this.vertexCount=this.module._blobGetVertexCount(this.blobPointer),this.renderingVertexCount=this.module._blobGetRenderingVertexCount(this.blobPointer),this.renderingIndexCount=this.module._blobGetRenderingIndexCount(this.blobPointer),this.indexCount=this.module._blobGetIndexCount(this.blobPointer),this.indices=this.module.HEAPU16.subarray(this.module._blobGetIndices(this.blobPointer)>>1,(this.module._blobGetIndices(this.blobPointer)>>1)+this.indexCount).slice(0);var D=this.module.HEAPU16.subarray(this.module._blobGetRenderingIndices(this.blobPointer)>>1,(this.module._blobGetRenderingIndices(this.blobPointer)>>1)+this.renderingIndexCount).slice(0);this.indexBuffer=u(e,e.ELEMENT_ARRAY_BUFFER,D,e.STATIC_DRAW),this.positionsBuffer=e.createBuffer(),this.normalsBuffer=e.createBuffer(),this.speedsBuffer=e.createBuffer();var j=this.module.HEAPF32.subarray(this.module._blobGetRenderingUVs(this.blobPointer)>>2,(this.module._blobGetRenderingUVs(this.blobPointer)>>2)+2*this.renderingVertexCount);this.uvsBuffer=u(e,e.ARRAY_BUFFER,j,e.STATIC_DRAW),this.restPositions=this.module.HEAPF32.subarray(this.module._blobGetRestPositions(this.blobPointer)>>2,(this.module._blobGetRestPositions(this.blobPointer)>>2)+3*this.vertexCount).slice(0);for(var O=0;O<2;++O){var z=this.module._blobGetEye(this.blobPointer,O);this.eyes.push(new g(e,this.module,z))}P&&(this.hat=new _(this.module,this.module._blobGetHat(this.blobPointer)));var N=this.module._blobGetRestMouthCentroid(this.blobPointer);if(this.restMouthCentroid=this.module.HEAPF32.subarray(N>>2,3+(N>>2)).slice(0),h){var H=new Float32Array(A(s.position,0,Object(p.e)(s.rotationDegrees),1));this.baseModelMatrix=d.premultiply(new Float32Array(16),H,A(l,0,0,1))}else this.baseModelMatrix=new Float32Array(A(s.position,0,Object(p.e)(s.rotationDegrees),1));this.mouthTriangleIndexCount=this.module._blobGetMouthTriangleIndexCount(this.blobPointer);var U=this.module.HEAPU16.subarray(this.module._blobGetMouthTriangleIndices(this.blobPointer)>>1,(this.module._blobGetMouthTriangleIndices(this.blobPointer)>>1)+this.mouthTriangleIndexCount);this.mouthTriangleIndexBuffer=u(e,e.ELEMENT_ARRAY_BUFFER,U,e.STATIC_DRAW),this.mouthPositionCount=this.module._blobGetMouthPositionCount(this.blobPointer),this.mouthGeometry=function(e,t,i,n){for(var o=[],r=[],a=[],s=0;s<t;++s)for(var l=0;l<10;++l)for(var c=(s+l/10)/t,h=0;h<n;++h){var d=2*Math.PI*h/n,f=Math.cos(d),p=Math.sin(d);o.push(f),o.push(p),o.push(c),r.push(f),r.push(p),r.push(0),a.push(0),a.push(0)}var m=u(e,e.ARRAY_BUFFER,new Float32Array(o),e.STATIC_DRAW),g=u(e,e.ARRAY_BUFFER,new Float32Array(r),e.STATIC_DRAW),b=u(e,e.ARRAY_BUFFER,new Float32Array(a),e.STATIC_DRAW),v=[],y=10*t;for(s=0;s<y;++s)for(h=0;h<n;++h){var x=0+s*n+h,_=0+s*n+(h+1)%n,w=0+(s+1)%y*n+h,P=0+(s+1)%y*n+(h+1)%n;v.push(x),v.push(w),v.push(P),v.push(P),v.push(_),v.push(x)}return{vertexBuffer:m,normalsBuffer:g,uvsBuffer:b,indexBuffer:u(e,e.ELEMENT_ARRAY_BUFFER,new Uint16Array(v),e.STATIC_DRAW),indexCount:v.length}}(e,this.mouthPositionCount,0,10),this.tonguePointer=this.module._blobGetTongue(this.blobPointer),this.tonguePositionCount=this.module._tongueGetPointCount(this.tonguePointer),this.currentPitchVowel={midiPitch:0,vowel:w.b.a},this.mouthY=this.restMouthCentroid[1],this.liveMidiNote=new m.a(this.scale[0]),this.frame=Math.floor(1e4*Math.random()),this.MIN_Y=this.restMouthCentroid[1]*this.config.stretch-2.5/this.scale.length*3.9600000000000004,this.MAX_Y=this.MIN_Y+3.9600000000000004;var G=T([0,0,this.restMouthCentroid[2]+.65],x.a.fromAxisAngle([],[0,1,0],-Math.PI/2),1),W=d.premultiply(new Float32Array(16),G,this.baseModelMatrix);this.pitchUI=new y(e,this.scale,this.MIN_Y,this.MAX_Y,W);var V=x.a.multiply([],x.a.fromAxisAngle([],[0,1,0],Math.PI/2),x.a.fromAxisAngle([],[0,0,1],Math.PI/2)),Y=T([0,Math.min(1.3,this.MIN_Y),0],V,1),q=d.premultiply(new Float32Array(16),Y,this.baseModelMatrix);this.MIN_Z=this.restMouthCentroid[2]-1.5/I.length*1.7,this.MAX_Z=this.MIN_Z+1.7,this.vowelUI=new y(e,I,this.MIN_Z,this.MAX_Z,q),this.yScale=1;var K=Object(p.q)(.8,1.5,Math.random());this.tongueScale=new Float32Array([K,1/K]),this.mouthUVs=this.module.HEAPF32.subarray(this.module._blobGetMouthUVs(this.blobPointer)>>2,(this.module._blobGetMouthUVs(this.blobPointer)>>2)+2*this.mouthPositionCount).slice(0)}return e.prototype.recomputeMatrices=function(){var e=d.makeTranslation(this.tempMatrix,this.offset[0],this.offset[1],this.offset[2]);d.premultiply(this.modelMatrix,this.baseModelMatrix,e),d.invert(this.inverseModelMatrix,this.modelMatrix)},e.prototype.startFalling=function(e){this.state!==E.Falling&&(this.fallStartFrame=this.frame+(this.state===E.Rising?0:e),this.state===E.Rising?this.fallStartY=this.getRiseY():this.fallStartY=12,this.state=E.Falling,this.module._blobReset(this.blobPointer,1,0,0,0,0),this.offset[1]=this.fallStartY,this.recomputeMatrices())},e.prototype.startRising=function(e){this.state!==E.Rising&&(this.state===E.Falling?this.riseStartY=this.getFallY():this.riseStartY=0,this.riseStartFrame=this.frame+(this.state===E.Falling?0:e),this.state=E.Rising,this.offset[1]=0,this.recomputeMatrices())},e.prototype.exitStageLeft=function(){this.exiting||(this.exiting=!0,this.exitStartFrame=this.frame)},e.prototype.canDestroy=function(){return this.exiting&&this.frame-this.exitStartFrame>120},e.prototype.getFallY=function(){if(this.state===E.Falling){var t=Math.max(0,this.frame-this.fallStartFrame);return this.fallStartY+e.INITIAL_FALL_SPEED*t+.5*e.GRAVITY*t*t}return 0},e.prototype.getFallVelocity=function(){return this.state===E.Falling?Math.max(0,this.frame-this.fallStartFrame)*e.GRAVITY-.02:0},e.prototype.getRiseY=function(){var t=Math.max(0,this.frame-this.riseStartFrame);return this.riseStartY+e.INITIAL_RISE_SPEED*t+.5*e.RISE_ACCELERATION*t*t},e.prototype.step=function(t,i){var n=i?function(e){return e.getMuted()?C:e.getPhoneme()in L?e.getPhoneme()in L?L[e.getPhoneme()]:null:F}(i):C;this.mouthScaleX.change(n.scale[0],.1),this.mouthScaleY.change(n.scale[1]*this.config.mouthYScale,.1),this.mouthScaleZ.change(n.scale[2],.1),this.mouthBend.change(n.bend,.1),this.mouthRotation.change(i?1*this.config.mouthRotation:this.config.mouthRotation,.1);var o=1+.04*Math.sin(.5*this.frame);i&&!i.getMuted()||(o=1),this.module._blobSetMouthScale(this.blobPointer,this.mouthScaleX.evaluate()*o,this.mouthScaleY.evaluate()*o,this.mouthScaleZ.evaluate()*o),this.module._blobSetMouthBend(this.blobPointer,this.mouthBend.evaluate()),this.module._blobSetMouthNoiseScale(this.blobPointer,!i||i.getMuted()?0:.04*this.mouthScaleY.evaluate()),this.module._blobSetMouthNoiseFrequency(this.blobPointer,2.5),this.module._blobSetMouthNoiseOffset(this.blobPointer,.05*this.frame),this.module._blobSetMouthRotation(this.blobPointer,this.mouthRotation.evaluate()),this.isSinging=i&&!i.getMuted(),this.isSinging?Object(p.n)(i.getVowel())&&i.getVowel()!==this.lastSoundedVowel&&(this.eyeOverrideOpenness.change(Object(p.r)(Math.max(0,1*Math.random()-.4),.2),.2),this.lastSoundedVowel=i.getVowel()):(this.lastSoundedVowel=w.b.sil,this.eyeOverrideOpenness.change(0,.2)),this.overrideHipnotized&&this.eyeOverrideOpenness.change(.25,.2);var r=[0,0,0];if(this.state===E.Idle)if(t.length>0){for(var a=0,s=0,l=0,u=t;l<u.length;l++){var c=u[l];a+=c.yScale/t.length,s+=c.zOffset/t.length}this.yScale=a,this.zOffset=s,this.module._blobSetMouthDamping(this.blobPointer,.05),this.module._blobSetDamping(this.blobPointer,.995),this.module._blobSetIsDragging(this.blobPointer,!0),this.isDragging=!0}else if(this.module._blobSetIsDragging(this.blobPointer,!1),this.isDragging=!1,!i||i.getMuted())this.yScale=Object(p.q)(this.yScale,1,.07),this.zOffset=Object(p.q)(this.zOffset,0,.07),this.module._blobSetMouthDamping(this.blobPointer,.995);else{var h=i.getF0(),f=Object(p.g)(h)-je,m=function(e,t){if(e<=t[0])return 0;if(e>=t[t.length-1])return t.length-1;for(var i=0;i<t.length-1;++i)if(e>=t[i]&&e<=t[i+1])return i+Object(p.o)(t[i],t[i+1],e)}(f,this.scale),g=1+m/(this.scale.length-1)*.6,b=.1;i.getControlled()&&(g=Object(p.q)(this.MIN_Y,this.MAX_Y,m/(this.scale.length-1))/(this.restMouthCentroid[1]*this.config.stretch),b=.3),this.yScale=Object(p.q)(this.yScale,g,b),this.module._blobSetMouthDamping(this.blobPointer,0),this.module._blobSetDamping(this.blobPointer,.995);var v=0;i.getControlled()&&(v=(I.lastIndexOf(this.lastSoundedVowel)-1)/(I.length-1)*.1),this.zOffset=Object(p.q)(this.zOffset,v,.3),this.liveMidiNote.change(f,0)}else if(this.state===E.Falling){var y=this.getFallY(),x=this.getFallVelocity();this.offset[1]=y,y<=0&&(this.state=E.Idle,this.offset[1]=0,this.module._blobAddImpulse(this.blobPointer,0,60*x,0)),this.module._blobSetMouthDamping(this.blobPointer,.97),this.module._blobSetDamping(this.blobPointer,.97)}else this.state===E.Rising&&(y=this.getRiseY(),this.offset[1]=y,y>=12&&(this.state=E.Offscreen,this.offset[1]=12),this.module._blobSetMouthDamping(this.blobPointer,.97),this.module._blobSetDamping(this.blobPointer,.97));if(this.exiting){var _=Math.max(0,this.frame-this.exitStartFrame),P=0-e.INITIAL_RISE_SPEED*_-.5*e.RISE_ACCELERATION*3*_*_;this.offset[0]=P,this.module._blobAddImpulse(this.blobPointer,.5,0,0)}var S=2*this.frame,k=this.isSinging?.4:0;this.module._blobSetNoiseParameters(this.blobPointer,100,S,k);var A=1+.2*Math.sin(this.frame/60*3);this.module._blobSetBreathVolumeScale(this.blobPointer,A);var T=this.isSinging?2:0;if(this.module._tongueSetWindForce(this.tonguePointer,.006),this.module._tongueSetOscillationScale(this.tonguePointer,T),this.frame,this.exitStartFrame,this.module._blobStep(this.blobPointer,this.yScale,this.zOffset,r[0],r[1],r[2]),t.length>0){var M=this.getMouthCentroid();this.mouthY=Object(p.q)(this.mouthY,M[1],1);var D={midiPitch:B(this.scale,Object(p.o)(this.MIN_Y,this.MAX_Y,this.mouthY),this.currentPitchVowel.midiPitch,.3),vowel:B(I,Object(p.o)(this.MIN_Z,this.MAX_Z,M[2]),this.currentPitchVowel.vowel,.2)};this.liveMidiNote.change(D.midiPitch,.2),R(this.currentPitchVowel,D)||(this.timeCurrentNoteReached=Date.now(),this.currentPitchVowel=D)}else this.currentPitchVowel={midiPitch:0,vowel:w.b.a};var j=this.isSinging?i.getMidiNote()-je:null;this.pitchUI.update(!!t.find((function(e){return e.isSelf})),this.currentPitchVowel.midiPitch,j),this.vowelUI.update(!!t.find((function(e){return e.isSelf})),this.currentPitchVowel.vowel,this.isSinging?this.lastSoundedVowel:null),this.recomputeMatrices(),d.transformPosition(this.localLookPosition,this.lookPosition,this.inverseModelMatrix);for(var O=0,z=this.eyes;O<z.length;O++)z[O].step(this.localLookPosition,Math.PI/2-this.getTopEyelidAngleWithoutBlink());this.updateRenderData(),this.smoothIsSinging.change(this.isSinging?1:0,.1),this.rimLevel.change(this.isDragging?.4:0,.1),this.frame+=1},e.prototype.getTimeOnCurrentNote=function(){return(Date.now()-this.timeCurrentNoteReached)/1e3},e.prototype.updateRenderData=function(){var e=this.module.HEAPF32.subarray(this.module._blobGetRenderingPositions(this.blobPointer)>>2,(this.module._blobGetRenderingPositions(this.blobPointer)>>2)+3*this.renderingVertexCount),t=this.module.HEAPF32.subarray(this.module._blobGetRenderingNormals(this.blobPointer)>>2,(this.module._blobGetRenderingNormals(this.blobPointer)>>2)+3*this.renderingVertexCount),i=this.module.HEAPF32.subarray(this.module._blobGetRenderingSpeeds(this.blobPointer)>>2,(this.module._blobGetRenderingSpeeds(this.blobPointer)>>2)+1*this.renderingVertexCount),n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,this.positionsBuffer),n.bufferData(n.ARRAY_BUFFER,e,n.DYNAMIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,this.normalsBuffer),n.bufferData(n.ARRAY_BUFFER,t,n.DYNAMIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,this.speedsBuffer),n.bufferData(n.ARRAY_BUFFER,i,n.DYNAMIC_DRAW)},e.prototype.getMouthPositions=function(){return this.module.HEAPF32.subarray(this.module._blobGetMouthPositions(this.blobPointer)>>2,(this.module._blobGetMouthPositions(this.blobPointer)>>2)+3*this.mouthPositionCount)},e.prototype.rayIntersect=function(e,t){var i=d.transformPosition([],e,this.inverseModelMatrix),n=d.transformDirection([],t,this.inverseModelMatrix);return f.a.normalize(n,n),this.module._blobRayIntersect(this.blobPointer,i[0],i[1],i[2],n[0],n[1],n[2])},e.prototype.getVertexPosition=function(e){return this.module.HEAPF32.subarray((this.module._blobGetPositions(this.blobPointer)>>2)+3*e,(this.module._blobGetPositions(this.blobPointer)>>2)+3*e+3)},e.prototype.getRestPosition=function(e){return this.module.HEAPF32.subarray((this.module._blobGetRestPositions(this.blobPointer)>>2)+3*e,(this.module._blobGetRestPositions(this.blobPointer)>>2)+3*e+3)},e.prototype.getHatModelMatrix=function(){return d.premultiply(this.hatModelMatrix,d.makeTranslation(this.tempMatrix,0,10*this.hatOffset.evaluate(),0),this.modelMatrix),this.hatModelMatrix},e.prototype.getTonguePositions=function(){return this.module.HEAPF32.subarray(this.module._tongueGetPositions(this.tonguePointer)>>2,(this.module._tongueGetPositions(this.tonguePointer)>>2)+3*this.tonguePositionCount)},e.prototype.getTongueTangents=function(){return this.module.HEAPF32.subarray(this.module._tongueGetTangents(this.tonguePointer)>>2,(this.module._tongueGetTangents(this.tonguePointer)>>2)+3*this.tonguePositionCount)},e.prototype.getTongueNormals=function(){return this.module.HEAPF32.subarray(this.module._tongueGetNormals(this.tonguePointer)>>2,(this.module._tongueGetNormals(this.tonguePointer)>>2)+3*this.tonguePositionCount)},e.prototype.getBottomEyelidAngle=function(){return this.blinker.evaluate()*this.eyeBottomOpenness.evaluate()*Math.PI*.5},e.prototype.getTopEyelidAngleWithoutBlink=function(){return Math.max(0,Object(p.q)(0,1,this.eyeTopOpenness.evaluate()-this.eyeOverrideOpenness.evaluate()))*Math.PI*.5},e.prototype.getTopEyelidAngle=function(){return Object(p.q)(0,this.getTopEyelidAngleWithoutBlink(),this.blinker.evaluate())},e.prototype.getMouthCentroid=function(){var e=this.module._blobGetMouthCentroid(this.blobPointer);return this.module.HEAPF32.subarray(e>>2,3+(e>>2))},e.prototype.getIntersectedRestPosition=function(){var e=this.module._blobGetIntersectedRestPosition(this.blobPointer);return this.module.HEAPF32.subarray(e>>2,3+(e>>2))},e.prototype.getRestWidth=function(){for(var e=1/0,t=-1/0,i=0;i<this.vertexCount;++i){var n=this.restPositions[3*i+0];e=Math.min(e,n),t=Math.max(t,n)}return t-e},e.prototype.getTopPosition=function(){for(var e=0;e<3;++e)this.topPosition[e]=.5*(this.eyes[0].attachPosition[e]+this.eyes[1].attachPosition[e]);return this.topPosition},e.prototype.addImpulse=function(e,t,i){this.module._blobAddImpulse(this.blobPointer,e,t,i)},e.prototype.destroy=function(){this.module._deleteBlob(this.blobPointer);var e=this.gl;e.deleteBuffer(this.positionsBuffer),e.deleteBuffer(this.uvsBuffer),e.deleteBuffer(this.normalsBuffer),e.deleteBuffer(this.indexBuffer),e.deleteBuffer(this.speedsBuffer)},e.INITIAL_FALL_SPEED=-.02,e.GRAVITY=-.002,e.INITIAL_RISE_SPEED=0,e.RISE_ACCELERATION=.006,e}();function N(e,t){return e.a=-t[1]+t[3],e.b=-t[5]+t[7],e.c=-t[9]+t[11],e.d=-t[13]+t[15],e}function H(e,t){return e.a=t[1]+t[3],e.b=t[5]+t[7],e.c=t[9]+t[11],e.d=t[13]+t[15],e}function U(e,t){return e.a=-t[0]+t[3],e.b=-t[4]+t[7],e.c=-t[8]+t[11],e.d=-t[12]+t[15],e}function G(e,t){return e.a=t[0]+t[3],e.b=t[4]+t[7],e.c=t[8]+t[11],e.d=t[12]+t[15],e}function W(e,t,i){var n=Object(p.s)(-10,10),o=Object(p.s)(-10,10),r=Object(p.s)(-10,10);0===i?n=(-t.d-t.b*o-t.c*r)/t.a:1===i&&(o=(-t.d-t.a*n-t.c*r)/t.b),e[0]=n,e[1]=o,e[2]=r}var V,Y=function(){function e(e,t,i,n,o,r,a){this.time=0,this.nextSpawnIndex=0,this.spawnedParticleCount=0,this.plane={a:0,b:0,c:0,d:0},this.spawnPosition=[0,0,0],this.gl=e,this.particleCount=t,this.spawnDirections=i,this.useVelocity=n;for(var s=[],l=[],c=0;c<this.particleCount;++c){l.push(-1,-1),l.push(1,-1),l.push(1,1),l.push(-1,1);var h=4*c;s.push(h+0,h+1,h+2),s.push(h+2,h+3,h+0)}this.offsetBuffer=u(e,e.ARRAY_BUFFER,new Float32Array(l),e.STATIC_DRAW),this.spawnTimeBuffer=u(e,e.ARRAY_BUFFER,new Float32Array(4*this.particleCount),e.DYNAMIC_DRAW),this.spawnPositionBuffer=u(e,e.ARRAY_BUFFER,new Float32Array(4*this.particleCount*3),e.DYNAMIC_DRAW),this.useVelocity&&(this.spawnVelocityBuffer=u(e,e.ARRAY_BUFFER,new Float32Array(4*this.particleCount*3),e.DYNAMIC_DRAW));var d=[];for(c=0;c<this.particleCount;++c)for(var f=[Math.random(),Math.random(),Math.random(),Math.random()],p=0;p<4;++p)d.push(Math.random(),f[1],f[2],f[3]);this.randomBuffer=u(e,e.ARRAY_BUFFER,new Float32Array(d),e.STATIC_DRAW),this.indexBuffer=u(e,e.ELEMENT_ARRAY_BUFFER,new Uint16Array(s),e.STATIC_DRAW),this.spawnTimeData=new Float32Array(4*this.particleCount*1),this.spawnPositionData=new Float32Array(4*this.particleCount*3),this.useVelocity&&(this.spawnVelocityData=new Float32Array(4*this.particleCount*3)),o&&this.spawn(0,this.particleCount,0,a,1/r)}return e.prototype.spawn=function(e,t,i,n,o){if(0!==t){this.nextSpawnIndex+t>=this.particleCount&&(this.nextSpawnIndex=0);for(var r=0;r<t;++r){var a=this.spawnDirections[Math.floor(Math.random()*this.spawnDirections.length)],s=.5*Math.PI,l=Object(p.s)(-s/2,s/2),u=0;"left"===a?(U(this.plane,n),u=Math.PI+l):"right"===a?(G(this.plane,n),u=0+l):"top"===a?(N(this.plane,n),u=-Math.PI/2+l):"bottom"===a&&(H(this.plane,n),u=Math.PI/2+l),"left"===a||"right"===a?W(this.spawnPosition,this.plane,0):"bottom"!==a&&"top"!==a||W(this.spawnPosition,this.plane,1);for(var c=Object(p.s)(.01,.1),h=e-Math.random()*i-(this.particleCount-1-r)*o,d=0;d<4;++d)this.spawnTimeData[4*r+d]=h,this.spawnPositionData[4*r*3+3*d+0]=this.spawnPosition[0],this.spawnPositionData[4*r*3+3*d+1]=this.spawnPosition[1],this.spawnPositionData[4*r*3+3*d+2]=this.spawnPosition[2],this.useVelocity&&(this.spawnVelocityData[4*r*3+3*d+0]=Math.cos(u)*c,this.spawnVelocityData[4*r*3+3*d+1]=Math.sin(u)*c,this.spawnVelocityData[4*r*3+3*d+2]=0)}var f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,this.spawnTimeBuffer),f.bufferSubData(f.ARRAY_BUFFER,4*this.nextSpawnIndex*4,this.spawnTimeData.subarray(0,4*t)),f.bindBuffer(f.ARRAY_BUFFER,this.spawnPositionBuffer),f.bufferSubData(f.ARRAY_BUFFER,4*this.nextSpawnIndex*3*4,this.spawnPositionData.subarray(0,4*t*3)),this.useVelocity&&(f.bindBuffer(f.ARRAY_BUFFER,this.spawnVelocityBuffer),f.bufferSubData(f.ARRAY_BUFFER,4*this.nextSpawnIndex*3*4,this.spawnVelocityData.subarray(0,4*t*3))),this.nextSpawnIndex+=t,this.spawnedParticleCount+=t}},e.prototype.update=function(e,t,i){var n=Math.floor(e*t);this.spawn(this.time,n,e,i,0),this.time+=e},e}(),q=(V=function(e,t){return(V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}V(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),K=function(e){function t(t,i,n,o){return e.call(this,t,1e4,["top"],!1,i,n,o)||this}return q(t,e),t}(Y);function X(e,t,i){var n=[],o=0;function r(e,t,i){for(var r=9*e,a=0;a<16;++a)n.push(a),n.push(r),n.push(t),n.push(i);o+=1}for(var a=t?.2:0,s=t?10:0,l=0;l<s;++l){var c=l/(s-1);r(c*a,d=1+.2*Math.sqrt(1-Math.pow(2*c-1,2)),0)}for(l=0;l<10;++l){var h=l/9,d=Object(p.q)(1,.1,h);r(Object(p.q)(a,1,h),d,1)}for(l=0;l<10;++l){var f=l/9;r(1+f*i,d=Math.sqrt(1-Math.pow(2*f-1,2))*i*2,0)}for(var m=[],g=0;g<o-1;++g)for(l=0;l<16;++l){var b=16*g+l,v=16*g+(l+1)%16,y=b+16,x=v+16;m.push(b,v,x),m.push(x,y,b)}var _=[];for(l=0;l<16;++l){var w=2*Math.PI*l/16;_.push([-Math.cos(w),-Math.sin(w),0])}var P=[];for(l=0;l<n.length/4;++l){var S=n[4*l+0],k=n[4*l+1];d=.3*n[4*l+2],P.push(_[S][0]*d,_[S][1]*d,.8*k/9)}var A=Object(p.c)(P,m,2.1);return{dataBuffer:u(e,e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW),normalsBuffer:u(e,e.ARRAY_BUFFER,new Float32Array(A),e.STATIC_DRAW),indexBuffer:u(e,e.ELEMENT_ARRAY_BUFFER,new Uint16Array(m),e.STATIC_DRAW),indexCount:m.length}}function J(e){return X(e,!0,.2)}function Z(e){return X(e,!1,.1)}var Q=[1,.37,.3];function $(e,t){for(var i=[],n=0;n<3;++n){var o=t/(.001+Q[n]);i[n]=Math.exp(-o*o/(2*e))/(2*Math.PI*e)}return i}function ee(e,t){var i=function(e){for(var t=e>20?3:2,i=[],n=2*t/(e-1),o=0;o<e;++o){var r=o*n-t,a=r<0?-1:1;i.push(t*a*Math.abs(Math.pow(r,2))/Math.pow(t,2))}var s,l=[];for(o=0;o<e;++o){var u=((o>0?Math.abs(i[o]-i[o-1]):0)+(o<e-1?Math.abs(i[o]-i[o+1]):0))/2;(c=f.a.multiplyByScalar([],(s=i[o],f.a.addList([],[f.a.multiplyByScalar([],$(.0484,s),.1),f.a.multiplyByScalar([],$(.187,s),.118),f.a.multiplyByScalar([],$(.567,s),.113),f.a.multiplyByScalar([],$(1.99,s),.358),f.a.multiplyByScalar([],$(7.41,s),.078)])),u))[3]=i[o],l.push(c)}var c=l[Math.floor(e/2)];for(o=Math.floor(e/2);o>0;--o)l[o]=l[o-1];l[0]=c;var h=f.a.addList([],l);for(o=0;o<e;++o)l[o][0]/=h[0],l[o][1]/=h[1],l[o][2]/=h[2];return l}(e),n="vec3("+i[0][0].toFixed(10)+","+i[0][1].toFixed(10)+","+i[0][2].toFixed(10)+")",o=function(e){for(var t=1;t<e.length;++t)if(!Object(p.a)(e[0],e[t]))return!1;return!0}(t),r="precision highp float;\n\n        varying vec2 v_coordinates;\n\n        uniform sampler2D u_colorTexture;\n\n        uniform vec2 u_direction;\n        uniform vec2 u_resolution;\n\n        uniform mat4 u_projectionMatrix;\n        uniform float u_near;\n        uniform float u_far;\n\n        uniform int u_gammaCorrect;\n        uniform float u_gamma;\n\n        #define SSS_INDEX_COUNT 8\n        float getSSSAlpha(int sssIndex) {\n            return float(sssIndex + 1) / float(SSS_INDEX_COUNT);\n        }\n\n        int sssAlphaToIndex(float sssAlpha) {\n            return int(sssAlpha * float(SSS_INDEX_COUNT) - 0.9);\n        }\n\n        float linearizeDepth (float depth, float near, float far) {\n            depth = 2.0 * depth - 1.0;\n            return 2.0 * near * far / (far + near - depth * (far - near));\n        }\n\n        float rand(vec2 co){\n            return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n        }\n\n        void main () {\n            vec4 color = texture2D(u_colorTexture, v_coordinates);\n\n            if (color.a == 0.0) discard;\n\n            vec3 colorM = color.rgb;\n            float z = 20.0;\n\n            float width = 0.1; //filter width in world space\n            width *= (1.0 + rand(gl_FragCoord.xy) * 0.3);\n\n            vec4 corner = vec4(width, width, z, 1.0);\n            corner = u_projectionMatrix * corner;\n            corner.xyz /= corner.w;\n            corner.xy *= 0.5;\n            corner.xy = abs(corner.xy);\n\n            int sssIndex = sssAlphaToIndex(color.a);\n            ";if(o)r+="\n            vec3 strength = vec3("+(s=t[0])[0].toFixed(10)+", "+s[1].toFixed(10)+", "+s[2].toFixed(10)+");\n                    ";else{r+="\n            vec3 strength = vec3(0.0);\n            ";for(var a=0;a<t.length;++a){var s=t[a];r+="\n            "+(0===a?"if":"else if")+"  (sssIndex == "+a.toFixed(0)+") {\n                strength = vec3("+s[0].toFixed(10)+", "+s[1].toFixed(10)+", "+s[2].toFixed(10)+");\n            }\n                    "}}for(r+="\n            vec3 kernel0 = "+n+";\n            kernel0 = (1.0 - strength) + strength * kernel0;\n\n            vec3 colorBlurred = colorM;\n            colorBlurred *= kernel0;\n\n            vec2 delta = u_direction * corner.xy;\n    ",r+="\n",a=1;a<i.length;++a){var l=i[a],u="sample"+a.toFixed(0);r+="\n            vec4 "+u+" = texture2D(u_colorTexture, v_coordinates + delta * "+l[3].toFixed(10)+");\n            "+u+".rgb = color.a == "+u+".a ? "+u+".rgb : colorM;\n        ",o?(s=t[0],r+="\n            colorBlurred.rgb += vec3("+(l[0]*s[0]).toFixed(10)+", "+(l[1]*s[1]).toFixed(10)+", "+(l[2]*s[2]).toFixed(10)+") * "+u+".rgb;\n            "):r+="\n            colorBlurred.rgb += vec3("+l[0].toFixed(10)+", "+l[1].toFixed(10)+", "+l[2].toFixed(10)+") * "+u+".rgb * strength;\n            "}return r+"\n            if (u_gammaCorrect == 1) {\n                colorBlurred.rgb = pow(colorBlurred.rgb, 1.0 / vec3(u_gamma));\n            }\n            gl_FragColor = vec4(colorBlurred, color.a);\n        }"}var te=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ie=function(e){function t(t,i,n,o){return e.call(this,t,1e4,["left","right","bottom","top"],!0,i,n,o)||this}return te(t,e),t}(Y),ne=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),oe=function(e){function t(t,i,n,o){for(var r,a,s,l=e.call(this,t,1e4,["top"],!1,i,n,o)||this,c=[],h=[0,0,0],d=[0,0,0,0],f=0;f<l.particleCount;++f){r=h,void 0,void 0,a=Object(p.s)(0,2*Math.PI),s=Object(p.s)(-1,1),r[0]=Math.sqrt(1-s*s)*Math.cos(a),r[1]=Math.sqrt(1-s*s)*Math.sin(a),r[2]=s;for(var m=0;m<4;++m)c.push(h[0],h[1],h[2],d[3])}return l.rotationBuffer=u(t,t.ARRAY_BUFFER,new Float32Array(c),t.STATIC_DRAW),l}return ne(t,e),t}(Y),re=function(){function e(e,t,i,n){this.gl=e,this.particleCount=1e3,this.spawnPosition=t,this.spawnTime=n;for(var o=f.a.normalize([],f.a.cross([],i,[0,1,0])),r=f.a.cross([],o,i),a=[],s=0;s<this.particleCount;++s){var l=1-.1*Math.pow(Math.random(),1.5),c=2*Math.random()*Math.PI,h=Math.sqrt(1-l*l),d=h*Math.cos(c),m=h*Math.sin(c),g=10*Object(p.s)(.1,4),b=(d*o[0]+m*r[0]+l*i[0])*g,v=(d*o[1]+m*r[1]+l*i[1])*g,y=(d*o[2]+m*r[2]+l*i[2])*g;v=Math.max(v,0);for(var x=0;x<4;++x)a.push(b,v,y)}this.spawnVelocityBuffer=u(e,e.ARRAY_BUFFER,new Float32Array(a),e.STATIC_DRAW);var _=[];for(s=0;s<this.particleCount;++s){var w=[Math.random(),Math.random(),Math.random(),Math.random()];for(x=0;x<4;++x)_.push(Math.random(),w[1],w[2],w[3])}this.randomBuffer=u(e,e.ARRAY_BUFFER,new Float32Array(_),e.STATIC_DRAW);var P=[],S=[];for(s=0;s<this.particleCount;++s){S.push(-1,-1),S.push(1,-1),S.push(1,1),S.push(-1,1);var k=4*s;P.push(k+0,k+1,k+2),P.push(k+2,k+3,k+0)}this.offsetBuffer=u(e,e.ARRAY_BUFFER,new Float32Array(S),e.STATIC_DRAW),this.indexBuffer=u(e,e.ELEMENT_ARRAY_BUFFER,new Uint16Array(P),e.STATIC_DRAW);var A=[],T=[0,0,0],E=[0,0,0,0];for(s=0;s<this.particleCount;++s)for(ae(T),x=0;x<4;++x)A.push(T[0],T[1],T[2],E[3]);this.rotationBuffer=u(e,e.ARRAY_BUFFER,new Float32Array(A),e.STATIC_DRAW)}return e.prototype.destroy=function(){this.gl.deleteBuffer(this.spawnVelocityBuffer),this.gl.deleteBuffer(this.offsetBuffer),this.gl.deleteBuffer(this.randomBuffer),this.gl.deleteBuffer(this.rotationBuffer),this.gl.deleteBuffer(this.indexBuffer)},e}();function ae(e){var t=Object(p.s)(0,2*Math.PI),i=Object(p.s)(-1,1);e[0]=Math.sqrt(1-i*i)*Math.cos(t),e[1]=Math.sqrt(1-i*i)*Math.sin(t),e[2]=i}var se="\nprecision highp float;\n\nattribute vec3 a_data;\nattribute vec3 a_normal;\nattribute vec2 a_uv;\n\nuniform int u_vertexCount;\nuniform vec3 u_positions[24];\n\nuniform mat4 u_modelMatrix;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_viewMatrix;\n\nuniform float u_lipScale;\n\nvarying float v_linearPosition;\nvarying vec3 v_normal;\nvarying vec3 v_position;\nvarying vec2 v_uv;\nvarying vec3 v_localPosition;\n\n#ifdef SHADOW\nvarying vec4 v_clipSpacePosition;\n#endif\n\nvec3 sampleFilament(float filamentIndex, float vertexIndex) {\n    return u_positions[int(vertexIndex + 0.001)] + vec3(0.0, 0.0, 0.04);\n}\n\nvec3 evaluateCubicSpline(vec3 leftPosition, vec3 rightPosition, vec3 leftTangent, vec3 rightTangent, float t) {\n    float t2 = t * t;\n    float t3 = t2 * t;\n\n    return (2.0 * t3 - 3.0 * t2 + 1.0) * leftPosition + (t3 - 2.0 * t2 + t) * leftTangent + (-2.0 * t3 + 3.0 * t2) * rightPosition + (t3 - t2) * rightTangent;\n}\n\nvec3 evaluateCubicSplineTangent(vec3 leftPosition, vec3 rightPosition, vec3 leftTangent, vec3 rightTangent, float t) {\n    float t2 = t * t;\n    return (6.0 * t2 - 6.0 * t) * leftPosition + (3.0 * t2 - 4.0 * t + 1.0) * leftTangent + (-6.0 * t2 + 6.0 * t) * rightPosition + (3.0 * t2 - 2.0 * t) * rightTangent;\n}\n\nfloat posMod(float i, float n) {\n    return mod((n + mod(i, n)), n);\n}\n\nvoid main () {\n    float lipScale = u_lipScale * 0.032;\n    vec3 position = a_data.xyz * vec3(lipScale, lipScale, float(u_vertexCount - 1));\n    float filamentIndex = 0.0;\n\n    v_linearPosition = a_data.z;\n\n    float index = position.z;\n    float leftIndex = floor(position.z + 0.001);\n    float rightIndex = floor(mod(leftIndex + 1.0001, float(u_vertexCount)));\n    \n    float t = clamp(index - leftIndex, 0.0, 1.0);\n\n    vec3 leftLeftPosition = sampleFilament(filamentIndex, floor(posMod(leftIndex - 0.9999, float(u_vertexCount)))).xyz;\n    vec3 leftPosition = sampleFilament(filamentIndex, leftIndex).xyz;\n    vec3 rightPosition = sampleFilament(filamentIndex, rightIndex).xyz;\n    vec3 rightRightPosition = sampleFilament(filamentIndex, floor(posMod(rightIndex + 1.0001, float(u_vertexCount)))).xyz;\n\n    vec3 leftTangent = (rightPosition - leftLeftPosition) * 0.5;\n    vec3 rightTangent = (rightRightPosition - leftPosition) * 0.5;\n\n    //vec3 tangent = normalize(mix(leftTangent, rightTangent, t));\n    vec3 tangent = normalize(evaluateCubicSplineTangent(leftPosition, rightPosition, leftTangent, rightTangent, t));\n\n    vec3 right = normalize(cross(tangent, vec3(0.0, 0.0, 1.0)));\n    vec3 up = normalize(cross(right, tangent));\n\n    vec3 localNormal = normalize(vec3(a_data.x, a_data.y, 0.0));\n\n    localNormal = normalize(localNormal.x * right + localNormal.y * up);\n    v_normal = (u_modelMatrix * vec4(localNormal, 0.0)).xyz;\n\n    vec3 localPosition = evaluateCubicSpline(leftPosition, rightPosition, leftTangent, rightTangent, t) + position.x * right + position.y * up;\n    v_localPosition = localPosition;\n\n    vec3 worldPosition = (u_modelMatrix * vec4(localPosition, 1.0)).xyz;\n    v_position = worldPosition;\n    v_uv = a_uv;\n\n    #ifdef SHADOW\n    v_clipSpacePosition = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n    #endif\n\n    gl_Position = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n\n    //gl_Position = vec4(position.xz, 0.0, 1.0);\n}\n",le="\nprecision highp float;\n\nvarying vec4 v_clipSpacePosition;\n\nconst float PackUpscale = 256.0 / 255.0;\nconst float UnpackDownscale = 255.0 / 256.0;\n\nconst vec3 PackFactors = vec3( 256.0 * 256.0 * 256.0, 256.0 * 256.0,  256.0);\nconst vec4 UnpackFactors = UnpackDownscale / vec4(PackFactors, 1.0);\n\nconst float ShiftRight8 = 1.0 / 256.0;\n\nvec4 packDepthToRGBA(const in float v) {\n    vec4 r = vec4(fract(v * PackFactors), v);\n    r.yzw -= r.xyz * ShiftRight8;\n    return r * PackUpscale;\n}\n\nvoid main () {\n\tfloat ndcDepth = v_clipSpacePosition.z / v_clipSpacePosition.w;\n\tgl_FragColor = packDepthToRGBA(ndcDepth * 0.5 + 0.5);\n}\n",ue="\nprecision highp float;\n\nattribute vec2 a_position;\nvarying vec2 v_uv;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_viewMatrix;\n\nuniform mat4 u_referenceProjectionViewMatrix;\n\nvarying vec4 v_clipSpacePosition;\nvarying vec4 v_referenceClipSpacePosition;\n\nuniform float u_transitionT;\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\n#define PI 3.1415926535\n\nvoid main () {\n    v_uv = a_position * 0.5 + 0.5;\n\n    vec2 planarPosition = rotate(vec2(a_position.x, 0.0), 0.523599);\n\n    vec3 worldPosition = vec3(\n        planarPosition.x,\n        a_position.y,\n        planarPosition.y\n    );\n\n    worldPosition *= 1000.0;\n    worldPosition.z -= 0.0;\n\n    v_referenceClipSpacePosition = u_referenceProjectionViewMatrix * vec4(worldPosition, 1.0);\n    v_clipSpacePosition = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n\n    vec4 position = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n    position.z = position.w - 0.001;\n    gl_Position = position;\n}\n";function ce(e,t,i){for(var n=2*e+1,o="\n    vec4 "+i+"(vec2 uv, float blurWidth) {\n        blurWidth *= 1.0 + rand(uv) * 0.25;\n        vec4 accumulate = vec4(0.0);\n    ",r=-e;r<=e;++r)o+="\n        accumulate += texture2D("+t+", uv + vec2(blurWidth * "+(r/e).toFixed(8)+", 0.0));";return o+"\n        accumulate /= "+n.toFixed(8)+";\n        return accumulate;\n    }\n    "}var he="\nprecision highp float;\n\nattribute vec2 a_offset;\nattribute vec4 a_random;\nattribute vec4 a_rotation;\n\n#ifdef POP\n\nattribute vec3 a_spawnVelocity;\n\nuniform float u_spawnTime;\nuniform vec3 u_spawnPosition;\n\n#else\n\nattribute vec3 a_spawnPosition;\nattribute float a_spawnTime;\n\n#endif\n\nuniform float u_time;\nuniform vec3 u_cameraPosition;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_viewMatrix;\nuniform float u_transitionT;\n\nvarying vec2 v_offset;\nvarying vec3 v_worldPosition;\nvarying vec4 v_random;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\n#define PI 3.14159265358979323846\n\nconst float floorY = 0.0 + 0.01; // Slight offset to put above ground\nconst float GRAVITY = -0.8;\n\nvarying float v_alpha;\n\nvec3 rotateVector(vec3 axis, float angle, vec3 v) { \n    vec4 q = vec4(axis * sin(angle * 0.5), cos(angle * 0.5));\n    return v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n}\n\nvec3 hsv2rgb(vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvec3 evaluateCubicSpline(vec3 leftPosition, vec3 rightPosition, vec3 leftTangent, vec3 rightTangent, float t) {\n    float t2 = t * t;\n    float t3 = t2 * t;\n\n    return (2.0 * t3 - 3.0 * t2 + 1.0) * leftPosition + (t3 - 2.0 * t2 + t) * leftTangent + (-2.0 * t3 + 3.0 * t2) * rightPosition + (t3 - t2) * rightTangent;\n}\n\nvoid main () {\n    v_offset = a_offset;\n    v_random = a_random;\n\n    #ifdef POP\n    float spawnTime = u_spawnTime;\n    #else\n    float spawnTime = a_spawnTime;\n    #endif\n\n    float elapsedTime = u_time - spawnTime;\n\n    #ifdef POP\n    float PROJECTILE_GRAVITY = 15.5;\n    float timeToPeak = a_spawnVelocity.y / PROJECTILE_GRAVITY;\n\n    vec3 peakPosition = u_spawnPosition + a_spawnVelocity * timeToPeak + 0.5 * vec3(0.0, -PROJECTILE_GRAVITY, 0.0) * timeToPeak * timeToPeak;\n    vec3 finalVelocity = vec3(0.0, GRAVITY, 0.0);\n    vec3 particlePosition = evaluateCubicSpline(u_spawnPosition, peakPosition, a_spawnVelocity * timeToPeak, finalVelocity * timeToPeak, elapsedTime / timeToPeak);\n\n    if (elapsedTime > timeToPeak) {\n        particlePosition = peakPosition + vec3(0.0, GRAVITY, 0.0) * (elapsedTime - timeToPeak);\n    }\n\n    float timeToHit = timeToPeak + (floorY - peakPosition.y) / GRAVITY;\n    #else\n    vec3 particlePosition = a_spawnPosition + vec3(0.0, GRAVITY, 0.0) * elapsedTime;\n    float timeToHit = (floorY - a_spawnPosition.y) / GRAVITY;\n    #endif\n\n    particlePosition += vec3(sin(min(elapsedTime, timeToHit) * 0.3 + a_random.z * 2.0 * PI), 0.0, 0.0);\n    particlePosition.x += u_transitionT * 4.0;\n\n    float hitTime = spawnTime + timeToHit;\n    float timeSinceHit = u_time - hitTime;\n\n    float desiredRotationSpeed = mix(5.0, 15.0, a_random.y);\n    float quantizedRotationCount = floor((timeToHit * desiredRotationSpeed) / (2.0 * PI));\n    float rotationSpeed = 2.0 * PI * quantizedRotationCount / timeToHit;\n\n    bool hit = timeSinceHit > 0.0;\n    v_alpha = smoothstep(2.0, 1.0, timeSinceHit);\n\n    vec3 normal = vec3(0.0, 1.0, 0.0);\n    vec3 right = vec3(1.0, 0.0, 0.0);\n\n    float angle = min(elapsedTime * rotationSpeed, timeToHit * rotationSpeed);\n    normal = rotateVector(a_rotation.xyz, angle, normal);\n    right = rotateVector(a_rotation.xyz, angle, right);\n\n    vec3 up = normalize(cross(normal, right));\n\n    particlePosition.y = max(particlePosition.y, floorY);\n\n    vec2 size = vec2(mix(0.005, 0.01, a_random.x)) * 3.0 * (1.0 - abs(u_transitionT));\n    vec3 worldPosition = particlePosition + a_offset.x * right * size.x + a_offset.y * up * size.y;\n\n    float hue = floor(a_random.y * 4.0) / 4.0;\n    if (a_random.y < 0.33) {\n        v_color = vec3(1.4234, 1.2415, 0.4736);\n    } else if (a_random.y < 0.66) {\n        v_color = vec3(0.6801, 0.1871, 0.01559);\n    } else {\n        v_color = vec3(0.91809);\n    }\n    v_worldPosition = worldPosition;\n\n    if (dot(u_cameraPosition - particlePosition, normal) < 0.0) {\n        normal *= -1.0;\n    }\n\n    v_normal = normal;\n\n    gl_Position = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n}\n",de="\nvarying vec2 v_offset;\nvarying vec3 v_color;\nvarying vec4 v_random;\nvarying vec3 v_worldPosition;\nvarying vec3 v_normal;\nvarying float v_alpha;\n\nvoid main() {\n    vec3 color = shadeSurfaceWithLightsWithoutShadow(v_worldPosition, v_normal, v_color, 0.05, 0.05);\n    float alpha = 0.9;\n    alpha *= v_alpha;\n    gl_FragColor = vec4(pow(color, vec3(1.0 / 2.2)) * alpha, alpha);\n}\n",fe="\n#define PI 3.14159265358979323846\n#define SPLINE_POINT_COUNT 10\n#define PROFILE_POINT_COUNT 16\n\nprecision highp float;\n\nattribute vec4 a_parameters; //(aroundIndex, alongIndex, scale, material)\nattribute vec3 a_normal;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_color;\nvarying vec3 v_normal;\nvarying vec2 v_uv;\nvarying vec3 v_restPosition;\nvarying float v_material;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_modelMatrix;\n\nuniform vec3 u_profilePoints[PROFILE_POINT_COUNT];\nuniform float u_brimRadius;\n\nuniform vec3 u_splinePositions[SPLINE_POINT_COUNT];\nuniform vec3 u_splineTangents[SPLINE_POINT_COUNT];\nuniform vec3 u_splineNormals[SPLINE_POINT_COUNT];\n\n#ifdef SHADOW\nvarying vec4 v_clipSpacePosition;\n#endif\n\nfloat linearstep(float left, float right, float x) {\n    return clamp((x - left) / (right - left), 0.0, 1.0);\n}\n\nvoid main() {\n    float aroundIndex = a_parameters.x;\n    float alongIndex = a_parameters.y;\n    float scale = a_parameters.z;\n    float material = a_parameters.w;\n\n    float hatLength = u_brimRadius * 2.2; // TODO: Sync this with C++\n\n    float angle = 2.0 * PI * float(aroundIndex) / 16.0;\n    vec3 flatPlanarPosition = vec3(\n        -cos(angle),\n        -sin(angle),\n        0.0\n    ) * u_brimRadius;\n\n    v_restPosition = vec3(flatPlanarPosition.x, hatLength * alongIndex / float(SPLINE_POINT_COUNT), flatPlanarPosition.y);\n\n    vec3 planarPosition = u_profilePoints[int(mod(aroundIndex + 0.1, float(PROFILE_POINT_COUNT)))];\n    planarPosition = mix(planarPosition, flatPlanarPosition, linearstep(3.0, float(SPLINE_POINT_COUNT - 1), alongIndex));\n\n    vec3 planarNormal = a_normal;\n\n    vec3 framePosition = vec3(0.0);\n    vec3 frameTangent = vec3(0.0);\n    vec3 frameNormal = vec3(0.0);\n\n    float SPACING = 2.0 * hatLength / float(SPLINE_POINT_COUNT);\n\n    if (alongIndex >= float(SPLINE_POINT_COUNT - 1)) {\n        framePosition = u_splinePositions[SPLINE_POINT_COUNT - 1] + u_splineTangents[SPLINE_POINT_COUNT - 1] * SPACING * (alongIndex - float(SPLINE_POINT_COUNT - 1));\n        frameTangent = u_splineTangents[SPLINE_POINT_COUNT - 1];\n        frameNormal = u_splineNormals[SPLINE_POINT_COUNT - 1];\n    } else if (alongIndex <= 0.0) {\n        framePosition = u_splinePositions[0];\n        frameTangent = u_splineTangents[0];\n        frameNormal = u_splineNormals[0];\n    } else {\n        int leftIndex = int(alongIndex + 0.001);\n        int rightIndex = leftIndex + 1;\n\n        framePosition = mix(u_splinePositions[leftIndex], u_splinePositions[rightIndex], fract(alongIndex));\n        frameTangent = normalize(mix(u_splineTangents[leftIndex], u_splineTangents[rightIndex], fract(alongIndex)));\n        frameNormal = normalize(mix(u_splineNormals[leftIndex], u_splineNormals[rightIndex], fract(alongIndex)));\n    }\n\n    vec3 frameRight = normalize(cross(frameTangent, frameNormal));\n\n    vec3 localPosition = framePosition + planarPosition.x * frameRight * scale + planarPosition.y * frameNormal * scale + planarPosition.z * frameTangent;\n    vec3 localNormal = normalize(planarNormal.x * frameRight + planarNormal.y * frameNormal + planarNormal.z * frameTangent);\n\n    v_normal = (u_modelMatrix * vec4(localNormal, 0.0)).xyz;\n    v_color = material < 0.5 ? vec3(1.0, 1.0, 1.0) : vec3(1.0, vec2(0.03));\n    v_material = material;\n\n    vec3 worldPosition = (u_modelMatrix * vec4(localPosition, 1.0)).xyz;\n    v_worldPosition = worldPosition;\n\n    #ifdef SHADOW\n    v_clipSpacePosition = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n    #endif\n\n    // The net of the hat is a segment of a circle\n    // We compute a UV space with the center of this circle at the origin and using a segment at the bottom\n    // The angle of the segment is given by brim circumference / hat length\n\n    float segmentAngle = u_brimRadius * 2.0 * PI / hatLength;\n    float uvAngle = PI * 1.5 - segmentAngle * 0.5 + (aroundIndex / float(PROFILE_POINT_COUNT)) * segmentAngle;\n    float uvLength = hatLength * (1.0 - alongIndex / float(SPLINE_POINT_COUNT));\n    v_uv = vec2(cos(uvAngle), sin(uvAngle)) * uvLength;\n\n    gl_Position = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n}\n",pe="\nprecision highp float;\n\nattribute vec2 a_position;\n\nvarying vec2 v_coordinates;\n\nvoid main () {\n    v_coordinates = a_position * 0.5 + 0.5;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n}\n",me=function(e,t,i,n,o,a){this.color=new Float32Array([o,o,o]),this.shadowsEnabled=a;var s=[0,4.25,2];this.position=new Float32Array([s[0]+n*Math.sin(Math.PI/2-i)*Math.sin(-t),s[1]+n*Math.cos(Math.PI/2-i),s[2]+n*Math.sin(Math.PI/2-i)*Math.cos(-t)]),this.shadowsEnabled&&(this.viewMatrix=d.makeLookAt(new Float32Array(16),this.position,[0,.5,0],[0,1,0]),d.invert(this.viewMatrix,this.viewMatrix),this.projectionMatrix=d.makePerspective(new Float32Array(16),Math.PI/8,1,.5,100),this.projectionViewMatrix=d.premultiply(new Float32Array(16),this.viewMatrix,this.projectionMatrix),this.shadowMapWidth=512,this.depthColorTexture=r(e,0,e.RGBA,e.UNSIGNED_BYTE,this.shadowMapWidth,this.shadowMapWidth,null,e.CLAMP_TO_EDGE,e.CLAMP_TO_EDGE,e.LINEAR,e.LINEAR),this.depthRenderbuffer=l(e,e.DEPTH_COMPONENT16,this.shadowMapWidth,this.shadowMapWidth))},ge=function(){function e(e,t,i,o,a,s,h,f,g){this.projectionMatrix=new Float32Array(16),this.infiniteProjectionMatrix=new Float32Array(16),this.referenceProjectionMatrix=new Float32Array(16),this.inverseProjectionMatrix=new Float32Array(16),this.viewMatrix=new Float32Array(16),this.inverseViewMatrix=new Float32Array(16),this.cameraPosition=new Float32Array(3),this.projectionViewMatrix=new Float32Array(16),this.lights=[],this.dustScale=new m.a(0),this.paddingHeight=0,this.festiveParticleSpawnRate=0,this.festiveParticleTransitionT=1,this.festiveParticleOffset=0,this.balloonsYOffset=0,this.backgroundIntensity=new m.a(0),this.backgroundTransitionT=new m.a(1,(function(e){return Object(p.w)(0,1,e)})),this.canvas=e,this.gl=t;var b=t.getExtension("OES_standard_derivatives");this.fov=Object(p.e)(h);var v=function(e){var t="\nprecision highp float;\n\n#define PI 3.14159265358979323846\n\nuniform vec3 u_cameraPosition;\n\nuniform float u_gamma;\n\nuniform vec3 u_lightPosition0;\nuniform vec3 u_lightColor0;\nuniform mat4 u_lightProjectionViewMatrix0;\nuniform sampler2D u_shadowDepthTexture0;\nuniform vec2 u_shadowResolution0;\n\nuniform vec3 u_lightPosition1;\nuniform vec3 u_lightColor1;\nuniform mat4 u_lightProjectionViewMatrix1;\nuniform sampler2D u_shadowDepthTexture1;\nuniform vec2 u_shadowResolution1;\n\nuniform vec3 u_lightPosition2;\nuniform vec3 u_lightColor2;\n\nfloat square (float x) {\n    return x * x;\n}\n\nfloat fresnel (float F0, float lDotH) {\n    float f = pow(1.0 - lDotH, 5.0);\n\n    return (1.0 - F0) * f + F0;\n}\n\nfloat GGX (float alpha, float nDotH) {\n    float a2 = square(alpha);\n\n    return a2 / (PI * square(square(nDotH) * (a2 - 1.0) + 1.0));\n}\n\nfloat GGGX (float alpha, float nDotL, float nDotV) {\n    float a2 = square(alpha);\n\n    float gl = nDotL + sqrt(a2 + (1.0 - a2) * square(nDotL));\n    float gv = nDotV + sqrt(a2 + (1.0 - a2) * square(nDotV));\n\n    return 1.0 / (gl * gv);\n}\n\nfloat saturate (float x) {\n    return clamp(x, 0.0, 1.0);\n}\n\nfloat specularBRDF (vec3 lightDirection, vec3 eyeDirection, vec3 normal, float roughness, float F0) {\n    vec3 halfVector = normalize(lightDirection + eyeDirection);\n\n    float nDotH = saturate(dot(normal, halfVector));\n    float nDotL = saturate(dot(normal, lightDirection));\n    float nDotV = saturate(dot(normal, eyeDirection));\n    float lDotH = saturate(dot(lightDirection, halfVector));\n\n    float D = GGX(roughness, nDotH);\n    float G = GGGX(roughness, nDotL, nDotV);\n    float F = fresnel(F0, lDotH);\n\n    return smoothstep(-0.2, 0.0, dot(lightDirection, normal)) * D * G * F;\n}\n\n\nconst float PackUpscale = 256.0 / 255.0;\nconst float UnpackDownscale = 255.0 / 256.0;\n\nconst vec3 PackFactors = vec3( 256.0 * 256.0 * 256.0, 256.0 * 256.0,  256.0);\nconst vec4 UnpackFactors = UnpackDownscale / vec4(PackFactors, 1.0);\n\nconst float ShiftRight8 = 1.0 / 256.0;\n\nfloat unpackRGBAToDepth(const in vec4 v) {\n    return dot(v, UnpackFactors);\n}\n\nfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n    return step(compare, unpackRGBAToDepth(texture2D( depths, uv)));\n}\n\nfloat texture2DShadow(sampler2D depths, vec2 size, vec2 uv, float compare) {\n    return texture2DCompare(depths, uv, compare);\n}\n\nfloat getShadow (vec3 worldPosition, vec3 worldNormal, mat4 projectionViewMatrix, sampler2D depthTexture, vec2 resolution) {\n    vec4 lightSpacePosition = projectionViewMatrix * vec4(worldPosition + worldNormal * 0.00001, 1.0);\n    lightSpacePosition /= lightSpacePosition.w;\n    lightSpacePosition = lightSpacePosition * 0.5 + 0.5;\n    vec2 lightSpaceCoordinates = lightSpacePosition.xy;\n\n    <shadow>\n}\n\nvec3 shadeSurfaceWithLightWithoutShadow(vec3 worldPosition, vec3 worldNormal, vec3 albedo, float roughness, float F0, vec3 lightPosition, vec3 lightColor) {\n    vec3 lightDirection = normalize(lightPosition - worldPosition);\n    vec3 eyeDirection = normalize(u_cameraPosition - worldPosition);\n\n    float diffuse = saturate(dot(lightDirection, worldNormal));\n    float specular = specularBRDF(lightDirection, eyeDirection, worldNormal, roughness, F0);\n\n    vec3 color = (diffuse * albedo + vec3(specular)) * lightColor;\n\n    return color;\n}\n\nvec3 shadeSurfaceWithLight (vec3 worldPosition, vec3 normal, vec3 albedo, float roughness, float F0, vec3 lightPosition, vec3 lightColor, mat4 projectionViewMatrix, sampler2D depthTexture, vec2 depthResolution) {\n    float shadow = getShadow(worldPosition, normal, projectionViewMatrix, depthTexture, depthResolution);\n    vec3 color = shadeSurfaceWithLightWithoutShadow(worldPosition, normal, albedo, roughness, F0, lightPosition, lightColor) * shadow;\n    return color;\n}\n\n#define AMBIENT 0.05\n\nvec3 shadeSurfaceWithLights(vec3 worldPosition, vec3 worldNormal, vec3 albedo, float roughness, float F0) {\n    vec3 total = vec3(0.0);\n    total += shadeSurfaceWithLight(worldPosition, worldNormal, albedo, roughness, F0, u_lightPosition0, u_lightColor0, u_lightProjectionViewMatrix0, u_shadowDepthTexture0, u_shadowResolution0);\n    total += shadeSurfaceWithLight(worldPosition, worldNormal, albedo, roughness, F0, u_lightPosition1, u_lightColor1, u_lightProjectionViewMatrix1, u_shadowDepthTexture1, u_shadowResolution1);\n    total += shadeSurfaceWithLightWithoutShadow(worldPosition, worldNormal, albedo, roughness, F0, u_lightPosition2, u_lightColor2);\n    total += AMBIENT * albedo;\n    return total;\n}\n\nvec3 shadeSurfaceWithLightsWithoutShadow(vec3 worldPosition, vec3 worldNormal, vec3 albedo, float roughness, float F0) {\n    vec3 total = vec3(0.0);\n    total += shadeSurfaceWithLightWithoutShadow(worldPosition, worldNormal, albedo, roughness, F0, u_lightPosition0, u_lightColor0);\n    total += shadeSurfaceWithLightWithoutShadow(worldPosition, worldNormal, albedo, roughness, F0, u_lightPosition1, u_lightColor1);\n    total += shadeSurfaceWithLightWithoutShadow(worldPosition, worldNormal, albedo, roughness, F0, u_lightPosition2, u_lightColor2);\n    total += AMBIENT * albedo;\n    return total;\n}\n\nfloat getShadowFromLights(vec3 worldPosition) {\n    float total = 1.0;\n    total *= getShadow(worldPosition, vec3(0.0, 1.0, 0.0), u_lightProjectionViewMatrix0, u_shadowDepthTexture0, u_shadowResolution0);\n    total *= getShadow(worldPosition, vec3(0.0, 1.0, 0.0), u_lightProjectionViewMatrix1, u_shadowDepthTexture1, u_shadowResolution1);\n    return total;\n}\n\n#define SSS_INDEX_COUNT 32\nfloat getSSSAlpha(int sssIndex) {\n    return float(sssIndex + 1) / float(SSS_INDEX_COUNT);\n}\n\nint sssAlphaToIndex(float sssAlpha) {\n    return int(sssAlpha * float(SSS_INDEX_COUNT) - 0.99);\n}\n\n#ifdef HAS_STANDARD_DERIVATIVES\nmat3 cotangentFrame(vec3 N, vec3 p, vec2 uv) {\n    // get edge vectors of the pixel triangle\n    vec3 dp1 = dFdx(p);\n    vec3 dp2 = dFdy(p);\n    vec2 duv1 = dFdx(uv);\n    vec2 duv2 = dFdy(uv);   \n    // solve the linear system \n    vec3 dp2perp = cross(dp2, N);\n    vec3 dp1perp = cross(N, dp1);\n    vec3 T = dp2perp * duv1.x + dp1perp * duv2.x;\n    vec3 B = dp2perp * duv1.y + dp1perp * duv2.y;\n    // construct a scale-invariant frame\n    float invmax = inversesqrt(max(dot(T, T), dot(B, B)));\n    return mat3(T * invmax, B * invmax, N);\n}\n#endif\n\n".replace("<shadow>",function(e,t){for(var i=function(e,t){var i=[],n=.5/1.5-1,o=1/1.5;n*=t,o*=t;for(var r=0;r<3;++r)for(var a=0;a<3;++a)i.push([n+a*o,n+r*o]);return i}(0,10/1024),n=["float shadow = 0.0;"],o=1/i.length,r=0;r<i.length;++r){var a=i[r],s="vec2("+a[0].toFixed(8)+","+a[1].toFixed(8)+")";n.push("shadow += "+o.toFixed(8)+" * texture2DShadow(depthTexture, resolution, lightSpaceCoordinates + "+s+", lightSpacePosition.z);")}return n.push("float ambient = 0.0;"),n.push("return ambient + shadow * (1.0 - ambient);"),n.join("\n")}());return e&&(t="#extension GL_OES_standard_derivatives : enable \n"+(t="#define HAS_STANDARD_DERIVATIVES 1 \n"+t)),t}(null!==b);this.backgroundOriginalViewMatrix=s,this.blobProgram=n(t,"\nprecision highp float;\n\nattribute vec3 a_position;\nattribute vec3 a_normal;\nattribute vec2 a_uv;\nattribute float a_speed;\n\nvarying vec3 v_normal;\nvarying vec3 v_position;\nvarying vec2 v_uv;\nvarying float v_speed;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_modelMatrix;\nuniform mat4 u_viewMatrix;\n\nfloat smin( float a, float b, float k ) {\n    float h = max( k-abs(a-b), 0.0 )/k;\n    return min( a, b ) - h*h*k*(1.0/4.0);\n}\n\nfloat smax(float a, float b, float k) {\n    return -smin(-a, -b, k);\n}\n\nvoid main () {\n    v_uv = a_uv;\n    vec3 worldPosition = (u_modelMatrix * vec4(a_position, 1.0)).xyz;\n    worldPosition.y = smax(worldPosition.y, 0.01, 0.1);\n    v_normal = (u_modelMatrix * vec4(-a_normal, 0.0)).xyz;\n    v_speed = a_speed;\n\n    v_position = worldPosition;\n    gl_Position = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n}\n",v+"\nvarying vec3 v_position;\nvarying vec3 v_normal;\nvarying vec2 v_uv;\nvarying float v_speed;\n\nuniform vec3 u_rimColor;\nuniform int u_blobIndex;\nuniform float u_normalScale;\nuniform float u_isSinging;\nuniform vec3 u_hsvShift;\nuniform float u_f0;\nuniform float u_roughnessScale;\n\nuniform sampler2D u_albedoTexture;\nuniform sampler2D u_materialMap;\n\nvec3 hsv2rgb(vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvec3 rgb2hsv(vec3 c) {\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvoid main () {\n    vec3 diffuseColor = texture2D(u_albedoTexture, v_uv).rgb;\n\n    vec3 diffuseHsv = rgb2hsv(diffuseColor);\n    diffuseHsv = diffuseHsv + u_hsvShift;\n    diffuseHsv.g = min(diffuseHsv.g, 1.1);\n    diffuseColor = hsv2rgb(diffuseHsv);\n\n    vec3 normal = normalize(v_normal);\n    float rim = abs(dot(normalize(u_cameraPosition - v_position), normal));\n\n    vec4 materialParameters = texture2D(u_materialMap, v_uv);\n    float roughness = max(materialParameters.b, 0.001) * u_roughnessScale;\n    float f0 = u_f0;\n\n    #ifdef HAS_STANDARD_DERIVATIVES\n    vec3 localNormal = vec3(materialParameters.r * 2.0 - 1.0, materialParameters.g * 2.0 - 1.0, 0.0);\n    localNormal.z = sqrt(1.0 - localNormal.x * localNormal.x - localNormal.y * localNormal.y);\n    mat3 frame = cotangentFrame(normal, v_position, v_uv);\n    normal = frame * localNormal;\n    #endif\n\n    vec3 color = shadeSurfaceWithLights(v_position, normal, diffuseColor, roughness, f0);\n\n    float shiftStrength = pow(rim, 5.0);\n    float shift = min(abs(v_speed) * 0.04, 0.2) * shiftStrength;\n    diffuseHsv.r += shift;\n\n    color += hsv2rgb(diffuseHsv) * abs(shift) * 3.0 * u_isSinging;\n\n    color.rgb += pow(1.0 - rim, 4.0) * u_rimColor;\n\n    gl_FragColor = vec4(color, getSSSAlpha(u_blobIndex));\n}\n",{a_position:0,a_normal:1,a_uv:2,a_speed:3}),this.eyeProgram=n(t,"\nprecision highp float;\n\nattribute vec3 a_position;\nattribute vec3 a_normal;\nattribute vec3 a_restPosition;\nattribute vec2 a_uv;\n\nvarying vec3 v_normal;\nvarying vec3 v_localPosition;\nvarying vec3 v_restPosition;\nvarying vec3 v_position;\nvarying vec2 v_uv;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_modelMatrix;\nuniform mat4 u_viewMatrix;\n\nvoid main () {\n    vec3 worldPosition = (u_modelMatrix * vec4(a_position + vec3(0.0, 0.02, 0.0), 1.0)).xyz;\n    v_normal = (u_modelMatrix * vec4(-a_normal, 0.0)).xyz;\n    v_restPosition = a_restPosition;\n\n    v_localPosition = a_position;\n    v_position = worldPosition;\n    v_uv = a_uv;\n    gl_Position = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n}\n",v+"\nvarying vec3 v_normal;\nvarying vec3 v_position;\nvarying vec3 v_localPosition;\nvarying vec3 v_restPosition;\nvarying vec2 v_uv;\n\nuniform int u_blobIndex;\nuniform float u_time;\nuniform vec3 u_lookDirection;\nuniform vec3 u_eyePosition;\nuniform float u_pupilNoiseOffset;\nuniform bool u_hipnotized;\nuniform float u_bottomEyelidAngle;\nuniform float u_topEyelidAngle;\nuniform float u_pupilSize;\n\nuniform float u_f0;\nuniform float u_roughnessScale;\nuniform vec3 u_hsvShift;\n\nuniform sampler2D u_albedoTexture;\nuniform sampler2D u_materialMap;\n\nvec3 hsv2rgb(vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvec3 rgb2hsv(vec3 c) {\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\n\n//\n// Description : Array and textureless GLSL 2D simplex noise function.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : stegu\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//               https://github.com/stegu/webgl-noise\n// \n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n\t\t+ i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n\nvec3 closestPointOnAxis (vec3 base, vec3 direction, vec3 point) {\n    return base + dot(point - base, direction) * direction;\n}\n\nfloat distanceFromAxis (vec3 base, vec3 direction, vec3 point) {\n    return distance(point, closestPointOnAxis(base, direction, point));\n}\n\nfloat spiral(float theta, float r) {\n  float alpha = step(0.1 * (u_pupilSize / 0.045), r);\n  return mix(step(0.5, mod(r * 25.0 / (u_pupilSize / 0.045) + theta / (2.0 * PI) - u_time * 1.1, 1.0)), 1.0, alpha);\n}\n\nvec3 eyeColor (vec3 point) {\n    //closest point on cylinder axis\n    vec3 closestPoint = closestPointOnAxis(u_eyePosition, u_lookDirection, point);\n\n    if (dot(u_lookDirection, v_localPosition - u_eyePosition) < 0.0) return vec3(1.0);\n\n    vec3 offset = point - closestPoint;\n\n    //find plane of cylinder\n    vec3 right = normalize(cross(vec3(0.0, 1.0, 0.0), u_lookDirection));\n    vec3 up = cross(u_lookDirection, right);\n\n    //project onto cylinder plane\n    float x = dot(offset, right);\n    float y = dot(offset, up);\n\n    float theta = mod(atan(y, x) + PI + u_pupilNoiseOffset, 2.0 * PI);\n\n    if (u_hipnotized) {\n      return vec3(spiral(theta, length(vec2(x, y)))) * 2.0 - 1.0;\n    } else {\n      float PUPIL_FREQUENCY = 8.0;\n\n      float r = u_pupilSize;// + snoise(vec2(PUPIL_FREQUENCY * theta / (2.0 * PI), 0.0)) * 0.003;\n\n      vec3 color = length(vec2(x, y)) < r ? vec3(-1.0) : vec3(1.0);\n      color += smoothstep(r * 0.3, r * 0.2, distance(vec2(x, y), vec2(r) * 0.3)) * 10.0;\n      return color;\n    }\n}\n\nfloat linearstep(float left, float right, float x) {\n    return clamp((x - left) / (right - left), 0.0, 1.0);\n}\n\nvoid main () {\n    vec3 normal = normalize(v_normal);\n\n    vec3 albedo = eyeColor(v_localPosition);\n\n    float roughness = 0.1;\n    float F0 = 0.5;\n\n    vec3 restOffset = vec3(0.0, -0.03, 0.05);\n\n    float angle = atan(v_restPosition.y - restOffset.y, -v_restPosition.z - restOffset.z);\n    \n    bool isEyelid = angle > -PI + u_bottomEyelidAngle && angle < PI - u_topEyelidAngle;\n\n    float angleRange = 0.2;\n    float bottomEyelidness = linearstep(-PI + u_bottomEyelidAngle, -PI + u_bottomEyelidAngle + angleRange, angle);\n    float topEyelidness = linearstep(PI - u_topEyelidAngle, PI - u_topEyelidAngle - angleRange, angle);\n\n    if (v_restPosition.y > restOffset.y && isEyelid) {\n        normal.y -= (1.0 - topEyelidness) * 1.0;\n    } else if (isEyelid) {\n        normal.y += (1.0 - bottomEyelidness) * 0.4;\n    }\n    normal = normalize(normal);\n\n    if (isEyelid) {\n        albedo = texture2D(u_albedoTexture, v_uv).rgb;\n\n        vec3 diffuseHsv = rgb2hsv(albedo);\n        diffuseHsv = diffuseHsv + u_hsvShift;\n        diffuseHsv.g = min(diffuseHsv.g, 1.1);\n        albedo = hsv2rgb(diffuseHsv);\n\n        vec4 materialParameters = texture2D(u_materialMap, v_uv);\n        roughness = max(materialParameters.b, 0.001) * u_roughnessScale;\n\n        F0 = u_f0;\n    }\n\n    vec3 color = shadeSurfaceWithLights(v_position, normal, albedo, roughness, F0);\n\n    float alpha = 0.0;\n\n    if (!isEyelid) {\n        color += step(0.1, albedo.r) * 0.2;\n        color *= 1.5;\n        /*\n        alpha = getSSSAlpha(u_blobIndex) * step(0.1, albedo.r);\n        */\n        alpha = getSSSAlpha(5) * step(0.1, albedo.r);\n    } else {\n        alpha = getSSSAlpha(u_blobIndex);\n        //color += albedo * 0.3;\n    }\n\n    gl_FragColor = vec4(color, alpha);\n}\n",{a_position:0,a_normal:1,a_restPosition:2,a_uv:3}),this.mouthInsideProgram=n(t,"\nprecision highp float;\n\nattribute vec3 a_position;\n\nvarying vec3 v_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_modelMatrix;\nuniform mat4 u_viewMatrix;\n\nvoid main () {\n    vec3 worldPosition = (u_modelMatrix * vec4(a_position, 1.0)).xyz;\n    v_position = worldPosition;\n    gl_Position = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n}\n","\nprecision highp float;\n\nvarying vec3 v_position;\n\nvoid main () {\n    gl_FragColor = vec4(vec3(0.0), 0.0);\n}\n",{a_position:0}),this.mouthProgram=n(t,se,v+"\nvarying vec3 v_position;\nvarying vec3 v_normal;\nvarying vec2 v_uv;\nvarying float v_linearPosition;\nvarying vec3 v_localPosition;\n\nuniform float u_normalScale;\nuniform vec3 u_restMouthCentroid;\n\nuniform vec3 u_color;\nuniform int u_blobIndex;\n\nuniform int u_blendSubsurface;\n\nvec3 rgb2hsv(vec3 c) {\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid main () {\n    vec3 diffuseColor = u_color;\n\n    vec3 hsv = rgb2hsv(diffuseColor);\n    //hsv.r += pow(1.0 - rim, 1.0);\n    //float shift = v_linearPosition < 0.5 ? v_linearPosition : 1.0 - v_linearPosition;\n    float shift = v_localPosition.y - u_restMouthCentroid.y;\n    hsv.r += shift * 0.2;\n    diffuseColor = hsv2rgb(hsv);\n\n    diffuseColor *= 1.5;\n\n    vec3 normal = normalize(v_normal);\n\n    float roughness = 0.1;\n    float f0 = 0.5;\n\n    vec3 color = shadeSurfaceWithLights(v_position, normal, diffuseColor, roughness, f0);\n\n    float rim = abs(dot(normalize(u_cameraPosition - v_position), normalize(normal)));\n\n    gl_FragColor = vec4(color, getSSSAlpha(u_blobIndex) + 0.05);\n}\n",{a_data:0}),this.tongueProgram=n(t,"\nprecision highp float;\n\nattribute vec3 a_position;\nattribute vec3 a_normal;\n\nvarying float v_z;\nvarying vec3 v_worldPosition;\nvarying vec3 v_normal;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_modelMatrix;\nuniform vec2 u_scale;\n\n#define SPLINE_POINT_COUNT 20\n\nuniform vec3 u_splinePositions[SPLINE_POINT_COUNT];\nuniform vec3 u_splineTangents[SPLINE_POINT_COUNT];\nuniform vec3 u_splineNormals[SPLINE_POINT_COUNT];\n\nfloat linearstep(float left, float right, float x) {\n    return clamp((x - left) / (right - left), 0.0, 1.0);\n}\n\nvoid main() {\n    v_z = a_position.z;\n    float alongIndex = a_position.z * float(SPLINE_POINT_COUNT - 1);\n\n    vec3 framePosition = vec3(0.0);\n    vec3 frameTangent = vec3(0.0);\n    vec3 frameNormal = vec3(0.0);\n\n    float SPACING = 0.13;\n\n    if (alongIndex >= float(SPLINE_POINT_COUNT - 1)) {\n        framePosition = u_splinePositions[SPLINE_POINT_COUNT - 1] + u_splineTangents[SPLINE_POINT_COUNT - 1] * SPACING * (alongIndex - float(SPLINE_POINT_COUNT - 1));\n        frameTangent = u_splineTangents[SPLINE_POINT_COUNT - 1];\n        frameNormal = u_splineNormals[SPLINE_POINT_COUNT - 1];\n    } else if (alongIndex <= 0.0) {\n        framePosition = u_splinePositions[0];\n        frameTangent = u_splineTangents[0];\n        frameNormal = u_splineNormals[0];\n    } else {\n        int leftIndex = int(alongIndex + 0.001);\n        int rightIndex = leftIndex + 1;\n\n        framePosition = mix(u_splinePositions[leftIndex], u_splinePositions[rightIndex], fract(alongIndex));\n        frameTangent = normalize(mix(u_splineTangents[leftIndex], u_splineTangents[rightIndex], fract(alongIndex)));\n        frameNormal = normalize(mix(u_splineNormals[leftIndex], u_splineNormals[rightIndex], fract(alongIndex)));\n    }\n\n    vec3 frameRight = normalize(cross(frameTangent, frameNormal));\n\n    vec3 position = a_position;\n    position.xy *= u_scale;\n\n    vec3 normal = a_normal;\n    normal.xy /= u_scale;\n    normal = normalize(normal);\n\n    vec3 localPosition = framePosition + position.x * frameRight + position.y * frameNormal;\n    vec3 localNormal = normalize(normal.x * frameRight + normal.y * frameNormal + normal.z * frameTangent);\n\n    v_normal = (u_modelMatrix * vec4(localNormal, 0.0)).xyz;\n\n    vec3 worldPosition = (u_modelMatrix * vec4(localPosition, 1.0)).xyz;\n    v_worldPosition = worldPosition;\n\n    gl_Position = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n}\n",v+"\nvarying float v_z;\nvarying vec3 v_worldPosition;\nvarying vec3 v_normal;\n\nvoid main () {\n    vec3 diffuseColor = vec3(1.0, 0.1, 0.1);\n\n    float roughness = 0.1;\n    float f0 = 0.05;\n\n    vec3 color = shadeSurfaceWithLights(v_worldPosition, normalize(v_normal), diffuseColor, roughness, f0);\n\n    color += diffuseColor * 0.1;\n\n    color = mix(vec3(0.0, 0.0, 0.0), color, smoothstep(0.0, 0.2, v_z));\n\n    gl_FragColor = vec4(color, 1.0);\n}\n",{a_position:0,a_normal:1}),this.floorProgram=n(t,"\nprecision highp float;\n\nattribute vec2 a_position;\n\nvarying vec3 v_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_viewMatrix;\nuniform float u_yOffset;\n\nvoid main () {\n    float scale = 10.0;\n    vec3 worldPosition = vec3(a_position.x * scale, u_yOffset, a_position.y * scale);\n    v_position = worldPosition;\n    gl_Position = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n}\n",v+"\nvarying vec3 v_position;\n\nuniform sampler2D u_texture;\n\nvoid main () {\n    float shadow = getShadowFromLights(v_position);\n    float alpha = smoothstep(10.0, 4.0, distance(v_position.xz, vec2(0.0, 0.0)));\n    alpha *= mix(0.8, 0.0, shadow);\n    gl_FragColor = vec4(vec3(0.1) * alpha, alpha);\n}\n",{a_position:0}),this.throatProgram=n(t,"\nprecision highp float;\n\nattribute vec2 a_data;\n\nuniform int u_vertexCount;\nuniform vec3 u_positions[24];\nuniform vec2 u_uvs[24];\n\nuniform mat4 u_modelMatrix;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_viewMatrix;\n\nvarying vec2 v_uv;\nvarying float v_z;\n\nvec3 sampleFilament(float filamentIndex, float vertexIndex) {\n    return u_positions[int(vertexIndex + 0.001)];\n}\n\nvec3 evaluateCubicSpline(vec3 leftPosition, vec3 rightPosition, vec3 leftTangent, vec3 rightTangent, float t) {\n    float t2 = t * t;\n    float t3 = t2 * t;\n\n    return (2.0 * t3 - 3.0 * t2 + 1.0) * leftPosition + (t3 - 2.0 * t2 + t) * leftTangent + (-2.0 * t3 + 3.0 * t2) * rightPosition + (t3 - t2) * rightTangent;\n}\n\nvec3 evaluateCubicSplineTangent(vec3 leftPosition, vec3 rightPosition, vec3 leftTangent, vec3 rightTangent, float t) {\n    float t2 = t * t;\n    return (6.0 * t2 - 6.0 * t) * leftPosition + (3.0 * t2 - 4.0 * t + 1.0) * leftTangent + (-6.0 * t2 + 6.0 * t) * rightPosition + (3.0 * t2 - 2.0 * t) * rightTangent;\n}\n\nfloat posMod(float i, float n) {\n    return mod((n + mod(i, n)), n);\n}\n\nvoid main () {\n    float filamentIndex = 0.0;\n\n    float index = a_data.x * float(u_vertexCount);\n    float leftIndex = floor(index + 0.001);\n    float rightIndex = floor(mod(leftIndex + 1.0001, float(u_vertexCount)));\n    \n    float t = clamp(index - leftIndex, 0.0, 1.0);\n\n    vec3 leftLeftPosition = sampleFilament(filamentIndex, floor(posMod(leftIndex - 0.9999, float(u_vertexCount)))).xyz;\n    vec3 leftPosition = sampleFilament(filamentIndex, leftIndex).xyz;\n    vec3 rightPosition = sampleFilament(filamentIndex, rightIndex).xyz;\n    vec3 rightRightPosition = sampleFilament(filamentIndex, floor(posMod(rightIndex + 1.0001, float(u_vertexCount)))).xyz;\n\n    vec3 leftTangent = (rightPosition - leftLeftPosition) * 0.5;\n    vec3 rightTangent = (rightRightPosition - leftPosition) * 0.5;\n\n    //vec3 tangent = normalize(mix(leftTangent, rightTangent, t));\n\n    v_uv = mix(u_uvs[int(leftIndex + 0.001)], u_uvs[int(rightIndex + 0.001)], t);\n    v_z = a_data.y;\n\n    vec3 localPosition = evaluateCubicSpline(leftPosition, rightPosition, leftTangent, rightTangent, t) + vec3(0.0, 0.0, -a_data.y * 0.3);\n    vec3 worldPosition = (u_modelMatrix * vec4(localPosition, 1.0)).xyz;\n\n    gl_Position = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n}\n",v+"\nuniform int u_blobIndex;\n\nvarying float v_z;\nvarying vec2 v_uv;\n\nuniform vec3 u_hsvShift;\n\nuniform sampler2D u_albedoTexture;\n\nfloat linearstep(float left, float right, float x) {\n    return clamp((x - left) / (right - left), 0.0, 1.0);\n}\n\nvec3 hsv2rgb(vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvec3 rgb2hsv(vec3 c) {\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\n\nvoid main () {\n    float fade = pow(linearstep(1.0, 0.0, v_z), 2.2);\n\n    vec3 color = texture2D(u_albedoTexture, v_uv).rgb;\n\n    vec3 diffuseHsv = rgb2hsv(color);\n    diffuseHsv = diffuseHsv + u_hsvShift;\n    diffuseHsv.g = min(diffuseHsv.g, 1.1);\n    color = hsv2rgb(diffuseHsv);\n\n    gl_FragColor = vec4(color * 0.02 * fade, getSSSAlpha(u_blobIndex));\n}\n",{a_data:0});var y="\nprecision highp float;\n\nvarying vec2 v_uv;\n\nvarying vec4 v_clipSpacePosition;\nvarying vec4 v_referenceClipSpacePosition;\nuniform sampler2D u_texture;\nuniform sampler2D u_newTexture;\n\nuniform float u_transitionT;\n\nuniform vec2 u_screenResolution;\nuniform vec2 u_imageResolution;\n\nuniform float u_zoom;\n\nuniform float u_intensity;\nuniform float u_time;\n\nuniform vec2 u_fov;\nuniform float u_yScale;\n\nvec3 hsv2rgb(vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvec3 rgb2hsv(vec3 c) {\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec2 cover(vec2 uv, vec2 s, vec2 i) {\n    float imageRatio = i.y / i.x;\n    float screenRatio = s.y / s.x;\n\n    vec2 imageDimensions = screenRatio > imageRatio ?\n        vec2(s.y / imageRatio, s.y) :\n        vec2(s.x, s.x * imageRatio);\n\n    vec2 imageOrigin = s * 0.5 - imageDimensions * vec2(1.0, 1.0) * 0.5;\n    vec2 result = (((vec2(uv.x, 1.0 - uv.y) * s)) - imageOrigin) / imageDimensions;\n    result.y = result.y;\n    return result;\n}\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n#ifdef BLUR\n<sample_blurred_u_texture>\n<sample_blurred_u_newTexture>\n#endif\n\nvoid main () {\n    vec2 referenceTextureCoordinates = (v_referenceClipSpacePosition.xy / v_referenceClipSpacePosition.w);\n\n    float targetFOV = 0.3926991 * 2.5;\n    referenceTextureCoordinates *= u_fov / targetFOV;\n    referenceTextureCoordinates.xy *= u_yScale;\n    referenceTextureCoordinates = referenceTextureCoordinates * 0.5 + 0.5;\n\n    referenceTextureCoordinates.y += 0.075;\n\n    #ifdef BLUR\n    float OFFSET = 0.3;\n    float BLUR_WIDTH = 0.12;\n    vec4 color = sampleBlurredTexture(referenceTextureCoordinates + vec2(u_transitionT * OFFSET, 0.0), u_transitionT * BLUR_WIDTH);\n    vec4 newColor = sampleBlurredNewTexture(referenceTextureCoordinates + vec2(-(1.0 - u_transitionT) * OFFSET, 0.0), (1.0 - u_transitionT) * BLUR_WIDTH);\n    //vec4 newColor = texture2D(u_newTexture, referenceTextureCoordinates);\n    color = mix(color, newColor, u_transitionT);\n    #else\n    vec4 color = texture2D(u_newTexture, referenceTextureCoordinates);\n    #endif\n\n    color.rgb = vec3(0.5) + (color.rgb - 0.5) * 1.0;\n\n    vec3 hsv = rgb2hsv(color.rgb);\n    hsv.g *= 0.85;\n    hsv.b *= 0.85;\n    hsv.g *= mix(1.0, 1.5, u_intensity * (1.0 - color.a));\n    //hsv.z *= mix(1.0, 0.5, u_intensity * (1.0 - color.a));\n\n    vec3 finalColor = hsv2rgb(hsv);\n\n    vec2 textureCoordinates = (v_clipSpacePosition.xy / v_clipSpacePosition.w) * 0.5 + 0.5;\n    vec3 direction = normalize(vec3(\n    \t(textureCoordinates * 2.0 - 1.0) * mix(0.001, 1.0, u_intensity),\n    \t-1.0));\n\n    float factor = pow(max(-direction.z, 0.0), 4.0);\n    finalColor *= mix(factor, 1.0, color.a);\n\n    gl_FragColor = vec4(finalColor, 1.0);\n\n   // gl_FragColor = vec4(vec3(factor * 0.3), 1.0);\n}\n".replace("<sample_blurred_u_texture>",ce(5,"u_texture","sampleBlurredTexture")).replace("<sample_blurred_u_newTexture>",ce(5,"u_newTexture","sampleBlurredNewTexture"));this.backgroundProgram=n(t,ue,y,{a_position:0}),this.backgroundBlurProgram=n(t,ue,"#define BLUR \n "+y,{a_position:0}),this.colorProgram=n(t,"\nprecision highp float;\n\nattribute vec2 a_position;\n\nvoid main () {\n    gl_Position = vec4(a_position, 0.0, 1.0);\n}\n","\nprecision highp float;\n\nvarying vec2 v_uv;\n\nuniform vec4 u_color;\n\nvoid main () {\n    gl_FragColor = u_color;\n}\n",{a_position:0}),this.blobDepthProgram=n(t,"\nprecision highp float;\n\nattribute vec3 a_position;\nattribute vec3 a_normal;\n//attribute vec2 a_uv;\n\nvarying vec3 v_normal;\nvarying vec3 v_position;\n//varying vec2 v_uv;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_modelMatrix;\nuniform mat4 u_viewMatrix;\n\nvarying vec4 v_clipSpacePosition;\n\nvoid main () {\n    //v_uv = a_uv;\n    vec3 worldPosition = (u_modelMatrix * vec4(a_position, 1.0)).xyz;\n    v_normal = (u_modelMatrix * vec4(-a_normal, 0.0)).xyz;\n\n    v_position = worldPosition;\n    v_clipSpacePosition = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n    gl_Position = v_clipSpacePosition;\n}\n","\nprecision highp float;\n\nvarying vec4 v_clipSpacePosition;\n\nconst float PackUpscale = 256.0 / 255.0;\nconst float UnpackDownscale = 255.0 / 256.0;\n\nconst vec3 PackFactors = vec3( 256.0 * 256.0 * 256.0, 256.0 * 256.0,  256.0);\nconst vec4 UnpackFactors = UnpackDownscale / vec4(PackFactors, 1.0);\n\nconst float ShiftRight8 = 1.0 / 256.0;\n\nvec4 packDepthToRGBA(const in float v) {\n    vec4 r = vec4(fract(v * PackFactors), v);\n    r.yzw -= r.xyz * ShiftRight8;\n    return r * PackUpscale;\n}\n\nvoid main () {\n\tfloat ndcDepth = v_clipSpacePosition.z / v_clipSpacePosition.w;\n\tgl_FragColor = packDepthToRGBA(ndcDepth * 0.5 + 0.5);\n}\n",{a_position:0,a_normal:1}),this.mouthDepthProgram=n(t,"#define SHADOW \n "+se,le,{a_data:0}),this.uiProgram=n(t,"\nprecision highp float;\n\nattribute vec3 a_position;\nattribute vec4 a_color;\n\nvarying vec4 v_color;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_modelMatrix;\n\nvoid main () {\n    v_color = a_color;\n    gl_Position = u_projectionMatrix * u_viewMatrix * u_modelMatrix * vec4(a_position, 1.0);\n}\n","\nprecision highp float;\n\nuniform float u_alpha;\n\nvarying vec4 v_color;\n\nvoid main () {\n    gl_FragColor = v_color * vec4(1.0, 1.0, 1.0, u_alpha);\n}\n",{a_position:0,a_color:1}),this.dustProgram=n(t,"\nprecision highp float;\n\nattribute vec2 a_offset;\nattribute vec4 a_random;\nattribute vec3 a_spawnPosition;\nattribute vec3 a_spawnVelocity;\nattribute float a_spawnTime;\n\nuniform float u_time;\nuniform float u_scale;\nuniform vec3 u_cameraPosition;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_viewMatrix;\n\nvarying vec2 v_offset;\nvarying vec3 v_worldPosition;\nvarying vec4 v_random;\n\nvarying float v_alpha;\n\nvoid main () {\n    v_offset = a_offset;\n    v_random = a_random;\n\n    float elapsedTime = u_time - a_spawnTime;\n    vec3 particlePosition = a_spawnPosition + a_spawnVelocity * elapsedTime;\n\n    v_alpha = 1.0;\n\n    vec3 toCamera = u_cameraPosition - particlePosition;\n    vec3 forwardDirection = toCamera;\n\n    vec3 right = normalize(cross(vec3(0.0, 1.0, 0.1), forwardDirection));\n    vec3 up = normalize(cross(forwardDirection, right));\n\n    vec2 size = vec2(mix(0.01, 0.015, a_random.w)) * u_scale;\n    vec3 worldPosition = particlePosition + a_offset.x * right * size.x + a_offset.y * up * size.y;\n\n    v_worldPosition = worldPosition;\n\n    gl_Position = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n}\n",v+"\nvarying vec2 v_offset;\nvarying vec4 v_random;\nvarying vec3 v_worldPosition;\nvarying float v_alpha;\n\nvoid main() {\n    vec3 color = vec3(1.0);// * getShadowFromLights(v_worldPosition);\n    float alpha = smoothstep(1.0, mix(0.0, 0.9, v_random.y), length(v_offset)) * mix(0.05, 0.1, v_random.z);\n    alpha *= v_alpha;\n    gl_FragColor = vec4(color * alpha, alpha);\n}\n",{a_offset:0,a_random:1,a_spawnTime:2,a_spawnPosition:3,a_spawnVelocity:4}),this.sssBlurProgram=n(t,pe,ee(17,f),{a_position:0}),this.fxaaProgram=n(t,pe,"\nprecision highp float;\n\nvarying vec2 v_coordinates;\n\nuniform sampler2D u_input;\n\nuniform float u_time;\nuniform vec2 u_resolution;\n\nconst float FXAA_SPAN_MAX = 8.0;\nconst float FXAA_REDUCE_MUL = 1.0 / 8.0;\nconst float FXAA_REDUCE_MIN = 1.0 / 128.0;\n\nvec3 getDither() {\n    vec3 vDither = vec3(dot(vec2(171.0,231.0), gl_FragCoord.xy + u_time));\n    vDither.rgb = fract(vDither.rgb/vec3(103.0,71.0,97.0))-vec3(0.5,0.5,0.5);\n    return vDither / 127.0;\n}\n\nvec4 sampleFXAA() {\n    vec2 delta = 1.0 / u_resolution;\n\n    vec3 rgbNW = texture2D(u_input, v_coordinates + vec2(-0.5, -0.5) * delta).rgb;\n    vec3 rgbNE = texture2D(u_input, v_coordinates + vec2(0.5, -0.5) * delta).rgb;\n    vec3 rgbSW = texture2D(u_input, v_coordinates + vec2(-0.5, 0.5) * delta).rgb;\n    vec3 rgbSE = texture2D(u_input, v_coordinates + vec2(0.5, 0.5) * delta).rgb;\n    vec3 rgbM = texture2D(u_input, v_coordinates).rgb;\n\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    vec2 dir = vec2(\n        -((lumaNW + lumaNE) - (lumaSW + lumaSE)),\n        ((lumaNW + lumaSW) - (lumaNE + lumaSE)));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) * (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX), max(vec2(-FXAA_SPAN_MAX), dir * rcpDirMin)) * delta.xy;\n\n    vec3 rgbA = 0.5 * (texture2D(u_input, v_coordinates.xy + dir * (1.0 / 3.0 - 0.5)).xyz + texture2D(u_input, v_coordinates.xy + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (texture2D(u_input, v_coordinates.xy + dir * -0.5).xyz + texture2D(u_input, v_coordinates.xy + dir * 0.5).xyz);\n    float lumaB = dot(rgbB, luma);\n\n    if (lumaB < lumaMin || lumaB > lumaMax) {\n        return vec4(rgbA, 1.0);\n    } else {\n        return vec4(rgbB, 1.0);\n    }\n}\n \nvoid main () {\n    vec4 sample = sampleFXAA();\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n    sample.rgb += getDither();\n    #endif\n    gl_FragColor = sample;\n}\n",{a_position:0}),this.compositeBackgroundProgram=n(t,pe,"\nprecision highp float;\n\nuniform sampler2D u_backgroundTexture;\nuniform sampler2D u_maskTexture;\n\nvarying vec2 v_coordinates;\n\nvoid main () {\n    vec3 backgroundColor = texture2D(u_backgroundTexture, v_coordinates).rgb;\n    float mask = dot(texture2D(u_maskTexture, v_coordinates), vec4(0.299, 0.587, 0.114, 0.0));\n    gl_FragColor = vec4(backgroundColor, mask);\n}\n",{a_position:0}),this.quadVertexBuffer=u(t,t.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,1]),t.STATIC_DRAW),this.triangleVertexBuffer=u(t,t.ARRAY_BUFFER,new Float32Array([-1,-1,3,-1,-1,3]),t.STATIC_DRAW),g.theme===c.Normal?this.festiveScene={kind:c.Normal}:g.theme===c.Christmas?this.festiveScene={kind:c.Christmas,snow:new K(t,!1,600,this.projectionViewMatrix),snowProgram:n(t,"\nprecision highp float;\n\nattribute vec2 a_offset;\nattribute vec4 a_random;\nattribute vec3 a_spawnPosition;\nattribute float a_spawnTime;\n\nuniform float u_time;\nuniform vec3 u_cameraPosition;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_viewMatrix;\nuniform float u_transitionT; // 0 is center, -1 is off screen to left, 1 is off screen to right\n\nvarying vec2 v_offset;\nvarying vec3 v_worldPosition;\nvarying vec4 v_random;\n\nconst float floorY = 0.0 + 0.01; // Slight offset to put above ground\nconst float GRAVITY = -0.8;\n\nvarying float v_alpha;\n\nvoid main () {\n    v_offset = a_offset;\n    v_random = a_random;\n\n    float elapsedTime = u_time - a_spawnTime;\n    vec3 particlePosition = a_spawnPosition + vec3(0.0, GRAVITY, 0.0) * elapsedTime;\n    particlePosition.x += u_transitionT * 4.0;\n\n    float hitTime = a_spawnTime + (floorY - a_spawnPosition.y) / GRAVITY;\n    float timeSinceHit = u_time - hitTime;\n\n    bool hit = timeSinceHit > 0.0;\n    v_alpha = smoothstep(2.0, 1.0, timeSinceHit);\n\n    vec3 toCamera = u_cameraPosition - particlePosition;\n    vec3 forwardDirection = hit ? vec3(0.0, 1.0, 0.0) : toCamera;\n\n    vec3 right = normalize(cross(vec3(0.0, 1.0, 0.1), forwardDirection));\n    vec3 up = normalize(cross(forwardDirection, right));\n\n    particlePosition.y = max(particlePosition.y, floorY);\n\n    vec2 size = vec2(mix(0.005, 0.01, a_random.x)) * (1.0 - abs(u_transitionT));\n    if (hit) size *= 3.0;\n    vec3 worldPosition = particlePosition + a_offset.x * right * size.x + a_offset.y * up * size.y;\n\n    v_worldPosition = worldPosition;\n\n    gl_Position = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n}\n",v+"\nvarying vec2 v_offset;\nvarying vec4 v_random;\nvarying vec3 v_worldPosition;\nvarying float v_alpha;\n\nvoid main() {\n    vec3 color = vec3(1.0);// * getShadowFromLights(v_worldPosition);\n    float alpha = smoothstep(1.0, mix(0.0, 0.9, v_random.y), length(v_offset)) * mix(0.5, 1.0, v_random.z);\n    alpha *= v_alpha;\n    gl_FragColor = vec4(color * alpha, alpha);\n}\n",{a_offset:0,a_random:1,a_spawnTime:2,a_spawnPosition:3}),hatProgram:n(t,fe,v+"\nvarying vec3 v_worldPosition;\nvarying vec3 v_color;\nvarying vec3 v_normal;\nvarying vec3 v_restPosition;\nvarying float v_material;\n\nvoid main () {\n    vec3 diffuseColor = v_color;\n\n    float roughness = 0.8;\n    float f0 = 0.05;\n\n    vec3 color = shadeSurfaceWithLights(v_worldPosition, v_normal, diffuseColor, roughness, f0);\n\n    gl_FragColor = vec4(color, 0.99 + v_material * 0.01);\n}\n",{a_data:0,a_normal:1}),hatDepthProgram:n(t,"#define SHADOW \n"+fe,le,{a_data:0}),hatGeometry:J(t)}:g.theme===c.NewYears&&(this.festiveScene={kind:c.NewYears,confetti:new oe(t,!1,600,this.projectionViewMatrix),confettiProgram:n(t,he,v+de,{a_offset:0,a_random:1,a_spawnTime:2,a_spawnPosition:3,a_rotation:4}),hatProgram:n(t,fe,v+"\n#define PI 3.14159265358979323846\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_color;\nvarying vec3 v_normal;\nvarying vec2 v_uv;\nvarying vec3 v_restPosition;\n\nuniform float u_brimRadius;\nuniform float u_blobIndex;\nuniform float u_baseHue;\n\nvec3 hsv2rgb(vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat spiral(vec3 p) {\n    float hatLength = u_brimRadius * 2.2; // TODO: Sync this with C++\n    float theta = atan(p.z, p.x);\n    float r = p.y;\n    return step(0.5, mod((r / hatLength) * 2.0 + theta / (2.0 * PI), 1.0));\n}\n\nvoid main () {\n    float hatLength = u_brimRadius * 2.2; // TODO: Sync this with C++\n    vec2 coords = vec2(v_uv.x * u_brimRadius * 2.0 * PI, v_uv.y * hatLength);\n\n    float hue = u_baseHue;\n    float stripe = spiral(v_restPosition);\n    hue += step(0.5, stripe) * 0.1;\n\n    if (v_color.z > 0.5) {\n        hue = u_baseHue;\n    }\n\n    vec3 diffuseColor = pow(hsv2rgb(vec3(hue, 0.8, 1.0)), vec3(2.2));\n\n    float roughness = 0.1;\n    float f0 = 0.05;\n\n    vec3 color = shadeSurfaceWithLights(v_worldPosition, v_normal, diffuseColor, roughness, f0);\n\n    gl_FragColor = vec4(color, 0.99 + stripe * 0.01);\n}\n",{a_data:0,a_normal:1}),hatDepthProgram:n(t,"#define SHADOW \n"+fe,le,{a_data:0}),balloons:g.balloons,balloonProgram:n(t,"\nprecision highp float;\n\nattribute vec3 a_position;\nattribute vec3 a_normal;\nattribute vec3 a_tangent;\nattribute vec2 a_uv;\n\nvarying vec3 v_normal;\nvarying vec3 v_position;\nvarying vec3 v_tangent;\nvarying vec2 v_uv;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_modelMatrix;\nuniform mat4 u_viewMatrix;\n\nvoid main () {\n    vec3 worldPosition = (u_modelMatrix * vec4(a_position, 1.0)).xyz;\n    v_normal = normalize((u_modelMatrix * vec4(a_normal, 0.0)).xyz);\n    v_tangent = normalize((u_modelMatrix * vec4(a_tangent, 0.0)).xyz);\n    v_uv = a_uv;\n\n    v_position = worldPosition;\n    gl_Position = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n}\n",v+"\nvarying vec3 v_position;\nvarying vec3 v_normal;\nvarying vec3 v_tangent;\nvarying vec2 v_uv;\n\nuniform sampler2D u_environmentMap;\nuniform sampler2D u_normalMap;\n\nuniform float u_intensity;\n\nuniform vec2 u_uvOffset;\n\n#define PI 3.14159265358979323846\n\nvec2 mapRectangular(vec3 direction) {\n    return vec2(\n        fract((atan(direction.z, direction.x) + PI) / (2.0 * PI)),\n        acos(direction.y) / PI\n    );\n}\n\nvoid main () {\n    vec3 viewRay = normalize(u_cameraPosition - v_position);\n\n    vec3 normal = v_normal;\n    vec2 uv = v_uv + u_uvOffset;\n    vec3 localNormal = texture2D(u_normalMap, uv).rgb * 2.0 - 1.0;\n    localNormal = normalize(localNormal * vec3(1.0, 1.0, 0.5));\n    mat3 frame = mat3(v_tangent, cross(v_tangent, v_normal), v_normal);\n    normal = frame * localNormal;\n\n    vec3 reflectedRay = reflect(viewRay, normal);\n\n    vec3 reflectedColor = texture2D(u_environmentMap, mapRectangular(reflectedRay)).rgb * 1.4;\n\n    vec3 albedo = vec3(0.9764, 0.9176, 0.5921);\n    vec3 color = shadeSurfaceWithLightsWithoutShadow(v_position, normal, albedo, 0.02, 0.05);\n    gl_FragColor = vec4(pow(mix(color, reflectedColor * albedo, 0.85) * mix(1.0, 0.7, u_intensity), vec3(1.0 / u_gamma)), 0.0);\n}\n",{a_position:0,a_normal:1,a_tangent:2,a_uv:3}),balloonStringProgram:n(t,"\nprecision highp float;\n\nattribute vec2 a_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_modelMatrix;\nuniform mat4 u_viewMatrix;\n\nuniform vec3 u_cameraPosition;\n\nuniform vec3 u_bottomPoint;\nuniform vec3 u_attachPoint;\n\nvoid main () {\n    vec3 worldBottomPoint = vec3(u_modelMatrix * vec4(u_bottomPoint, 1.0));\n    vec3 worldAttachPoint = vec3(u_modelMatrix * vec4(u_attachPoint, 1.0));\n    vec3 position = mix(worldAttachPoint, worldBottomPoint + vec3(0.0, 0.1, 0.0), a_position.y * 0.5 + 0.5);\n\n    vec3 toCamera = u_cameraPosition - position;\n    vec3 right = normalize(cross(worldBottomPoint - worldAttachPoint, toCamera));\n\n    vec3 worldPosition = position + a_position.x * right * 0.01;\n\n    gl_Position = u_projectionMatrix * u_viewMatrix * vec4(worldPosition, 1.0);\n}\n","\nprecision highp float;\n\nuniform float u_intensity;\n\nvoid main () {\n    gl_FragColor = vec4(vec3(0.5, 0.4, 0.03) * 0.5 * mix(1.0, 0.7, u_intensity), 0.0);\n}\n",{a_position:0}),hatGeometry:Z(t),poppers:[],poppedConfettiProgram:n(t,"#define POP \n"+he,v+de,{a_offset:0,a_spawnVelocity:1,a_random:2,a_rotation:3})}),this.setViewMatrix(d.makeTranslation([],-a[0],-a[1],-a[2])),this.lights.push(new me(t,.65*-Math.PI,0*Math.PI,20,1.5,!0)),this.lights.push(new me(t,.2*Math.PI,0*Math.PI,20,.2,!0)),this.lights.push(new me(t,.75*Math.PI,0*Math.PI,20,.1,!1)),this.framebuffer=t.createFramebuffer(),this.shadowFramebuffer=t.createFramebuffer(),this.colorTexture=r(t,0,t.RGBA,t.UNSIGNED_BYTE,this.canvas.width,this.canvas.height,null,t.CLAMP_TO_EDGE,t.CLAMP_TO_EDGE,t.LINEAR,t.LINEAR),this.colorTextureTemp=r(t,0,t.RGBA,t.UNSIGNED_BYTE,this.canvas.width,this.canvas.height,null,t.CLAMP_TO_EDGE,t.CLAMP_TO_EDGE,t.LINEAR,t.LINEAR),this.renderbuffer=l(t,t.DEPTH_STENCIL,this.canvas.width,this.canvas.height),this.resize(),this.startTime=Date.now()/1e3,this.lastTime=0,this.dust=new ie(t,!0,10,this.projectionViewMatrix),this.tongueGeometry=function(e){for(var t=[],i=0;i<20;++i)for(var n=i/19.5,o=n<.5?1:Math.sqrt(1-Math.pow(Object(p.o)(.5,1,n),2)),r=0;r<16;++r){var a=2*Math.PI*r/16;t.push(.15*Math.cos(a)*o,.075*Math.sin(a)*o,n)}for(var s=[],l=0;l<19;++l)for(r=0;r<16;++r){var c=16*l+r,h=16*l+(r+1)%16,d=c+16,f=h+16;s.push(c,h,f),s.push(f,d,c)}for(r=1;r<15;++r)s.push(304),s.push(304+r),s.push(304+r+1);var m=Object(p.c)(t,s,.3);return{positionsBuffer:u(e,e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),normalsBuffer:u(e,e.ARRAY_BUFFER,new Float32Array(m),e.STATIC_DRAW),indexBuffer:u(e,e.ELEMENT_ARRAY_BUFFER,new Uint16Array(s),e.STATIC_DRAW),indexCount:s.length}}(t),this.mouthInsideGeometry=function(e){for(var t=[],i=0;i<20;++i)for(var n=0;n<16;++n)t.push(n/16,i/19);for(var o=[],r=0;r<19;++r)for(n=0;n<16;++n){var a=16*r+n,s=16*r+(n+1)%16,l=a+16,c=s+16;o.push(a,s,c),o.push(c,l,a)}return{vertexBuffer:u(e,e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),indexBuffer:u(e,e.ELEMENT_ARRAY_BUFFER,new Uint16Array(o),e.STATIC_DRAW),indexCount:o.length}}(t),this.setStaticLightingUniforms(this.blobProgram),this.setStaticLightingUniforms(this.eyeProgram),this.setStaticLightingUniforms(this.mouthProgram),this.setStaticLightingUniforms(this.tongueProgram),this.setStaticLightingUniforms(this.floorProgram),this.festiveScene.kind===c.Christmas?this.setStaticLightingUniforms(this.festiveScene.hatProgram):this.festiveScene.kind===c.NewYears&&(this.setStaticLightingUniforms(this.festiveScene.hatProgram),this.setStaticLightingUniforms(this.festiveScene.confettiProgram),this.setStaticLightingUniforms(this.festiveScene.poppedConfettiProgram),this.setStaticLightingUniforms(this.festiveScene.balloonProgram)),this.floorYOffset=new m.a(-10,(function(e){return 1-Math.pow(1-e,3)})),this.floorYOffset.change(0,1.5),this.backgroundZoom=new m.a(1,(function(e){return Object(p.w)(0,1,e)})),this.backgroundZoom.change(1,1.5),this.dustScale.change(1,1),this.backgroundTexture=this.generateBackgroundTexture(i,o),this.newBackgroundTexture=this.generateBackgroundTexture(i,o)}return e.prototype.resize=function(){var e=this.canvas.clientWidth,t=this.canvas.clientHeight;this.canvas.width===e&&this.canvas.height===t||(this.canvas.width=e,this.canvas.height=t,this.onResize()),this.recalculateProjectionMatrix()},e.prototype.recalculateProjectionMatrix=function(){var e=this.fov,t=this.canvas.height-2*this.paddingHeight,i=this.canvas.width/t;if(i<1){var n=2*Math.atan(1*Math.tan(e/2));e=2*Math.atan(1/i*Math.tan(n/2)),e=Math.min(e,.9*Math.PI)}this.currentVerticalFOV=e,d.makePerspective(this.projectionMatrix,e,this.canvas.width/t,.01,100),d.invert(this.inverseProjectionMatrix,this.projectionMatrix),d.makeInfinitePerspective(this.infiniteProjectionMatrix,e,this.canvas.width/t,.01,100),d.makeInfinitePerspective(this.referenceProjectionMatrix,e,1,.01,100),d.premultiply(this.projectionViewMatrix,this.viewMatrix,this.projectionMatrix)},e.prototype.setSSSColors=function(e){var t=this.gl;this.sssBlurProgram=n(t,pe,ee(17,e),{a_position:0}),console.log(e)},e.prototype.onResize=function(){var e=this.gl;a(e,this.colorTexture,0,e.RGBA,e.UNSIGNED_BYTE,this.canvas.width,this.canvas.height,null,e.CLAMP_TO_EDGE,e.CLAMP_TO_EDGE,e.LINEAR,e.LINEAR),a(e,this.colorTextureTemp,0,e.RGBA,e.UNSIGNED_BYTE,this.canvas.width,this.canvas.height,null,e.CLAMP_TO_EDGE,e.CLAMP_TO_EDGE,e.LINEAR,e.LINEAR),e.bindRenderbuffer(e.RENDERBUFFER,this.renderbuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,this.canvas.width,this.canvas.height)},e.prototype.getWorldRayDirection=function(e,t,i){e[0]=t,e[1]=i,e[2]=1,e[3]=1;var n=d.multiplyVector(e,this.inverseProjectionMatrix,e);n[0]/=n[3],n[1]/=n[3],n[2]/=n[3],f.a.normalize(n,n);var o=d.transformDirection(e,n,this.inverseViewMatrix);return f.a.normalize(o,o),o},e.prototype.getScreenPosition=function(e,t){var i=d.multiplyVector(e,this.viewMatrix,[t[0],t[1],t[2],1]),n=d.multiplyVector(e,this.projectionMatrix,i);return n[0]/=n[3],n[1]/=n[3],e},e.prototype.setStaticLightingUniforms=function(e){var t=this.gl;t.useProgram(e.program),t.uniform3f(e.uniformLocations.u_cameraPosition,this.inverseViewMatrix[12],this.inverseViewMatrix[13],this.inverseViewMatrix[14]),t.uniform1f(e.uniformLocations.u_gamma,2.2);for(var i=0;i<this.lights.length;++i){var n=this.lights[i];t.uniform3fv(e.uniformLocations["u_lightPosition"+i.toFixed(0)],n.position),t.uniform3fv(e.uniformLocations["u_lightColor"+i.toFixed(0)],n.color),n.shadowsEnabled&&(t.uniform2f(e.uniformLocations["u_shadowResolution"+i.toFixed(0)],n.shadowMapWidth,n.shadowMapWidth),t.uniformMatrix4fv(e.uniformLocations["u_lightProjectionViewMatrix"+i.toFixed(0)],!1,n.projectionViewMatrix),t.uniform1i(e.uniformLocations["u_shadowDepthTexture"+i.toFixed(0)],3+i))}},e.prototype.unbindLightingTextures=function(){for(var e=this.gl,t=0;t<this.lights.length;++t)e.activeTexture(e.TEXTURE0+3+t),e.bindTexture(e.TEXTURE_2D,null)},e.prototype.bindLightingTextures=function(){for(var e=this.gl,t=0;t<this.lights.length;++t)e.activeTexture(e.TEXTURE0+3+t),e.bindTexture(e.TEXTURE_2D,this.lights[t].depthColorTexture)},e.prototype.setViewMatrix=function(e){d.copy(this.viewMatrix,e),d.invert(this.inverseViewMatrix,this.viewMatrix),this.cameraPosition[0]=this.inverseViewMatrix[12],this.cameraPosition[1]=this.inverseViewMatrix[13],this.cameraPosition[2]=this.inverseViewMatrix[14],d.premultiply(this.projectionViewMatrix,this.viewMatrix,this.projectionMatrix)},e.prototype.changeScene=function(e,t,i){this.gl.deleteTexture(this.backgroundTexture),this.backgroundTexture=this.newBackgroundTexture,this.newBackgroundTexture=this.generateBackgroundTexture(e,t),this.backgroundTransitionT.change(0,0),this.backgroundTransitionT.change(1,.5,i)},e.prototype.render=function(e){this.resize();var t=Date.now()/1e3-this.startTime,i=t-this.lastTime;this.lastTime=t;for(var n=!1,o=0,r=e;o<r.length;o++)(K=r[o]).isDragging&&(n=!0);var a=this.gl;this.unbindLightingTextures();for(var s=0,l=this.lights;s<l.length;s++){var u=l[s];if(u.shadowsEnabled){a.bindFramebuffer(a.FRAMEBUFFER,this.shadowFramebuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,u.depthColorTexture,0),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,u.depthRenderbuffer),a.viewport(0,0,u.shadowMapWidth,u.shadowMapWidth),a.clearColor(1,1,1,1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.useProgram(this.blobDepthProgram.program),a.uniformMatrix4fv(this.blobDepthProgram.uniformLocations.u_projectionMatrix,!1,u.projectionMatrix),a.uniformMatrix4fv(this.blobDepthProgram.uniformLocations.u_viewMatrix,!1,u.viewMatrix),a.enableVertexAttribArray(0),a.enableVertexAttribArray(1),a.enable(a.DEPTH_TEST);for(var h=0,f=e;h<f.length;h++)if((K=f[h]).state!==E.Offscreen){a.uniformMatrix4fv(this.blobDepthProgram.uniformLocations.u_modelMatrix,!1,K.modelMatrix),a.bindBuffer(a.ARRAY_BUFFER,K.positionsBuffer),a.vertexAttribPointer(0,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,K.normalsBuffer),a.vertexAttribPointer(1,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,K.indexBuffer),a.enable(a.CULL_FACE),a.drawElements(a.TRIANGLES,K.renderingIndexCount,a.UNSIGNED_SHORT,0),a.disable(a.CULL_FACE);for(var m=0,g=K.eyes;m<g.length;m++){var b=g[m];a.bindBuffer(a.ARRAY_BUFFER,b.positionsBuffer),a.vertexAttribPointer(0,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,b.normalsBuffer),a.vertexAttribPointer(1,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,b.indexBuffer),a.drawElements(a.TRIANGLES,b.indexCount,a.UNSIGNED_SHORT,0)}}a.disableVertexAttribArray(1),a.disable(a.CULL_FACE),a.useProgram(this.mouthDepthProgram.program),a.uniformMatrix4fv(this.mouthDepthProgram.uniformLocations.u_projectionMatrix,!1,u.projectionMatrix),a.uniformMatrix4fv(this.mouthDepthProgram.uniformLocations.u_viewMatrix,!1,u.viewMatrix),a.enableVertexAttribArray(0),a.enable(a.DEPTH_TEST);for(var v=0,y=e;v<y.length;v++)(K=y[v]).state!==E.Offscreen&&(a.uniformMatrix4fv(this.mouthDepthProgram.uniformLocations.u_modelMatrix,!1,K.modelMatrix),a.uniform1i(this.mouthDepthProgram.uniformLocations.u_vertexCount,K.mouthPositionCount),a.uniform1f(this.mouthDepthProgram.uniformLocations.u_lipScale,1.25*K.config.lipScale),a.uniform3fv(this.mouthDepthProgram.uniformLocations["u_positions[0]"],K.getMouthPositions()),a.bindBuffer(a.ARRAY_BUFFER,K.mouthGeometry.vertexBuffer),a.vertexAttribPointer(0,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,K.mouthGeometry.indexBuffer),a.drawElements(a.TRIANGLES,K.mouthGeometry.indexCount,a.UNSIGNED_SHORT,0));if(this.festiveScene.kind===c.Christmas||this.festiveScene.kind===c.NewYears){var x=this.festiveScene.hatDepthProgram,_=this.festiveScene.hatGeometry;a.useProgram(x.program),a.uniformMatrix4fv(x.uniformLocations.u_projectionMatrix,!1,u.projectionMatrix),a.uniformMatrix4fv(x.uniformLocations.u_viewMatrix,!1,u.viewMatrix),a.enableVertexAttribArray(0),a.bindBuffer(a.ARRAY_BUFFER,_.dataBuffer),a.vertexAttribPointer(0,4,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,_.indexBuffer),a.enable(a.DEPTH_TEST),a.enable(a.CULL_FACE);for(var w=0,P=e;w<P.length;w++)null!==(K=P[w]).hat&&1!==K.hatOffset.evaluate()&&K.state!==E.Offscreen&&(a.uniformMatrix4fv(x.uniformLocations.u_modelMatrix,!1,K.getHatModelMatrix()),a.uniform3fv(x.uniformLocations["u_profilePoints[0]"],K.hat.getBrimPositions()),a.uniform3fv(x.uniformLocations["u_splinePositions[0]"],K.hat.getSplinePositions()),a.uniform3fv(x.uniformLocations["u_splineTangents[0]"],K.hat.getSplineTangents()),a.uniform3fv(x.uniformLocations["u_splineNormals[0]"],K.hat.getSplineNormals()),a.uniform1f(x.uniformLocations.u_brimRadius,K.config.parameters.brimRadius),a.drawElements(a.TRIANGLES,_.indexCount,a.UNSIGNED_SHORT,0));a.disable(a.CULL_FACE)}}}a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.colorTexture,0),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this.renderbuffer),a.clearColor(0,0,0,0),a.clearStencil(0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT|a.STENCIL_BUFFER_BIT),a.viewport(0,this.paddingHeight,this.canvas.width,this.canvas.height-2*this.paddingHeight),this.bindLightingTextures(),a.useProgram(this.blobProgram.program),a.uniform3fv(this.blobProgram.uniformLocations.u_cameraPosition,this.cameraPosition),a.uniformMatrix4fv(this.blobProgram.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(this.blobProgram.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.uniform1i(this.blobProgram.uniformLocations.u_albedoTexture,0),a.uniform1i(this.blobProgram.uniformLocations.u_materialMap,1),a.enableVertexAttribArray(0),a.enableVertexAttribArray(1),a.enableVertexAttribArray(2),a.enableVertexAttribArray(3),a.enable(a.DEPTH_TEST),a.enable(a.CULL_FACE),a.cullFace(a.FRONT);for(var S=0;S<e.length;++S)if((K=e[S]).state!==E.Offscreen){a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,e[S].assets.bodyMaterial.albedoTexture),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,e[S].assets.bodyMaterial.materialMap),a.uniform1i(this.blobProgram.uniformLocations.u_blobIndex,S%4),a.uniform1f(this.blobProgram.uniformLocations.u_normalScale,K.assets.bodyMaterial.normalScale),a.uniform1f(this.blobProgram.uniformLocations.u_isSinging,K.smoothIsSinging.evaluate()),a.uniform3f(this.blobProgram.uniformLocations.u_hsvShift,K.assets.bodyMaterial.hueShift,K.assets.bodyMaterial.saturationBoost,K.assets.bodyMaterial.lightnessBoost),a.uniform1f(this.blobProgram.uniformLocations.u_f0,K.assets.bodyMaterial.f0),a.uniform1f(this.blobProgram.uniformLocations.u_roughnessScale,K.assets.bodyMaterial.roughnessScale);var k=K.rimLevel.evaluate();a.uniform3f(this.blobProgram.uniformLocations.u_rimColor,k,k,k),a.uniformMatrix4fv(this.blobProgram.uniformLocations.u_modelMatrix,!1,K.modelMatrix),a.bindBuffer(a.ARRAY_BUFFER,K.positionsBuffer),a.vertexAttribPointer(0,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,K.normalsBuffer),a.vertexAttribPointer(1,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,K.uvsBuffer),a.vertexAttribPointer(2,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,K.speedsBuffer),a.vertexAttribPointer(3,1,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,K.indexBuffer),a.drawElements(a.TRIANGLES,K.renderingIndexCount,a.UNSIGNED_SHORT,0)}for(a.disable(a.CULL_FACE),a.cullFace(a.BACK),a.disableVertexAttribArray(1),a.disableVertexAttribArray(2),a.disableVertexAttribArray(3),a.useProgram(this.eyeProgram.program),a.uniform3fv(this.eyeProgram.uniformLocations.u_cameraPosition,this.cameraPosition),a.uniformMatrix4fv(this.eyeProgram.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(this.eyeProgram.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.uniform1f(this.eyeProgram.uniformLocations.u_time,t),a.uniform1i(this.eyeProgram.uniformLocations.u_albedoTexture,0),a.uniform1i(this.eyeProgram.uniformLocations.u_materialMap,1),a.enableVertexAttribArray(0),a.enableVertexAttribArray(1),a.enableVertexAttribArray(2),a.enableVertexAttribArray(3),a.enable(a.DEPTH_TEST),S=0;S<e.length;++S)if((K=e[S]).state!==E.Offscreen){a.uniform1i(this.eyeProgram.uniformLocations.u_blobIndex,S%4),a.uniformMatrix4fv(this.eyeProgram.uniformLocations.u_modelMatrix,!1,K.modelMatrix),a.uniform1i(this.eyeProgram.uniformLocations.u_hipnotized,K.overrideHipnotized?1:0),a.uniform1f(this.eyeProgram.uniformLocations.u_bottomEyelidAngle,K.getBottomEyelidAngle()),a.uniform1f(this.eyeProgram.uniformLocations.u_topEyelidAngle,K.getTopEyelidAngle()),a.uniform1f(this.eyeProgram.uniformLocations.u_pupilSize,.085*Math.pow(K.config.parameters.leftEyeScale[0],.5)),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,e[S].assets.bodyMaterial.albedoTexture),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,e[S].assets.bodyMaterial.materialMap),a.uniform3f(this.eyeProgram.uniformLocations.u_hsvShift,K.assets.bodyMaterial.hueShift,K.assets.bodyMaterial.saturationBoost,K.assets.bodyMaterial.lightnessBoost),a.uniform1f(this.eyeProgram.uniformLocations.u_f0,K.assets.bodyMaterial.f0),a.uniform1f(this.eyeProgram.uniformLocations.u_roughnessScale,K.assets.bodyMaterial.roughnessScale);for(var A=K.eyes.length-1;A>=0;--A)b=K.eyes[A],a.uniform3fv(this.eyeProgram.uniformLocations.u_eyePosition,b.attachPosition),a.uniform3fv(this.eyeProgram.uniformLocations.u_lookDirection,b.lookDirection),a.bindBuffer(a.ARRAY_BUFFER,b.positionsBuffer),a.vertexAttribPointer(0,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,b.normalsBuffer),a.vertexAttribPointer(1,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,b.restPositionsBuffer),a.vertexAttribPointer(2,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,b.uvsBuffer),a.vertexAttribPointer(3,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,b.indexBuffer),a.drawElements(a.TRIANGLES,b.indexCount,a.UNSIGNED_SHORT,0)}for(a.depthMask(!0),a.disableVertexAttribArray(1),a.disableVertexAttribArray(2),a.disableVertexAttribArray(3),a.useProgram(this.mouthProgram.program),a.uniform3fv(this.mouthProgram.uniformLocations.u_cameraPosition,this.cameraPosition),a.uniformMatrix4fv(this.mouthProgram.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(this.mouthProgram.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.uniform1i(this.mouthProgram.uniformLocations.u_albedoTexture,0),a.enableVertexAttribArray(0),a.enableVertexAttribArray(1),a.enableVertexAttribArray(2),a.enable(a.DEPTH_TEST),S=0;S<e.length;++S)(K=e[S]).state!==E.Offscreen&&(a.uniform1i(this.mouthProgram.uniformLocations.u_blobIndex,S%4),a.uniform3fv(this.mouthProgram.uniformLocations.u_color,K.assets.mouthColor),a.uniform3fv(this.mouthProgram.uniformLocations.u_restMouthCentroid,K.restMouthCentroid),a.uniform1f(this.mouthProgram.uniformLocations.u_lipScale,K.config.lipScale),a.uniformMatrix4fv(this.mouthProgram.uniformLocations.u_modelMatrix,!1,K.modelMatrix),a.uniform1i(this.mouthProgram.uniformLocations.u_vertexCount,K.mouthPositionCount),a.uniform3fv(this.mouthProgram.uniformLocations["u_positions[0]"],K.getMouthPositions()),a.bindBuffer(a.ARRAY_BUFFER,K.mouthGeometry.vertexBuffer),a.vertexAttribPointer(0,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,K.mouthGeometry.normalsBuffer),a.vertexAttribPointer(1,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,K.mouthGeometry.uvsBuffer),a.vertexAttribPointer(2,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,K.mouthGeometry.indexBuffer),a.drawElements(a.TRIANGLES,K.mouthGeometry.indexCount,a.UNSIGNED_SHORT,0));for(a.disableVertexAttribArray(1),a.disableVertexAttribArray(2),a.enable(a.STENCIL_TEST),a.stencilOp(a.KEEP,a.KEEP,a.REPLACE),a.useProgram(this.mouthInsideProgram.program),a.uniformMatrix4fv(this.mouthInsideProgram.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(this.mouthInsideProgram.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.enableVertexAttribArray(0),a.enable(a.DEPTH_TEST),S=0;S<e.length;++S)(K=e[S]).state!==E.Offscreen&&(a.uniformMatrix4fv(this.mouthInsideProgram.uniformLocations.u_modelMatrix,!1,K.modelMatrix),a.bindBuffer(a.ARRAY_BUFFER,K.positionsBuffer),a.vertexAttribPointer(0,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,K.mouthTriangleIndexBuffer),a.stencilFunc(a.ALWAYS,1<<e.length-1-S,1<<e.length-1-S),a.drawElements(a.TRIANGLES,K.mouthTriangleIndexCount,a.UNSIGNED_SHORT,0));for(a.depthMask(!0),a.stencilOp(a.KEEP,a.KEEP,a.KEEP),a.useProgram(this.throatProgram.program),a.uniformMatrix4fv(this.throatProgram.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(this.throatProgram.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.uniform1i(this.throatProgram.uniformLocations.u_albedoTexture,0),a.enableVertexAttribArray(0),a.bindBuffer(a.ARRAY_BUFFER,this.mouthInsideGeometry.vertexBuffer),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.mouthInsideGeometry.indexBuffer),a.disable(a.DEPTH_TEST),S=0;S<e.length;++S)(K=e[S]).state!==E.Offscreen&&(a.uniformMatrix4fv(this.throatProgram.uniformLocations.u_modelMatrix,!1,K.modelMatrix),a.uniform1i(this.throatProgram.uniformLocations.u_blobIndex,S%4),a.uniform1i(this.throatProgram.uniformLocations.u_vertexCount,K.mouthPositionCount),a.uniform3fv(this.throatProgram.uniformLocations["u_positions[0]"],K.getMouthPositions()),a.uniform2fv(this.throatProgram.uniformLocations["u_uvs[0]"],K.mouthUVs),a.uniform3f(this.throatProgram.uniformLocations.u_hsvShift,K.assets.bodyMaterial.hueShift,K.assets.bodyMaterial.saturationBoost,K.assets.bodyMaterial.lightnessBoost),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,K.assets.bodyMaterial.albedoTexture),a.stencilFunc(a.EQUAL,1<<e.length-1-S,4294967295),a.drawElements(a.TRIANGLES,this.mouthInsideGeometry.indexCount,a.UNSIGNED_SHORT,0));for(a.useProgram(this.tongueProgram.program),a.uniform3fv(this.tongueProgram.uniformLocations.u_cameraPosition,this.cameraPosition),a.uniformMatrix4fv(this.tongueProgram.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(this.tongueProgram.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.enableVertexAttribArray(0),a.enableVertexAttribArray(1),a.bindBuffer(a.ARRAY_BUFFER,this.tongueGeometry.positionsBuffer),a.vertexAttribPointer(0,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.tongueGeometry.normalsBuffer),a.vertexAttribPointer(1,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.tongueGeometry.indexBuffer),S=0;S<e.length;++S)(K=e[S]).state!==E.Offscreen&&(a.uniformMatrix4fv(this.tongueProgram.uniformLocations.u_modelMatrix,!1,K.modelMatrix),a.uniform2fv(this.tongueProgram.uniformLocations.u_scale,K.tongueScale),a.uniform3fv(this.tongueProgram.uniformLocations["u_splinePositions[0]"],K.getTonguePositions()),a.uniform3fv(this.tongueProgram.uniformLocations["u_splineTangents[0]"],K.getTongueTangents()),a.uniform3fv(this.tongueProgram.uniformLocations["u_splineNormals[0]"],K.getTongueNormals()),a.stencilFunc(a.EQUAL,1<<e.length-1-S,4294967295),a.drawElements(a.TRIANGLES,this.tongueGeometry.indexCount,a.UNSIGNED_SHORT,0));if(a.disableVertexAttribArray(1),a.disable(a.STENCIL_TEST),this.festiveScene.kind===c.Christmas||this.festiveScene.kind===c.NewYears){var T=this.festiveScene.hatProgram;_=this.festiveScene.hatGeometry,a.useProgram(T.program),a.uniform3fv(T.uniformLocations.u_cameraPosition,this.cameraPosition),a.uniformMatrix4fv(T.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(T.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.enableVertexAttribArray(0),a.enableVertexAttribArray(1),a.bindBuffer(a.ARRAY_BUFFER,_.dataBuffer),a.vertexAttribPointer(0,4,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,_.normalsBuffer),a.vertexAttribPointer(1,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,_.indexBuffer),a.enable(a.DEPTH_TEST);for(var M=0,R=e;M<R.length;M++)null!==(K=R[M]).hat&&1!==K.hatOffset.evaluate()&&K.state!==E.Offscreen&&(a.uniformMatrix4fv(T.uniformLocations.u_modelMatrix,!1,K.getHatModelMatrix()),a.uniform3fv(T.uniformLocations["u_profilePoints[0]"],K.hat.getBrimPositions()),a.uniform3fv(T.uniformLocations["u_splinePositions[0]"],K.hat.getSplinePositions()),a.uniform3fv(T.uniformLocations["u_splineTangents[0]"],K.hat.getSplineTangents()),a.uniform3fv(T.uniformLocations["u_splineNormals[0]"],K.hat.getSplineNormals()),a.uniform1f(T.uniformLocations.u_brimRadius,K.config.parameters.brimRadius),a.uniform1f(T.uniformLocations.u_baseHue,K.config.partyHatHue?K.config.partyHatHue:0),a.drawElements(a.TRIANGLES,_.indexCount,a.UNSIGNED_SHORT,0));a.disableVertexAttribArray(1)}if(this.festiveScene.kind===c.NewYears&&this.festiveParticleTransitionT>-1&&this.festiveParticleTransitionT<1&&this.balloonsYOffset<1){var B=this.festiveScene.balloons,C=this.festiveScene.balloonProgram,F=this.festiveScene.balloonStringProgram;for(a.useProgram(C.program),a.uniform3fv(C.uniformLocations.u_cameraPosition,this.cameraPosition),a.uniformMatrix4fv(C.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(C.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.uniform1f(C.uniformLocations.u_time,t),a.uniform1f(C.uniformLocations.u_intensity,this.backgroundIntensity.evaluate()),a.uniform1i(C.uniformLocations.u_environmentMap,0),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,B.environmentMap),a.uniform1i(C.uniformLocations.u_normalMap,1),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,B.normalMap),a.enableVertexAttribArray(0),a.enableVertexAttribArray(1),a.enableVertexAttribArray(2),a.enableVertexAttribArray(3),a.enable(a.DEPTH_TEST),S=0;S<B.balloons.length;++S){var L=B.balloons[S];a.uniformMatrix4fv(C.uniformLocations.u_modelMatrix,!1,L.getModelMatrix(7*this.festiveParticleTransitionT,0,0)),a.uniform2fv(C.uniformLocations.u_uvOffset,L.uvOffset),a.bindBuffer(a.ARRAY_BUFFER,L.rigidMesh.positionsBuffer),a.vertexAttribPointer(0,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,L.rigidMesh.normalsBuffer),a.vertexAttribPointer(1,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,L.rigidMesh.tangentsBuffer),a.vertexAttribPointer(2,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,L.rigidMesh.uvsBuffer),a.vertexAttribPointer(3,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,L.rigidMesh.indexBuffer),a.drawElements(a.TRIANGLES,L.rigidMesh.indexCount,a.UNSIGNED_SHORT,0)}for(a.disableVertexAttribArray(1),a.disableVertexAttribArray(2),a.disableVertexAttribArray(3),a.useProgram(F.program),a.uniform3fv(F.uniformLocations.u_cameraPosition,this.cameraPosition),a.uniformMatrix4fv(F.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(F.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.uniform1f(F.uniformLocations.u_intensity,this.backgroundIntensity.evaluate()),a.enableVertexAttribArray(0),a.bindBuffer(a.ARRAY_BUFFER,this.quadVertexBuffer),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0),a.enable(a.DEPTH_TEST),S=0;S<B.balloons.length;++S)L=B.balloons[S],a.uniformMatrix4fv(F.uniformLocations.u_modelMatrix,!1,L.getModelMatrix(7*this.festiveParticleTransitionT,0,0)),a.uniform3fv(F.uniformLocations.u_bottomPoint,L.rigidMesh.bottomPoint),a.uniform3fv(F.uniformLocations.u_attachPoint,L.attachPoint),a.drawArrays(a.TRIANGLE_STRIP,0,4);a.disable(a.DEPTH_TEST)}a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.colorTextureTemp,0),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,null),a.clear(a.COLOR_BUFFER_BIT),a.viewport(0,0,this.canvas.width,this.canvas.height),a.enableVertexAttribArray(0),a.bindBuffer(a.ARRAY_BUFFER,this.triangleVertexBuffer),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0),a.useProgram(this.sssBlurProgram.program),a.uniform1i(this.sssBlurProgram.uniformLocations.u_colorTexture,0),a.uniform2f(this.sssBlurProgram.uniformLocations.u_resolution,this.canvas.width,this.canvas.height),a.uniformMatrix4fv(this.sssBlurProgram.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.colorTextureTemp,0),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.colorTexture),a.uniform2f(this.sssBlurProgram.uniformLocations.u_direction,1,0),a.uniform1i(this.sssBlurProgram.uniformLocations.u_gammaCorrect,0),a.drawArrays(a.TRIANGLES,0,3),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.colorTexture,0),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.colorTextureTemp),a.uniform2f(this.sssBlurProgram.uniformLocations.u_direction,0,1),a.uniform1i(this.sssBlurProgram.uniformLocations.u_gammaCorrect,1),a.uniform1f(this.sssBlurProgram.uniformLocations.u_gamma,2.2),a.drawArrays(a.TRIANGLES,0,3),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.colorTexture,0),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this.renderbuffer),a.viewport(0,0,this.canvas.width,this.canvas.height),a.enable(a.SCISSOR_TEST),a.scissor(0,this.paddingHeight,this.canvas.width,this.canvas.height-2*this.paddingHeight),a.enable(a.DEPTH_TEST),a.depthMask(!1);var I=d.premultiply(new Float32Array(16),this.backgroundOriginalViewMatrix,this.projectionMatrix);n?this.backgroundIntensity.change(1,2.5):this.backgroundIntensity.change(0,1);var D=this.backgroundTransitionT.evaluate()<1?this.backgroundBlurProgram:this.backgroundProgram;a.useProgram(D.program),a.uniformMatrix4fv(D.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(D.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.uniformMatrix4fv(D.uniformLocations.u_referenceProjectionViewMatrix,!1,I),a.uniform1f(D.uniformLocations.u_time,t),a.uniform1f(D.uniformLocations.u_intensity,this.backgroundIntensity.evaluate()),a.uniform1f(D.uniformLocations.u_zoom,1),a.uniform2f(D.uniformLocations.u_fov,this.currentVerticalFOV*this.canvas.width/this.canvas.height,this.currentVerticalFOV),a.uniform1f(D.uniformLocations.u_transitionT,this.backgroundTransitionT.evaluate()),a.uniform1f(D.uniformLocations.u_yScale,this.canvas.height/(this.canvas.height-2*this.paddingHeight)),a.uniform2f(D.uniformLocations.u_screenResolution,this.canvas.width,this.canvas.height),a.uniform2f(D.uniformLocations.u_imageResolution,this.backgroundTextureResolution[0],this.backgroundTextureResolution[1]),a.uniform1i(D.uniformLocations.u_texture,0),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.backgroundTexture),a.uniform1i(D.uniformLocations.u_newTexture,1),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.newBackgroundTexture),a.enableVertexAttribArray(0),a.bindBuffer(a.ARRAY_BUFFER,this.quadVertexBuffer),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0),a.drawArrays(a.TRIANGLE_STRIP,0,4),a.disable(a.DEPTH_TEST),a.depthMask(!0),a.disable(a.SCISSOR_TEST),a.viewport(0,this.paddingHeight,this.canvas.width,this.canvas.height-2*this.paddingHeight),a.useProgram(this.floorProgram.program),a.uniform3fv(this.floorProgram.uniformLocations.u_cameraPosition,this.cameraPosition),a.uniformMatrix4fv(this.floorProgram.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(this.floorProgram.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.uniform1f(this.floorProgram.uniformLocations.u_yOffset,this.floorYOffset.evaluate()),a.enable(a.DEPTH_TEST),a.enable(a.BLEND),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),a.bindBuffer(a.ARRAY_BUFFER,this.quadVertexBuffer),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0),a.drawArrays(a.TRIANGLE_STRIP,0,4),a.disable(a.BLEND),a.disable(a.SCISSOR_TEST),a.enable(a.DEPTH_TEST),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.colorTexture,0),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this.renderbuffer),a.depthMask(!1),this.festiveParticleSpawnRate>0?this.dustScale.change(0,5):this.dustScale.change(1,2);var j=d.premultiply(new Float32Array(16),this.viewMatrix,this.projectionMatrix);if(this.dust.update(i,10,j),a.useProgram(this.dustProgram.program),a.uniform3fv(this.dustProgram.uniformLocations.u_cameraPosition,this.cameraPosition),a.uniformMatrix4fv(this.dustProgram.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(this.dustProgram.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.uniform1f(this.dustProgram.uniformLocations.u_scale,this.dustScale.evaluate()),a.uniform1f(this.dustProgram.uniformLocations.u_time,t),a.enableVertexAttribArray(0),a.enableVertexAttribArray(1),a.enableVertexAttribArray(2),a.enableVertexAttribArray(3),a.enableVertexAttribArray(4),a.enable(a.DEPTH_TEST),a.enable(a.BLEND),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),a.bindBuffer(a.ARRAY_BUFFER,this.dust.offsetBuffer),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.dust.randomBuffer),a.vertexAttribPointer(1,4,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.dust.spawnTimeBuffer),a.vertexAttribPointer(2,1,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.dust.spawnPositionBuffer),a.vertexAttribPointer(3,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.dust.spawnVelocityBuffer),a.vertexAttribPointer(4,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.dust.indexBuffer),a.drawElements(a.TRIANGLES,6*this.dust.particleCount,a.UNSIGNED_SHORT,0),a.disableVertexAttribArray(1),a.disableVertexAttribArray(2),a.disableVertexAttribArray(3),a.disableVertexAttribArray(4),a.disable(a.DEPTH_TEST),a.depthMask(!0),a.disable(a.BLEND),this.festiveScene.kind===c.Christmas){if(this.festiveParticleTransitionT>-1&&this.festiveParticleTransitionT<1){this.festiveScene.snow.update(i,this.festiveParticleSpawnRate,j);var O=this.festiveScene.snowProgram,z=this.festiveScene.snow;a.depthMask(!1),a.useProgram(O.program),a.uniform3fv(O.uniformLocations.u_cameraPosition,this.cameraPosition),a.uniformMatrix4fv(O.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(O.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.uniform1f(O.uniformLocations.u_time,this.festiveScene.snow.time),a.uniform1f(O.uniformLocations.u_transitionT,this.festiveParticleTransitionT),a.uniform1f(O.uniformLocations.u_offset,this.festiveParticleOffset),a.enableVertexAttribArray(0),a.enableVertexAttribArray(1),a.enableVertexAttribArray(2),a.enableVertexAttribArray(3),a.enable(a.DEPTH_TEST),a.enable(a.BLEND),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),a.bindBuffer(a.ARRAY_BUFFER,z.offsetBuffer),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,z.randomBuffer),a.vertexAttribPointer(1,4,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,z.spawnTimeBuffer),a.vertexAttribPointer(2,1,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,z.spawnPositionBuffer),a.vertexAttribPointer(3,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,z.indexBuffer),z.spawnedParticleCount>0&&a.drawElements(a.TRIANGLES,6*Math.min(z.spawnedParticleCount,z.particleCount),a.UNSIGNED_SHORT,0),a.disableVertexAttribArray(1),a.disableVertexAttribArray(2),a.disableVertexAttribArray(3),a.disable(a.DEPTH_TEST),a.depthMask(!0),a.disable(a.BLEND)}}else if(this.festiveScene.kind===c.NewYears&&this.festiveParticleTransitionT>-1&&this.festiveParticleTransitionT<1){var N=this.festiveScene.confettiProgram,H=this.festiveScene.confetti;H.update(i,this.festiveParticleSpawnRate,j),this.festiveScene.balloons.step(7*this.balloonsYOffset),a.depthMask(!1),a.useProgram(N.program),a.uniform3fv(N.uniformLocations.u_cameraPosition,this.cameraPosition),a.uniformMatrix4fv(N.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(N.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.uniform1f(N.uniformLocations.u_time,H.time),a.uniform1f(N.uniformLocations.u_transitionT,this.festiveParticleTransitionT),a.uniform1f(N.uniformLocations.u_offset,this.festiveParticleOffset),a.enableVertexAttribArray(0),a.enableVertexAttribArray(1),a.enableVertexAttribArray(2),a.enableVertexAttribArray(3),a.enableVertexAttribArray(4),a.enable(a.DEPTH_TEST),a.enable(a.BLEND),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),a.bindBuffer(a.ARRAY_BUFFER,H.offsetBuffer),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,H.randomBuffer),a.vertexAttribPointer(1,4,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,H.spawnTimeBuffer),a.vertexAttribPointer(2,1,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,H.spawnPositionBuffer),a.vertexAttribPointer(3,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,H.rotationBuffer),a.vertexAttribPointer(4,4,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,H.indexBuffer),H.spawnedParticleCount>0&&a.drawElements(a.TRIANGLES,6*Math.min(H.spawnedParticleCount,H.particleCount),a.UNSIGNED_SHORT,0),a.disableVertexAttribArray(1),a.disableVertexAttribArray(2),a.disableVertexAttribArray(3),a.disableVertexAttribArray(4),a.disable(a.DEPTH_TEST),a.depthMask(!0),a.disable(a.BLEND);var U=this.festiveScene.poppedConfettiProgram;for(S=this.festiveScene.poppers.length-1;S>=0;--S)t-this.festiveScene.poppers[S].spawnTime>20&&(this.festiveScene.poppers[S].destroy(),this.festiveScene.poppers.splice(S,1));a.depthMask(!1),a.enable(a.DEPTH_TEST),a.enable(a.BLEND),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),a.useProgram(U.program),a.uniform3fv(U.uniformLocations.u_cameraPosition,this.cameraPosition),a.uniformMatrix4fv(U.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(U.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.uniform1f(U.uniformLocations.u_time,t),a.uniform1f(U.uniformLocations.u_transitionT,this.festiveParticleTransitionT),a.uniform1f(U.uniformLocations.u_offset,this.festiveParticleOffset),a.enableVertexAttribArray(0),a.enableVertexAttribArray(1),a.enableVertexAttribArray(2),a.enableVertexAttribArray(3);for(var G=0,W=this.festiveScene.poppers;G<W.length;G++){var V=W[G];a.uniform3fv(U.uniformLocations.u_spawnPosition,V.spawnPosition),a.uniform1f(U.uniformLocations.u_spawnTime,V.spawnTime),a.bindBuffer(a.ARRAY_BUFFER,V.offsetBuffer),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,V.spawnVelocityBuffer),a.vertexAttribPointer(1,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,V.randomBuffer),a.vertexAttribPointer(2,4,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,V.rotationBuffer),a.vertexAttribPointer(3,4,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,V.indexBuffer),a.drawElements(a.TRIANGLES,6*V.particleCount,a.UNSIGNED_SHORT,0)}a.disableVertexAttribArray(1),a.disableVertexAttribArray(2),a.disableVertexAttribArray(3),a.disable(a.DEPTH_TEST),a.depthMask(!0),a.disable(a.BLEND)}a.bindFramebuffer(a.FRAMEBUFFER,null),a.viewport(0,0,this.canvas.width,this.canvas.height),a.useProgram(this.fxaaProgram.program),a.enableVertexAttribArray(0),a.bindBuffer(a.ARRAY_BUFFER,this.triangleVertexBuffer),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0),a.uniform1i(this.fxaaProgram.uniformLocations.u_input,0),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.colorTexture),a.uniform2f(this.fxaaProgram.uniformLocations.u_resolution,this.canvas.width,this.canvas.height),a.uniform1f(this.fxaaProgram.uniformLocations.u_time,t),a.drawArrays(a.TRIANGLES,0,3),a.useProgram(this.uiProgram.program),a.uniformMatrix4fv(this.uiProgram.uniformLocations.u_projectionMatrix,!1,this.projectionMatrix),a.uniformMatrix4fv(this.uiProgram.uniformLocations.u_viewMatrix,!1,this.viewMatrix),a.enableVertexAttribArray(0),a.enableVertexAttribArray(1),a.disable(a.DEPTH_TEST),a.enable(a.BLEND),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);for(var Y=0,q=e;Y<q.length;Y++){var K;if((K=q[Y]).state!==E.Offscreen)for(var X=0,J=[K.pitchUI,K.vowelUI];X<J.length;X++){var Z=J[X];0!==Z.alpha.evaluate()&&(a.uniform1f(this.uiProgram.uniformLocations.u_alpha,Z.alpha.evaluate()*Z.overrideAlpha.evaluate()),a.uniformMatrix4fv(this.uiProgram.uniformLocations.u_modelMatrix,!1,Z.getModelMatrix()),a.bindBuffer(a.ARRAY_BUFFER,Z.lines.positionsBuffer),a.vertexAttribPointer(0,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,Z.lines.colorsBuffer),a.vertexAttribPointer(1,4,a.FLOAT,!1,0,0),a.drawArrays(a.LINES,0,Z.lines.vertexCount),a.bindBuffer(a.ARRAY_BUFFER,Z.triangles.positionsBuffer),a.vertexAttribPointer(0,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,Z.triangles.colorsBuffer),a.vertexAttribPointer(1,4,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,Z.triangles.indexBuffer),a.drawArrays(a.TRIANGLES,0,Z.triangles.vertexCount))}}a.disableVertexAttribArray(1),a.disable(a.BLEND);var Q=Object(p.w)(this.startTime,this.startTime+1,Date.now()/1e3);Q<1&&(a.disable(a.DEPTH_TEST),a.enable(a.BLEND),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA),a.useProgram(this.colorProgram.program),a.uniform4f(this.colorProgram.uniformLocations.u_color,0,0,0,1-Q),a.enableVertexAttribArray(0),a.bindBuffer(a.ARRAY_BUFFER,this.triangleVertexBuffer),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0),a.disable(a.BLEND))},e.prototype.getGl=function(){return this.gl},e.prototype.generateBackgroundTexture=function(e,t){var i=this.gl,n=s(i,0,e,i.CLAMP_TO_EDGE,i.CLAMP_TO_EDGE,i.LINEAR,i.LINEAR,!0),o=s(i,0,t,i.CLAMP_TO_EDGE,i.CLAMP_TO_EDGE,i.LINEAR,i.LINEAR,!0),a=r(i,0,i.RGBA,i.UNSIGNED_BYTE,e.width,e.height,null,i.CLAMP_TO_EDGE,i.CLAMP_TO_EDGE,i.LINEAR,i.LINEAR);return this.backgroundTextureResolution=[e.width,e.height],i.bindFramebuffer(i.FRAMEBUFFER,this.framebuffer),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,a,0),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,null),i.viewport(0,0,e.width,e.height),i.useProgram(this.compositeBackgroundProgram.program),i.uniform1i(this.compositeBackgroundProgram.uniformLocations.u_backgroundTexture,0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,n),i.uniform1i(this.compositeBackgroundProgram.uniformLocations.u_maskTexture,1),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,o),i.enableVertexAttribArray(0),i.bindBuffer(i.ARRAY_BUFFER,this.quadVertexBuffer),i.vertexAttribPointer(0,2,i.FLOAT,!1,0,0),i.drawArrays(i.TRIANGLE_STRIP,0,4),i.deleteTexture(n),i.deleteTexture(o),a},e.prototype.popConfetti=function(){if(this.festiveScene.kind===c.NewYears){var e=U({a:0,b:0,c:0,d:0},this.projectionViewMatrix),t=G({a:0,b:0,c:0,d:0},this.projectionViewMatrix),i=(-e.d-1*e.b-3*e.c)/e.a,n=(-t.d-1*t.b-3*t.c)/t.a;this.festiveScene.poppers.push(new re(this.gl,new Float32Array([i,1,3]),f.a.normalize([],[-1,2,0]),this.lastTime)),this.festiveScene.poppers.push(new re(this.gl,new Float32Array([n,1,3]),f.a.normalize([],[1,2,0]),this.lastTime))}},e}(),be=i(11),ve=i(9),ye=i(36),xe=function(){function e(e){this.chunks=[],this.currentChunkIndex=0;var t=ye.RecordedLibrettos.decode(e);!function(e){var t,i,n;for(n=e.length-1;n>0;n--)t=Math.floor(Math.random()*(n+1)),i=e[n],e[n]=e[t],e[t]=i}(t.librettos);for(var i=[],n=0,o=t.librettos;n<o.length;n++)for(var r=0,a=o[n].notes;r<a.length;r++){var s=a[r];if(s.name!==ye.RecordedLibrettos.Phoneme.sil){var l=s.endTimeSeconds-s.startTimeSeconds;i.push({name:s.name,duration:l})}}for(var u=0;u<i.length-1;++u)Object(p.n)(i[u].name)&&!Object(p.n)(i[u+1].name)&&(i[u].duration=.2),Object(p.n)(i[u].name)&&Object(p.n)(i[u+1].name)&&(i[u].duration=.05);for(var c=0;!Object(p.n)(i[c].name)||Object(p.n)(i[c+1].name);)c++;var h=i[c],d=[];do{c+=1,Object(p.n)(i[c].name)&&!Object(p.n)(i[c+1].name)?(this.chunks.push({vowel:h,suffix:d}),h=i[c],d=[]):Object(p.n)(i[c].name)||d.push(i[c])}while(c<i.length-2)}return e.prototype.getNextChunk=function(e){this.currentChunkIndex+=1;var t=this.chunks[this.currentChunkIndex];return t.vowel.name=e,t},e}(),_e=function(){function e(e,t,i){this.frames=[],this.secondsInCurrentFrame=0,this.onFrameUsed=null,this.clock=e,this.timestepSeconds=t,this.delaySeconds=i}return e.prototype.update=function(){if(this.frames.length>=2)for(this.secondsInCurrentFrame+=this.clock.getDeltaTimeS();this.secondsInCurrentFrame>=this.timestepSeconds&&this.frames.length>=2;)this.onFrameUsed&&this.onFrameUsed(this.frames[0].buffer),this.frames.splice(0,1),this.secondsInCurrentFrame-=this.timestepSeconds;else this.secondsInCurrentFrame=this.timestepSeconds-this.delaySeconds},e.prototype.addFrame=function(e){this.frames.push(e)},e.prototype.getCurrentFrame=function(){return this.frames.length>0?this.frames[0]:null},e}(),we=function(){function e(e){this.fromValue=[],this.targetValue=[];for(var t=0;t<e.length;++t)this.fromValue[t]=e[t],this.targetValue[t]=e[t];this.tweenDuration=1,this.tweenStartTime=-99999}return e.prototype.change=function(e,t){if(!Object(p.a)(this.targetValue,e)){this.evaluate(this.fromValue);for(var i=0;i<this.targetValue.length;++i)this.targetValue[i]=e[i];this.tweenDuration=1e3*t,this.tweenStartTime=Date.now()}},e.prototype.evaluate=function(e){if(0===this.tweenDuration)return this.targetValue;for(var t=Object(p.w)(this.tweenStartTime,this.tweenStartTime+this.tweenDuration,Date.now()),i=0;i<this.fromValue.length;++i)e[i]=Object(p.q)(this.fromValue[i],this.targetValue[i],t);return e},e}(),Pe=function(){function e(){this.timeMs=0,this.deltaTimeMs=0}return e.prototype.tick=function(e){this.deltaTimeMs=e,this.timeMs+=e},e.prototype.getTimeMs=function(){return this.timeMs},e.prototype.getTimeS=function(){return this.timeMs/1e3},e.prototype.getDeltaTimeMs=function(){return this.deltaTimeMs},e.prototype.getDeltaTimeS=function(){return this.deltaTimeMs/1e3},e}();function Se(e,t){return(e%t+t)%t}var ke=function(){function e(){this.gradients=[];for(var e=0;e<1024;++e)this.gradients.push(16*Math.random()-8)}return e.prototype.evaluate=function(e){var t=Math.floor(e),i=t+1,n=this.gradients[Se(t,this.gradients.length)],o=this.gradients[Se(i,this.gradients.length)],r=e%1;return.188*Object(p.q)(n*r,o*(r-1),Object(p.v)(0,1,r))},e}(),Ae=[0,1,0];function Te(e,t){for(var i=e._malloc(t.length),n=e.HEAPU8.subarray(i,i+t.length),o=0;o<t.length;++o)n[o]=t[o];return i}var Ee,Me,Re,Be=function(e,t,i){this.module=t,this.pointer=i,this.vertexCount=this.module._rigidMeshGetVertexCount(this.pointer),this.indexCount=this.module._rigidMeshGetIndexCount(this.pointer);var n=this.module.HEAPU16.subarray(this.module._rigidMeshGetIndices(this.pointer)>>1,(this.module._rigidMeshGetIndices(this.pointer)>>1)+this.indexCount);this.indexBuffer=u(e,e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW);var o=this.module.HEAPF32.subarray(this.module._rigidMeshGetPositions(this.pointer)>>2,(this.module._rigidMeshGetPositions(this.pointer)>>2)+3*this.vertexCount);this.positionsBuffer=u(e,e.ARRAY_BUFFER,o,e.STATIC_DRAW);var r=this.module.HEAPF32.subarray(this.module._rigidMeshGetNormals(this.pointer)>>2,(this.module._rigidMeshGetNormals(this.pointer)>>2)+3*this.vertexCount);this.normalsBuffer=u(e,e.ARRAY_BUFFER,r,e.STATIC_DRAW);var a=this.module.HEAPF32.subarray(this.module._rigidMeshGetTangents(this.pointer)>>2,(this.module._rigidMeshGetTangents(this.pointer)>>2)+3*this.vertexCount);this.tangentsBuffer=u(e,e.ARRAY_BUFFER,a,e.STATIC_DRAW);var s=this.module.HEAPF32.subarray(this.module._rigidMeshGetUVs(this.pointer)>>2,(this.module._rigidMeshGetUVs(this.pointer)>>2)+2*this.vertexCount);this.uvsBuffer=u(e,e.ARRAY_BUFFER,s,e.STATIC_DRAW),this.bottomPoint=this.module.HEAPF32.subarray(this.module._rigidMeshGetBottomPoint(this.pointer)>>2,3+(this.module._rigidMeshGetBottomPoint(this.pointer)>>2)).slice(0)},Ce=(Ee=new Float32Array(16),Me=new Float32Array(16),Re=new Float32Array(16),function(e,t,i,n){d.makeScale(Ee,n,n,n),d.fromQuaternion(Me,i),d.makeTranslation(Re,t[0],t[1],t[2]),d.copy(e,Ee),d.premultiply(e,e,Me),d.premultiply(e,e,Re)}),Fe=function(){function e(e,t,i,n,o){this.attachPoint=new Float32Array(3),this.tempMatrix=new Float32Array(16),this.baseModelMatrix=new Float32Array(16),this.inverseBaseModelMatrix=new Float32Array(16),this.modelMatrix=new Float32Array(16),this.frame=0,this.rigidMesh=e,this.uvOffset=new Float32Array([Math.random(),Math.random()]),this.position=new Float32Array([t,i,n]),this.rotation=x.a.fromAxisAngle(new Float32Array(4),Ae,.53),this.worldAttachPoint=new Float32Array([t,0,n]),this.restDistance=i,this.scale=o,this.noise=new ke}return e.prototype.getModelMatrix=function(e,t,i){return d.premultiply(this.modelMatrix,d.makeTranslation(this.tempMatrix,0+e,this.yOffset+t,i),this.baseModelMatrix),this.modelMatrix},e.prototype.update=function(){x.a.fromAxisAngle(this.rotation,Ae,.53+.5*this.noise.evaluate(.001*this.frame));var e=.05*this.noise.evaluate(.001*this.frame+200),t=.05*this.noise.evaluate(.001*this.frame+400);this.position[0]=this.worldAttachPoint[0]+Math.sin(e)*Math.cos(t)*this.restDistance,this.position[1]=this.worldAttachPoint[1]+Math.cos(e)*this.restDistance,this.position[2]=this.worldAttachPoint[2]+Math.sin(e)*Math.sin(t)*this.restDistance,Ce(this.baseModelMatrix,this.position,this.rotation,this.scale),d.invert(this.inverseBaseModelMatrix,this.baseModelMatrix),d.transformPosition(this.attachPoint,this.worldAttachPoint,this.inverseBaseModelMatrix),this.frame+=1},e}(),Le=Object(p.e)(-30),Ie=function(){function e(e,t,i){for(var n in this.rigidMeshes={},this.balloons=[],this.module=t,this.normalMap=i.normalMap,this.environmentMap=i.environmentMap,i.rigidMeshData){var o=i.rigidMeshData[n],r=Te(t,o),a=this.module._createRigidMesh(r,o.length);this.rigidMeshes[n]=new Be(e,t,a)}for(var s=function(e){for(var t=[],i=-2.4*e/2,n=0;n<e;++n){var o=i+1.2,r=[o*Math.cos(Le),3,o*Math.sin(Le)-3];i+=2.4,t.push(r)}return t}(i.year.length),l=0;l<i.year.length;++l){n=i.year.charAt(l);var u=s[l][0],c=s[l][2];this.balloons.push(new Fe(this.rigidMeshes[n],u,4,c,4))}}return e.prototype.step=function(e){for(var t=0,i=this.balloons;t<i.length;t++){var n=i[t];n.yOffset=e,n.update()}},e}(),De=Math.floor(20),je=-3;function Oe(e,t,i){var n=i.getBoundingClientRect();e.x=t.clientX-n.left,e.y=t.clientY-n.top}function ze(e,t){return Math.ceil(e.duration/t)}var Ne=function(){function e(){this.buffersBySize={},this.buffersCreated=0}return e.prototype.getBuffersOfSize=function(e){var t=e.toFixed(0);return t in this.buffersBySize||(this.buffersBySize[t]=[]),this.buffersBySize[t]},e.prototype.allocateBuffers=function(e,t){for(var i=this.getBuffersOfSize(e),n=0;n<t;++n)this.buffersCreated+=1,i.push(new ArrayBuffer(e))},e.prototype.getBuffer=function(e){var t=this.getBuffersOfSize(e),i=null;return t.length>0?i=t.pop():(this.buffersCreated+=1,i=new ArrayBuffer(e)),i},e.prototype.returnBuffer=function(e){this.getBuffersOfSize(e.byteLength).push(e)},e.prototype.returnBuffers=function(e){for(var t=0,i=e;t<i.length;t++){var n=i[t];this.returnBuffer(n)}},e}(),He=function(){function e(e){this.sampleCount=e,this.samples=[]}return e.prototype.add=function(e){this.samples.length===this.sampleCount&&this.samples.splice(0,1),this.samples.push(e)},e.prototype.get=function(){if(0===this.samples.length)return 0;for(var e=0,t=0;t<this.samples.length;++t)e+=this.samples[t];return e/this.samples.length},e.prototype.enoughSamples=function(){return this.samples.length===this.sampleCount},e.prototype.reset=function(){this.samples.length=0},e}(),Ue=function(){function e(e,t,i,n,o,r,a){this.previousChunk={vowel:{name:w.b.a,duration:.2},suffix:[{name:w.b.m,duration:.05}]},this.currentChunk={vowel:{name:w.b.a,duration:.2},suffix:[{name:w.b.m,duration:.05}]},this.frameInCurrentPhoneme=0,this.streamIndex=e,this.singerIndex=a,this.audioParameters=i,this.currentMidiNote=o,this.currentMuted=!0,this.voiceNet=t,this.bufferPool=n,this.epoch=r,this.frameInCurrentPhoneme=ze(this.currentChunk.vowel,this.audioParameters.frameHopSeconds)}return e.prototype.singNote=function(e,t,i,n,o,r,a){var s=this;void 0===r&&(r=.2),void 0===a&&(a=!1);var l=this.audioParameters.frameHopSeconds*o,u=0,c=Math.round(r/l),h=ze(this.currentChunk.vowel,l)-this.frameInCurrentPhoneme-Math.ceil(c/2),d=function(r,a,d,f,m,g,b){for(var v=ze(m,l),y=r;y<a;++y){var x=Object(p.q)(s.currentMidiNote,t,Object(p.o)(h,h+c,u)),_=new be.a(s.bufferPool.getBuffer(be.a.getSizeBytes()));_.setPhoneme(m.name),_.setPreviousPhoneme(f.name),_.setNextPhoneme(g.name),_.setPhonemePosition(y/(v-1)),_.setF0(Object(p.p)(x)),_.setSingerIndex(s.singerIndex),_.setMidiNote(t),_.setMuted(d?s.currentMuted:i),_.setVowel(d?s.currentChunk.vowel.name:e.vowel.name),_.setControlled(n),_.setSubsteps(o),_.setSendTime(Date.now()-s.epoch+u*l*1e3),_.setSkip(b?1:0);for(var w=o,P=[],S=0;S<w;++S){var k=Object(p.q)(s.currentMidiNote,t,Object(p.o)(h*w,(h+c)*w,u*w+S)),A=new ve.a(s.bufferPool.getBuffer(ve.a.getSizeBytes()));A.setPhoneme(m.name),A.setPreviousPhoneme(f.name),A.setNextPhoneme(g.name);var T=(y*w+S)/(v*w-1);A.setPhonemePosition(T),A.setF0(Object(p.p)(k)),A.setSingerIndex(s.singerIndex),A.setMidiNote(t),A.setMuted(d?s.currentMuted:i),A.setVowel(d?s.currentChunk.vowel.name:e.vowel.name),A.setControlled(n),A.setSkip(b?1:0),P.push(A)}s.voiceNet.generate(s.streamIndex,_,P),u+=1}};d(this.frameInCurrentPhoneme,ze(this.currentChunk.vowel,l),!0,this.previousChunk.suffix[this.previousChunk.suffix.length-1],this.currentChunk.vowel,this.currentChunk.suffix[0],!0);for(var f=0;f<this.currentChunk.suffix.length;++f){var m=this.currentChunk.suffix[f];d(0,ze(m,l),!1,0===f?this.currentChunk.vowel:this.currentChunk.suffix[f-1],m,f===this.currentChunk.suffix.length-1?e.vowel:this.currentChunk.suffix[f+1],!1)}var g=ze(e.vowel,l),b=Math.floor(g*(e.vowel.name===w.b.sil?.9:.3));d(0,b,!1,this.currentChunk.suffix[this.currentChunk.suffix.length-1],e.vowel,e.suffix[0],!1),this.frameInCurrentPhoneme=b,this.previousChunk=this.currentChunk,this.currentChunk=e,this.currentMidiNote=t,this.currentMuted=i},e}(),Ge=[[60,88],[60,83],[45,72],[36,66]];function We(e,t){for(var i=0;i<4;++i)if(!(t<Ge[i][0]||t>Ge[i][1])&&t>e[i])return i;return t>=Ge[3][0]&&t<=Ge[3][1]?3:-1}var Ve=[w.b.n,w.b.r,w.b.l,w.b.t,w.b.s,w.b.d,w.b.m,w.b.p,w.b.v,w.b.c,w.b.ch,w.b.f,w.b.j,w.b.b,w.b.qu,w.b.h,w.b.g];function Ye(){return Ve[Math.floor(Math.random()*Ve.length)]}var qe=[w.b.u,w.b.o,w.b.i,w.b.e,w.b.a];function Ke(e){var t=Math.floor(e/20);return qe[Object(p.b)(t,0,qe.length-1)]}var Xe,Je=function(){function e(e,t){this.lastActiveNotes=[],this.activeNotes=[],this.singingNotes=[{pitch:0,vowel:w.b.a},{pitch:0,vowel:w.b.a},{pitch:0,vowel:w.b.a},{pitch:0,vowel:w.b.a}],this.singers=e,this.opera=t}return e.prototype.onNote=function(e){var t=this,i=e.pitch,n=e.velocity;n>0?this.activeNotes.push({pitch:i,vowel:Ke(n)}):0===n&&(this.activeNotes=this.activeNotes.filter((function(e){return e.pitch!==i}))),this.activeNotes=this.activeNotes.sort((function(e,t){return t.pitch-e.pitch})),proxiesWindow.clearTimeout(this.timeout),this.timeout=proxiesWindow.setTimeout((function(){for(var e=[],i=[],n=function(i){t.activeNotes.find((function(e){return e.pitch===t.lastActiveNotes[i].pitch}))||e.push(t.lastActiveNotes[i])},o=0;o<t.lastActiveNotes.length;++o)n(o);var r=function(e){t.lastActiveNotes.find((function(i){return i.pitch===t.activeNotes[e].pitch}))||i.push(t.activeNotes[e])};for(o=0;o<t.activeNotes.length;++o)r(o);for(var a=t.singingNotes.map((function(e){return{pitch:e.pitch,vowel:e.vowel}})),s=0,l=e;s<l.length;s++){var u=l[s];for(o=0;o<4;++o)if(a[o].pitch===u.pitch){a[o].pitch=0;break}}for(var c=0,h=i;c<h.length;c++){u=h[c];var d=We(a.map((function(e){return e.pitch})),u.pitch);d>-1&&(a[d]=u)}var f=t.opera.clock.getTimeMs();for(o=0;o<4;++o)if(a[o].pitch!==t.singingNotes[o].pitch)if(0===a[o].pitch){var p={vowel:{name:w.b.sil,duration:0},suffix:[{name:Ye(),duration:.05}]};t.singers[o].singNote(p,t.singingNotes[o].pitch,!0,!1,1,.1,!0),t.opera.addNoteToRecording(o,f,t.singingNotes[o].pitch,p,!1)}else p={vowel:{name:a[o].vowel,duration:.1},suffix:[{name:Ye(),duration:.05}]},t.singers[o].singNote(p,a[o].pitch,!1,!1,1,.1,!0),t.opera.addNoteToRecording(o,f,a[o].pitch,p,!1);t.singingNotes=a,t.lastActiveNotes=t.activeNotes.slice(0)}),50)},e}(),Ze=(function(){function e(e){this.desiredNote=null,this.singingNote={pitch:0,vowel:w.b.a},this.singer=e}e.prototype.onNote=function(e){var t=e.pitch,i=e.velocity;if(i>0?this.desiredNote={pitch:t,vowel:Ke(i)}:0===i&&this.desiredNote&&this.desiredNote.pitch===t&&(this.desiredNote={pitch:0,vowel:w.b.a}),this.desiredNote.pitch!==this.singingNote.pitch)if(0===this.desiredNote.pitch){var n={vowel:{name:w.b.sil,duration:0},suffix:[{name:Ye(),duration:.05}]};this.singer.singNote(n,this.singingNote.pitch,!0,!1,1,.1,!0)}else n={vowel:{name:this.desiredNote.vowel,duration:.1},suffix:[{name:Ye(),duration:.05}]},this.singer.singNote(n,this.desiredNote.pitch,!1,!1,1,.1,!0);this.singingNote=this.desiredNote}}(),function(){function e(e){var t=this;this.mapper=e;try{proxiesWindow.navigator.requestMIDIAccess&&proxiesWindow.navigator.requestMIDIAccess().then((function(e){e.inputs.forEach((function(e){e.onmidimessage=t.onMidiMessage.bind(t)}))})).catch((function(e){}))}catch(e){}}return e.prototype.onMidiMessage=function(e){if(!(e.data[0]>=240)){var t=e.data[0]>>4,i=15&e.data[0],n=0,o=0;if(9===t)n=e.data[1],o=e.data[2];else{if(8!==t)return;n=e.data[1],o=0}this.mapper.onNote({pitch:n,velocity:o,channel:i})}},e}());function Qe(e){for(var t=[0,0,0],i=0,n=e;i<n.length;i++){var o=n[i];f.a.add(t,t,o)}return f.a.multiplyByScalar(t,t,1/e.length),t}function $e(e){for(var t=0;t<e.length;++t)e[t]*=.85;for(var i=0,n=0,o=e;n<o.length;n++)i+=o[n];var r=[],a=-i/2;for(t=0;t<4;++t){var s=a+e[t]/2,l=[s*Math.cos(nt),0,s*Math.sin(nt)];a+=e[t],r.push(l)}return r}function et(e){for(var t=[],i=0;i<4;++i){var n=Qe(e.slice(i)),o=Object(p.o)(0,3,i),r=.8*Object(p.q)(19.5,15,o),a=Object(p.q)(4.25,3.25,o)-.6;t.push(f.a.add([],n,[0,a,r]))}return t}!function(e){e[e.Main=0]="Main",e[e.Playing=1]="Playing"}(Xe||(Xe={}));var tt,it=["c","c#","d","d#","e","f","f#","g","g#","a","a#","b"],nt=Object(p.e)(-30),ot=[0,0,2.5],rt=nt+Math.PI/2,at=[Math.cos(rt),0,Math.sin(rt)],st=[0,.7,0],lt=[[1,1,1,1],[1,1,2,3],[2,2,3,4],[2,3,6,5]],ut=function(){function e(e,t,i,n,o,r,a,s,l,u,h,g,b,v,y,x,_){var w=this;this.stateChangeListeners=[],this.singers=[],this.blobs=[],this.state=Xe.Main,this.isRecording=!1,this.currentRecording=null,this.recordingStartTime=0,this.playing=!1,this.playingRecording=null,this.playbackStartTime=0,this.mouseX=.5,this.mouseY=.5,this.firstNoteTime=0,this.cameraPositionCache=[0,0,0],this.rendererPadding=new m.a(0,(function(e){return Object(p.v)(0,1,e)})),this.prompts=[],this.lastSungNote={midiPitch:0,vowel:null},this.blobController=null,this.lastControlledIndex=-1,this.tutorialState={kind:"Pitch",pitchesChanged:0,notesSung:0},this.personIndicators=[],this.suspended=!0,this.requestedFrame=-1,this.showingPrompts=!0,this.viewMatrix=new Float32Array(16),this.onTutorialFinished=null,this.onBlobInteraction=null,this.pitchPrompt={element:proxiesWindow.document.getElementById("pitch-prompt"),text:"",visible:!1,sounding:!1},this.vowelPrompt={element:proxiesWindow.document.getElementById("vowel-prompt"),text:"",visible:!1,sounding:!1},this.epoch=Date.now(),this.averageGenerationTime=new He(200),this.lastConfettiPopTime=-9999999,this.worldRayDirection=[0,0,0,0],this.pos={x:0,y:0},this.lookPosition=[0,0,0],this.tempScreenPosition=[0,0,0,0],this.config=e,this.blobModule=n,this.qualitySettings=g,this.eyeBuffer=y,this.eyeBufferIsJSON=x,this.substepLevel=b,this.substeps=lt[this.substepLevel],this.disableUI=e.disableUI,this.clock=new Pe,this.frameHopSeconds=h,this.festiveTheme=u.festiveTheme,this.festiveEnabled=!1,"Recording"===u.kind&&u.recording.theme!==c.Normal&&(this.festiveEnabled=!0),this.festiveParticlesSpawnRate=new m.a(0),this.festiveParticleTransitionT=new m.a(0,(function(e){return Object(p.w)(0,1,e)})),this.balloonsOffset=new m.a(1,(function(e){return Object(p.w)(0,1,e)})),this.canvas=t,this.harmonizer=o,this.voiceNet=r,this.voiceNet.setParameters(a.synthRunner.audioParameters),this.audio=a,this.audio.synthRunner.onFrameUsed=function(e){w.bufferPool.returnBuffer(e)},"Recording"===u.kind&&this.audio.synthRunner.setPans(this.audio.synthRunner.audioParameters.pans[0]),this.libretto=new xe(s),this.bufferPool=new Ne,this.bufferPool.allocateBuffers(ve.a.getSizeBytes(),1e3),this.bufferPool.allocateBuffers(be.a.getSizeBytes(),1e3);var P=$e(v.blobs.map((function(e){return e.width})));if("relative"===e.positioningMode)this.cameraPositions=et(P);else{this.cameraPositions=[];for(var S=0;S<4;++S)this.cameraPositions.push(f.a.mix([],v.endCameraPosition,v.startCameraPosition,S/3))}var k=d.makeTranslation(new Float32Array(16),-this.cameraPositions[0][0],-this.cameraPositions[0][1],-this.cameraPositions[0][2]);this.renderer=new ge(this.canvas,i,l.environmentAssets.backgroundImage,l.environmentAssets.backgroundMaskImage,v.startCameraPosition,k,e.cameraFOVDegrees,v.blobs.map((function(e){return Object(p.i)(e.subsurfaceColor)})),this.festiveTheme===c.NewYears?{theme:c.NewYears,balloons:new Ie(i,n,_)}:{theme:this.festiveTheme});var A=function(t){var i=v.blobs[t],o="relative"===e.positioningMode,r=v.name===T.config.scenes[0].name?T.festiveTheme:c.Normal,s=new z(T.renderer.gl,n,y,T.eyeBufferIsJSON,l.blobAssets[t],a.synthRunner.audioParameters.voiceTypes[a.synthRunner.audioParameters.singers[i.singerIndex].voiceType].scale,g.blobSubdivisions,v.blobs[t],P[t],o,r),u=new _e(T.clock,a.synthRunner.audioParameters.frameHopSeconds,a.synthRunner.audioParameters.scriptProcessorBufferSize/a.sampleRate);u.onFrameUsed=function(e){w.bufferPool.returnBuffer(e)};var h=proxiesWindow.document.createElement("div");h.classList.add("silence-button"),h.classList.add("hideable-clickable"),h.innerHTML='<svg width="100%" height="100%" viewBox="-10 -10 70 70" xmlns="http://www.w3.org/2000/svg"> <mask id="silence-line-$MASK" width="200%"> <rect x="-10" y="-10" width="160" height="100" fill="white"></rect> <use class="silence-line" xlink:href="#silence-line" stroke="black" stroke-width="6"></use> </mask> <use class="silence-line" xlink:href="#silence-line" stroke="white" stroke-width="4"></use> <use mask="url(#silence-line-$MASK)" xlink:href="#silence-icon"></use> </svg>'.replace(/\$MASK/g,"mask-"+t.toFixed(0)),proxiesWindow.document.body.appendChild(h);var d=function(e){e.preventDefault(),w.blobs[t].silenced?w.blobs[t].silenced=!1:(w.sendSilence(t),w.blobs[t].silenced=!0)};h.addEventListener("click",d),h.addEventListener("touchstart",d);var f={element:h,visible:!0,silenced:!1,hideTime:0};T.blobs.push({blob:s,frameTracker:u,silenceButton:f,silenceWorldPosition:[0,0,0],silenced:!1,lastSentF0:440,harmonizationTimeout:"Empty",playbackIndex:0,oldBlob:null,overrideLookPosition:[0,0,0]})},T=this;for(S=0;S<v.blobs.length;++S)A(S);if(this.festiveEnabled)for(var E=0,M=this.blobs;E<M.length;E++)M[E].blob.hatOffset.change(0,0);t.addEventListener("mousedown",this.onMouseDown.bind(this)),t.addEventListener("mousemove",this.onMouseMove.bind(this)),proxiesWindow.addEventListener("mouseup",this.onMouseUp.bind(this)),t.addEventListener("touchstart",this.onTouchStart.bind(this)),t.addEventListener("touchmove",this.onTouchMove.bind(this)),t.addEventListener("touchend",this.onTouchEnd.bind(this)),t.addEventListener("touchcancel",this.onTouchCancel.bind(this));var R=function(e){r.addListener(e,(function(t,i){var n=Date.now()-w.epoch-t.getSendTime();n/=t.getSubsteps(),w.averageGenerationTime.add(n),w.averageGenerationTime.enoughSamples()&&(w.averageGenerationTime.get()>30?(w.substepLevel+=1,w.substepLevel=Math.min(w.substepLevel,3),w.substeps=lt[w.substepLevel],w.averageGenerationTime.reset()):w.averageGenerationTime.get()<0&&(w.substepLevel-=1,w.substepLevel=Math.max(w.substepLevel,0),w.substeps=lt[w.substepLevel],w.averageGenerationTime.reset())),w.onGeneratedFrame(e,t,i)}))};for(S=0;S<this.blobs.length;++S)R(S);for(S=0;S<this.blobs.length;++S){var B=this.audio.synthRunner.audioParameters,C=B.voiceTypes[B.singers[this.blobs[S].blob.config.singerIndex].voiceType].scale[3];this.singers.push(new Ue(S,r,this.audio.synthRunner.audioParameters,this.bufferPool,C,this.epoch,this.blobs[S].blob.config.singerIndex))}if(this.audio.start(),this.prompts=[proxiesWindow.document.getElementById("soprano-prompt"),proxiesWindow.document.getElementById("alto-prompt"),proxiesWindow.document.getElementById("tenor-prompt"),proxiesWindow.document.getElementById("bass-prompt")],"Default"===u.kind)this.rendererPadding=new m.a(0,(function(e){return Object(p.w)(0,1,e)})),this.cameraPosition=new we(this.cameraPositions[0]),e.disableDrop||this.blobs[3].blob.startFalling(0),this.state=Xe.Main;else if("Recording"===u.kind){for(this.state=Xe.Playing,this.cameraPosition=new we(this.cameraPositions[0]),this.rendererPadding=new m.a(0,(function(e){return Object(p.w)(0,1,e)})),this.playingRecording=u.recording,this.currentRecording=null,this.playing=!1,S=0;S<this.blobs.length;++S)this.blobs[S].blob.startFalling(10*S);this.startPlayback(2)}proxiesWindow.document.addEventListener("keypress",(function(e){"u"===e.key||"U"===e.key?w.disableUI=!w.disableUI:" "===e.key&&w.togglePlayback();for(var t=0;t<4;++t)e.key===(t+1).toFixed(0)&&(w.blobs[t].silenced?w.blobs[t].silenced=!1:(w.sendSilence(t),w.blobs[t].silenced=!0))}));var F=new Je(this.singers,this);this.midiController=new Ze(F),this.resume(),e.skipTutorial&&this.skipTutorial(10)}return e.prototype.onMouseDown=function(e){Oe(this.pos,e,this.canvas),this.mouseX=this.pos.x/this.canvas.width,this.mouseY=1-this.pos.y/this.canvas.height;var t=this.renderer.cameraPosition,i=this.renderer.getWorldRayDirection(this.worldRayDirection,2*this.mouseX-1,2*this.mouseY-1);if(!this.blobController)for(var n=0;n<this.blobs.length;++n){var o=D(this.blobs[n].blob,t,i);if(o){"Finished"===this.tutorialState.kind&&(this.tutorialState.hasInteracted=!0),o.draggingRestPosition[1]-=.2,this.blobController=new O(this.blobs[n].blob,o.draggingRestPosition),this.onBlobInteraction&&this.onBlobInteraction(n);break}}this.audio.tryUnlock()},e.prototype.onMouseMove=function(e){Oe(this.pos,e,this.canvas),this.mouseX=this.pos.x/this.canvas.width,this.mouseY=1-this.pos.y/this.canvas.height},e.prototype.onMouseUp=function(){this.blobController&&(this.blobController=null)},e.prototype.onTouchStart=function(e){e.preventDefault(),1===e.touches.length&&this.onMouseDown(e.targetTouches[0])},e.prototype.onTouchMove=function(e){e.preventDefault(),this.onMouseMove(e.targetTouches[0])},e.prototype.onTouchEnd=function(e){e.preventDefault(),e.touches.length>0||this.onMouseUp()},e.prototype.onTouchCancel=function(e){e.preventDefault(),e.touches.length>0||this.onMouseUp()},e.prototype.positionElementWorld=function(e,t,i,n){var o=this.renderer.getScreenPosition(this.tempScreenPosition,t),r=this.canvas.width*(.5*o[0]+.5),a=this.canvas.height*(1-(.5*o[1]+.5)),s="translate("+r.toFixed(0)+"px, "+a.toFixed(0)+"px) ";"left"===i?s+="translate(0, ":"right"===i?s+="translate(-100%, ":"center"===i&&(s+="translate(-50%, "),"bottom"===n?s+="-100%)":"center"===n?s+="-50%)":"top"===n&&(s+="0)"),e.style.transform=s},e.prototype.update=function(e){var t=this;this.clock.tick(e);for(var i=0,n=this.blobs;i<n.length;i++)(s=n[i]).frameTracker.update();var o=this.renderer.cameraPosition,r=this.renderer.getWorldRayDirection(this.worldRayDirection,2*this.mouseX-1,2*this.mouseY-1);this.blobController&&this.blobController.step(o,r),Object(p.k)(this.lookPosition,ot,at,o,r);for(var a=0;a<this.blobs.length;++a){var s=this.blobs[a].blob;this.festiveTheme===c.Christmas&&0===s.hatOffset.targetValue&&s.hatOffset.evaluate()>0&&s.hatOffset.evaluate()<1?(s.lookPosition[0]=s.modelMatrix[12],s.lookPosition[1]=s.modelMatrix[13]+15,s.lookPosition[2]=s.modelMatrix[14]+5):Date.now()-this.lastConfettiPopTime<3e3?this.blobs[a].blob.lookPosition=this.blobs[a].overrideLookPosition:this.blobs[a].blob.lookPosition=this.lookPosition}for(a=0;a<this.blobs.length;++a)this.blobs[a].silenced?(this.blobs[a].blob.eyeTopOpenness.change(0,.3),this.blobs[a].blob.eyeBottomOpenness.change(0,.3)):(this.blobs[a].blob.eyeTopOpenness.change(1,.3),this.blobs[a].blob.eyeBottomOpenness.change(0,.3));for(a=0;a<this.blobs.length;++a){var l=this.blobs[a].frameTracker.getCurrentFrame(),u=[];if(this.blobController&&this.blobs[a].blob===this.blobController.blob&&u.push({yScale:this.blobController.yScale,zOffset:this.blobController.zOffset,isSelf:!0}),this.blobs[a].blob.step(u,l||null),null!==this.blobs[a].oldBlob){var h=this.blobs[a].oldBlob;h.canDestroy()?(h.destroy(),this.blobs[a].oldBlob=null):this.blobs[a].oldBlob.step(u,l||null)}}for(a=0;a<this.blobs.length;++a)this.blobs[a].blob.isDragging?(this.blobs[a].silenced=!1,this.audio.synthRunner.setOverrideFrequency(a,!0),this.audio.synthRunner.addOverrideF0(a,Object(p.p)(this.blobs[a].blob.liveMidiNote.evaluate()+je))):this.audio.synthRunner.setOverrideFrequency(a,!1);if(null!==this.blobController){var m=this.blobController.blob,g=this.blobs.findIndex((function(e){return e.blob===m}));this.lastControlledIndex=g;var b=0===this.lastSungNote.midiPitch,v=b?.05:.2;if(!R(this.lastSungNote,m.currentPitchVowel)&&m.getTimeOnCurrentNote()>v&&this.voiceNet.framesBeingGenerated<De){var y=this.clock.getTimeMs();if(this.state===Xe.Main)if("Pitch"===this.tutorialState.kind)this.tutorialState.notesSung+=1,m.currentPitchVowel.midiPitch!==this.lastSungNote.midiPitch&&(this.tutorialState.pitchesChanged+=1,4===this.tutorialState.pitchesChanged&&this.blobs[2].blob.startFalling(0));else if("Vowel"===this.tutorialState.kind&&2===g)this.tutorialState.notesSung+=1,m.currentPitchVowel.vowel!==this.lastSungNote.vowel&&(this.tutorialState.vowelsChanged+=1,3===this.tutorialState.vowelsChanged&&this.blobs[1].blob.startFalling(0));else if("Harmonization"===this.tutorialState.kind&&1===g){if(this.tutorialState.notesSung+=1,2===this.tutorialState.notesSung){var x=0;for(a=this.getUnlockedVoiceIndex()-1;a>=0;a-=1)this.blobs[a].blob.startFalling(x),x+=10;for(a=4;a<this.blobs.length;++a)this.blobs[a].blob.startFalling(x),x+=10}}else"Mute"===this.tutorialState.kind&&0===g&&(this.tutorialState.notesSung+=1);b&&(this.firstNoteTime=y),g<4&&this.audio.synthRunner.setPans(this.audio.synthRunner.audioParameters.pans[g]);var _=this.audio.synthRunner.audioParameters.singers[this.blobs[g].blob.config.singerIndex].voiceType,P=m.currentPitchVowel;this.lastSungNote=P;var S=this.libretto.getNextChunk(P.vowel);if(this.singers[g].singNote(S,P.midiPitch+je,!1,!1,this.substeps[g]),this.addNoteToRecording(g,y,P.midiPitch+je,S,!0),this.state===Xe.Main){var k=P.midiPitch;2!==_&&3!==_||(k+=12),this.harmonizer.harmonize(k).then((function(e){e[_].midiNote=P.midiPitch;for(var i=function(i){for(var n=200*(i-_),o=t.firstNoteTime+n,r=function(r){var a=t.blobs[r];t.audio.synthRunner.audioParameters.singers[a.blob.config.singerIndex].voiceType===i&&r!==g&&("Fired"!==a.harmonizationTimeout?("Empty"!==a.harmonizationTimeout&&proxiesWindow.clearTimeout(t.blobs[i].harmonizationTimeout),a.harmonizationTimeout=proxiesWindow.setTimeout((function(){var o=t.singers[g].previousChunk;if(!Object(p.a)(o.suffix.map((function(e){return e.name})),t.singers[r].currentChunk.suffix.map((function(e){return e.name})))){var s={vowel:{name:w.b.sil,duration:o.vowel.duration},suffix:o.suffix};t.singers[r].singNote(s,t.singers[r].currentMidiNote,!0,!1,1)}t.singers[r].singNote(t.singers[g].currentChunk,e[i].midiNote+je,!1,!1,t.substeps[i]),t.addNoteToRecording(r,y+n,e[i].midiNote+je,t.singers[r].currentChunk,!1),a.harmonizationTimeout="Fired"}),o-t.clock.getTimeMs())):"Fired"===t.blobs[r].harmonizationTimeout&&(t.singers[r].singNote(S,e[i].midiNote+je,!1,!1,t.substeps[i]),t.addNoteToRecording(r,y,e[i].midiNote+je,S,!1)))},a=0;a<t.blobs.length;++a)r(a)},n=_;n<4;++n)i(n)}))}}}if(null===this.blobController&&0!==this.lastSungNote.midiPitch){var A=this.libretto.getNextChunk(w.b.sil),T=this.clock.getTimeMs();if(this.state===Xe.Main)for(a=0;a<this.blobs.length;++a)this.singers[a].currentMuted||(this.singers[a].singNote(A,this.singers[a].currentMidiNote,!0,!1,this.substeps[a]),this.addNoteToRecording(a,T,this.singers[a].currentMidiNote,A,!1));else if(this.state===Xe.Playing){var M=this.lastControlledIndex;-1!==M&&(this.singers[M].currentMuted||this.singers[M].singNote(A,this.singers[M].currentMidiNote,!0,!1,this.substeps[M]))}for(a=0;a<this.blobs.length;++a)"Empty"!==this.blobs[a].harmonizationTimeout&&"Fired"!==this.blobs[a].harmonizationTimeout&&proxiesWindow.clearTimeout(this.blobs[a].harmonizationTimeout),this.blobs[a].harmonizationTimeout="Empty";this.lastSungNote={midiPitch:0,vowel:null},this.lastControlledIndex=-1}if(this.state===Xe.Playing&&this.playing){var B=Math.max(0,(this.clock.getTimeMs()-this.playbackStartTime)/1e3);for(a=0;a<this.blobs.length;++a)for(var C=this.playingRecording.parts[a].notes;this.blobs[a].playbackIndex<C.length&&C[this.blobs[a].playbackIndex].timeSeconds<B;){var F=C[this.blobs[a].playbackIndex],L=F.librettoChunk.vowel.duration<=.11;this.blobs[a].blob.isDragging||this.singers[a].singNote(F.librettoChunk,F.midiPitch,F.librettoChunk.vowel.name===w.b.sil,F.controlled,this.substeps[a],L?.1:.2),this.blobs[a].playbackIndex+=1}(function(e,t){for(var i=0;i<t.length;++i)if(t[i]<e.parts[i].notes.length)return!1;return!0})(this.playingRecording,this.blobs.map((function(e){return e.playbackIndex})))&&this.startPlayback(1)}for(var I=!1,D=0,j=this.blobs;D<j.length;D++)(s=j[D]).blob.isDragging&&(I=!0);for(var O=0,z=this.blobs;O<z.length;O++)(s=z[O]).blob.overrideHipnotized=!this.playing&&!s.blob.isDragging&&s.blob.isSinging&&I,s.oldBlob&&(s.oldBlob.overrideHipnotized=!1);if("Finished"===this.tutorialState.kind)for(a=0;a<4;++a)this.prompts[a].classList.remove("visible");else for(a=0;a<4;++a){s=this.blobs[a].blob;var N=d.transformPosition([],f.a.add([],s.getMouthCentroid(),[-.3,0,0]),s.modelMatrix);if(this.positionElementWorld(this.prompts[a],N,"right","center"),this.blobs[a].blob.state!==E.Falling){var H=!1;3===a?H="Pitch"===this.tutorialState.kind:2===a?H="Vowel"===this.tutorialState.kind:1===a?H="Harmonization"===this.tutorialState.kind:0===a&&(H="Mute"===this.tutorialState.kind),H&&this.state===Xe.Main&&this.showingPrompts&&!this.disableUI?this.prompts[a].classList.add("visible"):this.prompts[a].classList.remove("visible")}}for(a=0;a<this.blobs.length;++a){var U=this.state===Xe.Main&&"Mute"===this.tutorialState.kind&&this.tutorialState.notesSung>0||"Finished"===this.tutorialState.kind||this.state===Xe.Playing,G=this.blobs[a].silenceButton;!U||this.isDraggingBlob()&&"Mute"!==this.tutorialState.kind||!this.showingPrompts||this.disableUI?G.visible&&(G.element.classList.remove("visible"),G.visible=!1):G.visible||(G.element.classList.add("visible"),G.visible=!0),this.blobs[a].silenced?G.silenced||(G.element.classList.add("silenced"),G.silenced=!0):G.silenced&&(G.element.classList.remove("silenced"),G.silenced=!1,G.hideTime=Date.now()),G.visible&&(f.a.add(this.blobs[a].silenceWorldPosition,this.blobs[a].blob.getTopPosition(),st),d.transformPosition(this.blobs[a].silenceWorldPosition,this.blobs[a].silenceWorldPosition,this.blobs[a].blob.modelMatrix),this.positionElementWorld(this.blobs[a].silenceButton.element,this.blobs[a].silenceWorldPosition,"left","bottom"))}if(this.rendererPadding.change(this.state===Xe.Playing?60:0,1),this.renderer.paddingHeight=Math.round(this.rendererPadding.evaluate()),"Pitch"===this.tutorialState.kind&&this.state===Xe.Main&&null!==this.blobController&&this.showingPrompts){this.pitchPrompt.visible||(this.pitchPrompt.element.classList.add("visible"),this.pitchPrompt.visible=!0),s=this.blobController.blob;var W=d.transformPosition([],[.3,s.pitchUI.indicatorY.evaluate(),0],s.pitchUI.getModelMatrix()),V=it[(s.pitchUI.currentDraggedValue+je)%12].toUpperCase();this.pitchPrompt.text!==V&&(proxiesWindow.document.getElementById("pitch-prompt-pitch").innerText=V,this.pitchPrompt.text=V),this.positionElementWorld(this.pitchPrompt.element,W,"left","center"),s.pitchUI.currentSoundedValue===s.pitchUI.currentDraggedValue?this.pitchPrompt.sounding||(proxiesWindow.document.getElementById("pitch-prompt-pitch").classList.add("sounding"),this.pitchPrompt.sounding=!0):this.pitchPrompt.sounding&&(proxiesWindow.document.getElementById("pitch-prompt-pitch").classList.remove("sounding"),this.pitchPrompt.sounding=!1)}else this.pitchPrompt.visible&&(this.pitchPrompt.element.classList.remove("visible"),this.pitchPrompt.visible=!1);if("Vowel"===this.tutorialState.kind&&this.state===Xe.Main&&null!==this.blobController&&2===this.blobs.findIndex((function(e){return e.blob===t.blobController.blob}))&&this.showingPrompts){this.vowelPrompt.visible||(this.vowelPrompt.element.classList.add("visible"),this.vowelPrompt.visible=!0),s=this.blobController.blob,W=d.transformPosition([],[-.2,s.vowelUI.indicatorY.evaluate(),0],s.vowelUI.getModelMatrix());var Y=Object(w.c)(s.vowelUI.currentDraggedValue);this.vowelPrompt.text!==Y&&(proxiesWindow.document.getElementById("vowel-prompt-vowel").innerText=Object(w.c)(s.vowelUI.currentDraggedValue),this.vowelPrompt.text=Y),this.positionElementWorld(this.vowelPrompt.element,W,"center","bottom"),s.vowelUI.currentSoundedValue===s.vowelUI.currentDraggedValue?this.vowelPrompt.sounding||(proxiesWindow.document.getElementById("vowel-prompt-vowel").classList.add("sounding"),this.vowelPrompt.sounding=!0):this.vowelPrompt.sounding&&(proxiesWindow.document.getElementById("vowel-prompt-vowel").classList.remove("sounding"),this.vowelPrompt.sounding=!1)}else this.vowelPrompt.visible&&(this.vowelPrompt.element.classList.remove("visible"),this.vowelPrompt.visible=!1);for(this.state!==Xe.Main||this.isDraggingBlob()||(this.cameraPosition.change(this.cameraPositions[this.getUnlockedVoiceIndex()],1.5),"Finished"!==this.tutorialState.kind&&("Pitch"===this.tutorialState.kind&&this.tutorialState.pitchesChanged>=4?this.tutorialState={kind:"Vowel",vowelsChanged:0,notesSung:0}:"Vowel"===this.tutorialState.kind&&this.tutorialState.vowelsChanged>=3?this.tutorialState={kind:"Harmonization",notesHarmonized:0,notesSung:0}:"Harmonization"===this.tutorialState.kind&&this.tutorialState.notesSung>=2?this.tutorialState={kind:"Mute",notesSung:0}:"Mute"===this.tutorialState.kind&&this.tutorialState.notesSung>0&&(this.tutorialState={kind:"Finished",hasInteracted:!1},this.audio.samplePlayer.play("applause"),this.onTutorialFinished&&this.onTutorialFinished()))),a=0;a<this.blobs.length;++a)this.state===Xe.Main&&("Pitch"===this.tutorialState.kind||"Vowel"===this.tutorialState.kind&&a===this.blobs.length-1)?this.blobs[a].blob.vowelUI.overrideAlpha.change(0,.5,.5):this.blobs[a].blob.vowelUI.overrideAlpha.change(1,.5,.5),this.state===Xe.Main&&"Vowel"===this.tutorialState.kind&&a!==this.blobs.length-1?(2===a&&this.blobs[a].blob.vowelUI.yOffset.change(2.7,0),this.blobs[a].blob.pitchUI.overrideAlpha.change(0,.5)):(a>=2&&this.blobs[a].blob.vowelUI.yOffset.change(0,1,0),this.blobs[a].blob.pitchUI.overrideAlpha.change(1,.5)),this.disableUI&&(this.blobs[a].blob.vowelUI.overrideAlpha.change(0,0),this.blobs[a].blob.pitchUI.overrideAlpha.change(0,0));this.cameraPosition.evaluate(this.cameraPositionCache),this.renderer.setViewMatrix(d.makeTranslation(this.viewMatrix,-this.cameraPositionCache[0],-this.cameraPositionCache[1],-this.cameraPositionCache[2])),this.festiveEnabled?this.festiveParticlesSpawnRate.change(600,1):this.festiveParticlesSpawnRate.change(0,1),this.renderer.festiveParticleSpawnRate=this.festiveParticlesSpawnRate.evaluate(),this.renderer.festiveParticleTransitionT=this.festiveParticleTransitionT.evaluate(),this.festiveTheme===c.NewYears&&(this.festiveEnabled?this.balloonsOffset.change(0,3):this.balloonsOffset.change(1,3),this.renderer.balloonsYOffset=this.balloonsOffset.evaluate());var q=[];for(a=0;a<this.blobs.length;++a)q.push(this.blobs[a].blob),null!==this.blobs[a].oldBlob&&q.push(this.blobs[a].oldBlob);this.renderer.render(q)},e.prototype.addNoteToRecording=function(e,t,i,n,o){this.isRecording&&this.currentRecording.parts[e].notes.push({timeSeconds:(t-this.recordingStartTime)/1e3,librettoChunk:n,midiPitch:i,controlled:o})},e.prototype.onGeneratedFrame=function(e,t,i){if(this.blobs[e].lastSentF0=t.getF0(),1!==t.getSkip()){if(!this.blobs[e].silenced)for(o=0;o<i.length;++o){var n=this.bufferPool.getBuffer(ve.a.getSizeBytes());Object(p.d)(i[o].buffer,n),this.blobs[e].frameTracker.addFrame(new ve.a(n))}if(!this.blobs[e].silenced&&!this.audio.isMuted())for(this.audio.synthRunner.addSpectralFrame(e,t),o=0;o<i.length;++o)this.audio.synthRunner.addExcitationFrame(e,i[o])}else{this.bufferPool.returnBuffer(t.buffer);for(var o=0;o<i.length;++o)this.bufferPool.returnBuffer(i[o].buffer)}},e.prototype.sendSilence=function(e){for(var t=this,i=new be.a(this.bufferPool.getBuffer(be.a.getSizeBytes())),n=i.getSpectral(),o=0;o<60;++o)n[o]=-120;var r=function(i){i.setMuted(!0),i.setF0(t.blobs[e].lastSentF0),i.setMidiNote(Object(p.g)(t.blobs[e].lastSentF0)),i.setPhoneme(w.b.sil),i.setNextPhoneme(w.b.sil),i.setVowel(w.b.sil),i.setSingerIndex(t.blobs[e].blob.config.singerIndex),i.setPreviousPhoneme(w.b.sil),i.setPhonemePosition(0),i.setSkip(0)};r(i),i.setSubsteps(this.substeps[e]),i.setSendTime(Date.now()-this.epoch);var a=[];for(o=0;o<1;++o){var s=new ve.a(this.bufferPool.getBuffer(ve.a.getSizeBytes()));r(s);for(var l=s.getAperiodic(),u=0;u<4;++u)l[u]=-120;a.push(s)}this.onGeneratedFrame(e,i,a)},e.prototype.addStateChangeListener=function(e){this.stateChangeListeners.push(e)},e.prototype.fireStateChangeListeners=function(){for(var e=0,t=this.stateChangeListeners;e<t.length;e++)(0,t[e])(this.state)},e.prototype.getUnlockedVoiceIndex=function(){return"Pitch"===this.tutorialState.kind?3:"Vowel"===this.tutorialState.kind?2:"Harmonization"===this.tutorialState.kind?1:"Finished"===this.tutorialState.kind||"Mute"===this.tutorialState.kind?0:void 0},e.prototype.setAudioParameters=function(e){this.audio.synthRunner.setAudioParameters(e),this.voiceNet.setParameters(e)},e.prototype.freeze=function(){this.suspended||(this.audio.suspend(),proxiesWindow.cancelAnimationFrame(this.requestedFrame),this.suspended=!0)},e.prototype.resume=function(){var e=this;if(this.suspended){this.audio.resume();var t=!0,i=0,n=function(o){var r=t?16.666666666666668:o-i;e.update(r),e.requestedFrame=proxiesWindow.requestAnimationFrame(n),i=o,t&&(t=!1)};this.requestedFrame=proxiesWindow.requestAnimationFrame(n),this.suspended=!1}},e.prototype.completedTutorial=function(){return"Finished"===this.tutorialState.kind},e.prototype.isDraggingBlob=function(){return null!==this.blobController},e.prototype.exitPlaying=function(){this.stopPlayback()},e.prototype.enterMain=function(){if(this.state!==Xe.Main){this.state===Xe.Playing&&this.exitPlaying();for(var e=0;e<this.getUnlockedVoiceIndex();++e)this.blobs[e].blob.startRising(10*e);this.state=Xe.Main,this.fireStateChangeListeners()}},e.prototype.enterPlaying=function(e){if(this.state===Xe.Main){for(var t=0;t<this.getUnlockedVoiceIndex();++t)this.blobs[t].blob.state!==E.Idle&&this.blobs[t].blob.startFalling(10*t);this.cameraPosition.change(this.cameraPositions[0],1)}else this.state,Xe.Playing;this.state=Xe.Playing,this.playingRecording=e,this.playing=!1,this.startPlayback(0),this.fireStateChangeListeners()},e.prototype.startNewRecording=function(e){this.isRecording=!0,this.currentRecording=function(e,t){for(var i=[],n=0;n<e;++n)i.push({notes:[],startSuffix:[]});return{theme:c.Normal,location:t,parts:i}}(this.blobs.length,e),this.recordingStartTime=this.clock.getTimeMs(),"Finished"===this.tutorialState.kind&&(this.tutorialState.hasInteracted=!0)},e.prototype.finishRecording=function(){if(!this.isRecording)return null;var e=this.currentRecording;return function(e,t){for(var i=1/0,n=0,o=e.parts;n<o.length;n++)(l=o[n]).notes.length>0&&(i=Math.min(i,l.notes[0].timeSeconds));for(var r=.2-i,a=0,s=e.parts;a<s.length;a++)for(var l,u=0,c=(l=s[a]).notes;u<c.length;u++)c[u].timeSeconds+=r}(e),this.isRecording=!1,this.currentRecording=null,e},e.prototype.togglePlayback=function(){this.state===Xe.Playing&&(this.playing?this.stopPlayback():this.startPlayback(0))},e.prototype.startPlayback=function(e){if(this.state===Xe.Playing){this.playing=!0,this.playbackStartTime=this.clock.getTimeMs()+1e3*e;for(var t=0,i=this.blobs;t<i.length;t++)i[t].playbackIndex=0}},e.prototype.stopPlayback=function(){if(this.state===Xe.Playing&&this.playing){this.playing=!1;for(var e=this.libretto.getNextChunk(w.b.sil),t=0;t<this.blobs.length;++t)this.singers[t].currentMuted||this.singers[t].singNote(e,this.singers[t].currentMidiNote,!0,!1,1)}},e.prototype.skipTutorial=function(e){if(void 0===e&&(e=0),this.state===Xe.Main){if(!this.config.disableDrop){for(var t=e,i=this.getUnlockedVoiceIndex()-1;i>=0;i-=1)this.blobs[i].blob.startFalling(t),t+=10;for(i=4;i<this.blobs.length;++i)this.blobs[i].blob.startFalling(t),t+=10}this.tutorialState={kind:"Finished",hasInteracted:!0}}},e.prototype.setFestiveEnabled=function(e){if(this.festiveEnabled=e,this.festiveEnabled)for(var t=0;t<this.blobs.length;++t)this.blobs[t].blob.hatOffset.change(0,.5,.1*(3-t));else for(t=0;t<this.blobs.length;++t)this.blobs[t].blob.hatOffset.change(1,.5,.1*t)},e.prototype.setScene=function(e,t){for(var i=$e(e.blobs.map((function(e){return e.width}))),n=0;n<4;++n){this.blobs[n].oldBlob&&(this.blobs[n].oldBlob.destroy(),this.blobs[n].oldBlob=null);var o=e.blobs[n],r=e.name===this.config.scenes[0].name?this.festiveTheme:c.Normal,a=new z(this.renderer.gl,this.blobModule,this.eyeBuffer,this.eyeBufferIsJSON,t.blobAssets[n],this.audio.synthRunner.audioParameters.voiceTypes[this.audio.synthRunner.audioParameters.singers[o.singerIndex].voiceType].scale,this.qualitySettings.blobSubdivisions,e.blobs[n],i[n],!0,r);this.blobs[n].oldBlob=this.blobs[n].blob,this.blobs[n].blob=a,a.startFalling(10*n),this.festiveEnabled&&a.hatOffset.change(0,0),this.blobs[n].oldBlob.exitStageLeft()}this.cameraPositions=et(i),this.renderer.changeScene(t.environmentAssets.backgroundImage,t.environmentAssets.backgroundMaskImage,.2),e.name===this.config.scenes[0].name?(this.festiveParticleTransitionT.change(1,0),this.festiveParticleTransitionT.change(0,.5)):this.festiveParticleTransitionT.change(-1,.5)},e.prototype.getAudioRTF=function(){return this.audio.synthRunner.getAverageTime()},e.prototype.getAudioRTFEnoughSamples=function(){return this.audio.synthRunner.getEnoughSamples()},e.prototype.jingleBells=function(){this.audio.samplePlayer.play("bells")},e.prototype.popConfetti=function(){this.renderer.popConfetti(),this.lastConfettiPopTime=Date.now();for(var e=[],t=0;t<this.blobs.length;++t)t<this.blobs.length/2?e.push("left"):e.push("right");for(Object(p.u)(e),t=0;t<this.blobs.length;++t)this.blobs[t].overrideLookPosition=["left"===e[t]?-20:20,Object(p.s)(15,25),10],this.blobs[t].blob.addImpulse(0,3,0);this.audio.samplePlayer.play("party")},e.prototype.getGl=function(){return this.renderer.getGl()},e}(),ct=(tt=void 0!==proxiesWindow.document&&proxiesWindow.document.currentScript?proxiesWindow.document.currentScript.src:void 0,function(e){var t,i,n=void 0!==(e=e||{})?e:{};n.ready=new Promise((function(e,n){t=e,i=n}));var o,r={};for(o in n)n.hasOwnProperty(o)&&(r[o]=n[o]);var a=[],s="";void 0!==proxiesWindow.document&&proxiesWindow.document.currentScript&&(s=proxiesWindow.document.currentScript.src),tt&&(s=tt),s=0!==s.indexOf("blob:")?s.substr(0,s.lastIndexOf("/")+1):"";var l,u,c=n.print||console.log.bind(console),h=n.printErr||console.warn.bind(console);for(o in r)r.hasOwnProperty(o)&&(n[o]=r[o]);r=null,n.arguments&&(a=n.arguments),n.thisProgram&&n.thisProgram,n.quit&&n.quit,n.wasmBinary&&(l=n.wasmBinary),n.noExitRuntime&&n.noExitRuntime,"object"!=typeof WebAssembly&&B("no native wasm support detected");var d=!1;function f(e){var t=n["_"+e];return t||B("Assertion failed: "+("Cannot call unknown function "+e+", make sure it is exported")),t}function p(e,t,i,n,o){var r={string:function(e){var t=0;if(null!=e&&0!==e){var i=1+(e.length<<2);!function(e,t,i){!function(e,t,i,n){if(!(n>0))return 0;for(var o=i+n-1,r=0;r<e.length;++r){var a=e.charCodeAt(r);if(a>=55296&&a<=57343)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++r);if(a<=127){if(i>=o)break;t[i++]=a}else if(a<=2047){if(i+1>=o)break;t[i++]=192|a>>6,t[i++]=128|63&a}else if(a<=65535){if(i+2>=o)break;t[i++]=224|a>>12,t[i++]=128|a>>6&63,t[i++]=128|63&a}else{if(i+3>=o)break;t[i++]=240|a>>18,t[i++]=128|a>>12&63,t[i++]=128|a>>6&63,t[i++]=128|63&a}}t[i]=0}(e,b,t,i)}(e,t=Y(i),i)}return t},array:function(e){var t=Y(e.length);return function(e,t){g.set(e,t)}(e,t),t}},a=f(e),s=[],l=0;if(n)for(var u=0;u<n.length;u++){var c=r[i[u]];c?(0===l&&(l=W()),s[u]=c(n[u])):s[u]=n[u]}var h=a.apply(null,s);return h=function(e){return"string"===t?_(e):"boolean"===t?Boolean(e):e}(h),0!==l&&V(l),h}var m,g,b,v,y="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function x(e,t,i){for(var n=t+i,o=t;e[o]&&!(o>=n);)++o;if(o-t>16&&e.subarray&&y)return y.decode(e.subarray(t,o));for(var r="";t<o;){var a=e[t++];if(128&a){var s=63&e[t++];if(192!=(224&a)){var l=63&e[t++];if((a=224==(240&a)?(15&a)<<12|s<<6|l:(7&a)<<18|s<<12|l<<6|63&e[t++])<65536)r+=String.fromCharCode(a);else{var u=a-65536;r+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else r+=String.fromCharCode((31&a)<<6|s)}else r+=String.fromCharCode(a)}return r}function _(e,t){return e?x(b,e,t):""}function w(e){m=e,n.HEAP8=g=new Int8Array(e),n.HEAP16=new Int16Array(e),n.HEAP32=v=new Int32Array(e),n.HEAPU8=b=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAPU32=new Uint32Array(e),n.HEAPF32=new Float32Array(e),n.HEAPF64=new Float64Array(e)}n.INITIAL_MEMORY;var P,S=[],k=[],A=[],T=[];k.push({func:function(){U()}});var E=0,M=null,R=null;function B(e){n.onAbort&&n.onAbort(e),h(e+=""),d=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw i(t),t}function C(e){return t=e,i="data:application/octet-stream;base64,",String.prototype.startsWith?t.startsWith(i):0===t.indexOf(i);var t,i}n.preloadedImages={},n.preloadedAudios={};var F,L="blobmodule.wasm";function I(e){try{if(e==L&&l)return new Uint8Array(l);throw"both async and sync fetching of the wasm failed"}catch(e){B(e)}}function D(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"==typeof i?void 0===t.arg?P.get(i)():P.get(i)(t.arg):i(void 0===t.arg?null:t.arg)}else t(n)}}C(L)||(F=L,L=n.locateFile?n.locateFile(F,s):s+F);function j(e){this.excPtr=e,this.ptr=e-16,this.set_type=function(e){v[this.ptr+8>>2]=e},this.get_type=function(){return v[this.ptr+8>>2]},this.set_destructor=function(e){v[this.ptr+0>>2]=e},this.get_destructor=function(){return v[this.ptr+0>>2]},this.set_refcount=function(e){v[this.ptr+4>>2]=e},this.set_caught=function(e){e=e?1:0,g[this.ptr+12>>0]=e},this.get_caught=function(){return 0!=g[this.ptr+12>>0]},this.set_rethrown=function(e){e=e?1:0,g[this.ptr+13>>0]=e},this.get_rethrown=function(){return 0!=g[this.ptr+13>>0]},this.init=function(e,t){this.set_type(e),this.set_destructor(t),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var e=v[this.ptr+4>>2];v[this.ptr+4>>2]=e+1},this.release_ref=function(){var e=v[this.ptr+4>>2];return v[this.ptr+4>>2]=e-1,1===e}}function O(e){try{return u.grow(e-m.byteLength+65535>>>16),w(u.buffer),1}catch(e){}}var z,N={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var i=N.buffers[e];0===t||10===t?((1===e?c:h)(x(i,0)),i.length=0):i.push(t)},varargs:void 0,get:function(){return N.varargs+=4,v[N.varargs-4>>2]},getStr:function(e){return _(e)},get64:function(e,t){return e}},H={b:function(e){return G(e+16)+16},a:function(e,t,i){throw new j(e).init(t,i),e},d:function(){B()},e:function(e,t,i){b.copyWithin(e,t,t+i)},f:function(e){e>>>=0;var t=b.length;if(e>2147483648)return!1;for(var i,n=1;n<=4;n*=2){var o=t*(1+.2/n);if(o=Math.min(o,e+100663296),O(Math.min(2147483648,((i=Math.max(16777216,e,o))%65536>0&&(i+=65536-i%65536),i))))return!0}return!1},c:function(e,t,i,n){for(var o=0,r=0;r<i;r++){for(var a=v[t+8*r>>2],s=v[t+(8*r+4)>>2],l=0;l<s;l++)N.printChar(e,b[a+l]);o+=s}return v[n>>2]=o,0}},U=(function(){var e={a:H};function t(e,t){var i=e.exports;n.asm=i,w((u=n.asm.g).buffer),P=n.asm.Ia,function(e){if(E--,n.monitorRunDependencies&&n.monitorRunDependencies(E),0==E&&(null!==M&&(clearInterval(M),M=null),R)){var t=R;R=null,t()}}()}function o(e){t(e.instance)}function r(t){return(l||"function"!=typeof proxiesWindow.fetch?Promise.resolve().then((function(){return I(L)})):proxiesWindow.fetch(L,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+L+"'";return e.arrayBuffer()})).catch((function(){return I(L)}))).then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){h("failed to asynchronously prepare wasm: "+e),B(e)}))}if(E++,n.monitorRunDependencies&&n.monitorRunDependencies(E),n.instantiateWasm)try{return n.instantiateWasm(e,t)}catch(e){return h("Module.instantiateWasm callback failed with error: "+e),!1}(l||"function"!=typeof WebAssembly.instantiateStreaming||C(L)||"function"!=typeof proxiesWindow.fetch?r(o):proxiesWindow.fetch(L,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(o,(function(e){return h("wasm streaming compile failed: "+e),h("falling back to ArrayBuffer instantiation"),r(o)}))}))).catch(i)}(),n.___wasm_call_ctors=function(){return(U=n.___wasm_call_ctors=n.asm.h).apply(null,arguments)}),G=(n._createBlob=function(){return(n._createBlob=n.asm.i).apply(null,arguments)},n._deleteBlob=function(){return(n._deleteBlob=n.asm.j).apply(null,arguments)},n._blobStep=function(){return(n._blobStep=n.asm.k).apply(null,arguments)},n._blobReset=function(){return(n._blobReset=n.asm.l).apply(null,arguments)},n._blobAddImpulse=function(){return(n._blobAddImpulse=n.asm.m).apply(null,arguments)},n._blobGetRestMouthCentroid=function(){return(n._blobGetRestMouthCentroid=n.asm.n).apply(null,arguments)},n._blobGetMouthCentroid=function(){return(n._blobGetMouthCentroid=n.asm.o).apply(null,arguments)},n._blobGetTopIndex=function(){return(n._blobGetTopIndex=n.asm.p).apply(null,arguments)},n._blobGetVertexCount=function(){return(n._blobGetVertexCount=n.asm.q).apply(null,arguments)},n._blobGetPositions=function(){return(n._blobGetPositions=n.asm.r).apply(null,arguments)},n._blobGetRestPositions=function(){return(n._blobGetRestPositions=n.asm.s).apply(null,arguments)},n._blobGetNormals=function(){return(n._blobGetNormals=n.asm.t).apply(null,arguments)},n._blobGetUVs=function(){return(n._blobGetUVs=n.asm.u).apply(null,arguments)},n._blobGetIndices=function(){return(n._blobGetIndices=n.asm.v).apply(null,arguments)},n._blobGetIndexCount=function(){return(n._blobGetIndexCount=n.asm.w).apply(null,arguments)},n._blobGetRenderingVertexCount=function(){return(n._blobGetRenderingVertexCount=n.asm.x).apply(null,arguments)},n._blobGetRenderingPositions=function(){return(n._blobGetRenderingPositions=n.asm.y).apply(null,arguments)},n._blobGetRenderingNormals=function(){return(n._blobGetRenderingNormals=n.asm.z).apply(null,arguments)},n._blobGetRenderingUVs=function(){return(n._blobGetRenderingUVs=n.asm.A).apply(null,arguments)},n._blobGetRenderingSpeeds=function(){return(n._blobGetRenderingSpeeds=n.asm.B).apply(null,arguments)},n._blobGetRenderingIndices=function(){return(n._blobGetRenderingIndices=n.asm.C).apply(null,arguments)},n._blobGetRenderingIndexCount=function(){return(n._blobGetRenderingIndexCount=n.asm.D).apply(null,arguments)},n._blobGetMouthTriangleIndexCount=function(){return(n._blobGetMouthTriangleIndexCount=n.asm.E).apply(null,arguments)},n._blobGetMouthTriangleIndices=function(){return(n._blobGetMouthTriangleIndices=n.asm.F).apply(null,arguments)},n._blobGetMouthPositionCount=function(){return(n._blobGetMouthPositionCount=n.asm.G).apply(null,arguments)},n._blobGetMouthPositions=function(){return(n._blobGetMouthPositions=n.asm.H).apply(null,arguments)},n._blobGetMouthUVs=function(){return(n._blobGetMouthUVs=n.asm.I).apply(null,arguments)},n._blobRayIntersect=function(){return(n._blobRayIntersect=n.asm.J).apply(null,arguments)},n._blobSetDamping=function(){return(n._blobSetDamping=n.asm.K).apply(null,arguments)},n._blobSetMouthDamping=function(){return(n._blobSetMouthDamping=n.asm.L).apply(null,arguments)},n._blobSetMouthScale=function(){return(n._blobSetMouthScale=n.asm.M).apply(null,arguments)},n._blobSetMouthBend=function(){return(n._blobSetMouthBend=n.asm.N).apply(null,arguments)},n._blobSetMouthRotation=function(){return(n._blobSetMouthRotation=n.asm.O).apply(null,arguments)},n._blobSetMouthNoiseScale=function(){return(n._blobSetMouthNoiseScale=n.asm.P).apply(null,arguments)},n._blobSetMouthNoiseOffset=function(){return(n._blobSetMouthNoiseOffset=n.asm.Q).apply(null,arguments)},n._blobSetMouthNoiseFrequency=function(){return(n._blobSetMouthNoiseFrequency=n.asm.R).apply(null,arguments)},n._blobSetIsDragging=function(){return(n._blobSetIsDragging=n.asm.S).apply(null,arguments)},n._blobSetNoiseParameters=function(){return(n._blobSetNoiseParameters=n.asm.T).apply(null,arguments)},n._blobSetBreathVolumeScale=function(){return(n._blobSetBreathVolumeScale=n.asm.U).apply(null,arguments)},n._blobGetIntersectedRestPosition=function(){return(n._blobGetIntersectedRestPosition=n.asm.V).apply(null,arguments)},n._blobGetEye=function(){return(n._blobGetEye=n.asm.W).apply(null,arguments)},n._blobGetTongue=function(){return(n._blobGetTongue=n.asm.X).apply(null,arguments)},n._blobGetMouthProfilePositions=function(){return(n._blobGetMouthProfilePositions=n.asm.Y).apply(null,arguments)},n._blobGetMouthProfileNormals=function(){return(n._blobGetMouthProfileNormals=n.asm.Z).apply(null,arguments)},n._blobGetMouthProfileUVs=function(){return(n._blobGetMouthProfileUVs=n.asm._).apply(null,arguments)},n._blobGetMouthProfileIndices=function(){return(n._blobGetMouthProfileIndices=n.asm.$).apply(null,arguments)},n._blobGetMouthProfileIndexCount=function(){return(n._blobGetMouthProfileIndexCount=n.asm.aa).apply(null,arguments)},n._blobGetMouthProfileVertexCount=function(){return(n._blobGetMouthProfileVertexCount=n.asm.ba).apply(null,arguments)},n._tongueGetPointCount=function(){return(n._tongueGetPointCount=n.asm.ca).apply(null,arguments)},n._tongueGetPositions=function(){return(n._tongueGetPositions=n.asm.da).apply(null,arguments)},n._tongueGetTangents=function(){return(n._tongueGetTangents=n.asm.ea).apply(null,arguments)},n._tongueGetNormals=function(){return(n._tongueGetNormals=n.asm.fa).apply(null,arguments)},n._tongueSetWindForce=function(){return(n._tongueSetWindForce=n.asm.ga).apply(null,arguments)},n._tongueSetOscillationScale=function(){return(n._tongueSetOscillationScale=n.asm.ha).apply(null,arguments)},n._eyeGetVertexCount=function(){return(n._eyeGetVertexCount=n.asm.ia).apply(null,arguments)},n._eyeGetPositions=function(){return(n._eyeGetPositions=n.asm.ja).apply(null,arguments)},n._eyeGetRestPositions=function(){return(n._eyeGetRestPositions=n.asm.ka).apply(null,arguments)},n._eyeGetNormals=function(){return(n._eyeGetNormals=n.asm.la).apply(null,arguments)},n._eyeGetUVs=function(){return(n._eyeGetUVs=n.asm.ma).apply(null,arguments)},n._eyeGetCenterPosition=function(){return(n._eyeGetCenterPosition=n.asm.na).apply(null,arguments)},n._eyeGetAttachPosition=function(){return(n._eyeGetAttachPosition=n.asm.oa).apply(null,arguments)},n._eyeGetIndices=function(){return(n._eyeGetIndices=n.asm.pa).apply(null,arguments)},n._eyeGetIndexCount=function(){return(n._eyeGetIndexCount=n.asm.qa).apply(null,arguments)},n._blobGetHat=function(){return(n._blobGetHat=n.asm.ra).apply(null,arguments)},n._hatGetPointCount=function(){return(n._hatGetPointCount=n.asm.sa).apply(null,arguments)},n._hatGetPositions=function(){return(n._hatGetPositions=n.asm.ta).apply(null,arguments)},n._hatGetTangents=function(){return(n._hatGetTangents=n.asm.ua).apply(null,arguments)},n._hatGetNormals=function(){return(n._hatGetNormals=n.asm.va).apply(null,arguments)},n._hatGetBrimPositions=function(){return(n._hatGetBrimPositions=n.asm.wa).apply(null,arguments)},n._createRigidMesh=function(){return(n._createRigidMesh=n.asm.xa).apply(null,arguments)},n._rigidMeshGetVertexCount=function(){return(n._rigidMeshGetVertexCount=n.asm.ya).apply(null,arguments)},n._rigidMeshGetPositions=function(){return(n._rigidMeshGetPositions=n.asm.za).apply(null,arguments)},n._rigidMeshGetNormals=function(){return(n._rigidMeshGetNormals=n.asm.Aa).apply(null,arguments)},n._rigidMeshGetUVs=function(){return(n._rigidMeshGetUVs=n.asm.Ba).apply(null,arguments)},n._rigidMeshGetTangents=function(){return(n._rigidMeshGetTangents=n.asm.Ca).apply(null,arguments)},n._rigidMeshGetIndices=function(){return(n._rigidMeshGetIndices=n.asm.Da).apply(null,arguments)},n._rigidMeshGetIndexCount=function(){return(n._rigidMeshGetIndexCount=n.asm.Ea).apply(null,arguments)},n._rigidMeshGetBottomPoint=function(){return(n._rigidMeshGetBottomPoint=n.asm.Fa).apply(null,arguments)},n._malloc=function(){return(G=n._malloc=n.asm.Ga).apply(null,arguments)}),W=(n._free=function(){return(n._free=n.asm.Ha).apply(null,arguments)},n.stackSave=function(){return(W=n.stackSave=n.asm.Ja).apply(null,arguments)}),V=n.stackRestore=function(){return(V=n.stackRestore=n.asm.Ka).apply(null,arguments)},Y=n.stackAlloc=function(){return(Y=n.stackAlloc=n.asm.La).apply(null,arguments)};function q(e){function i(){z||(z=!0,n.calledRun=!0,d||(D(k),D(A),t(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)e=n.postRun.shift(),T.unshift(e);var e;D(T)}()))}e=e||a,E>0||(!function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)e=n.preRun.shift(),S.unshift(e);var e;D(S)}(),E>0||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),i()}),1)):i()))}if(n.ccall=p,n.cwrap=function(e,t,i,n){var o=(i=i||[]).every((function(e){return"number"===e}));return"string"!==t&&o&&!n?f(e):function(){return p(e,t,i,arguments)}},R=function e(){z||q(),z||(R=e)},n.run=q,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return q(),e.ready}),ht=i(19),dt=i(8),ft=function(){var e=void 0!==proxiesWindow.document&&proxiesWindow.document.currentScript?proxiesWindow.document.currentScript.src:void 0;return function(t){var i,n,o=void 0!==(t=t||{})?t:{};o.ready=new Promise((function(e,t){i=e,n=t}));var r,a={};for(r in o)o.hasOwnProperty(r)&&(a[r]=o[r]);var s=[],l="";void 0!==proxiesWindow.document&&proxiesWindow.document.currentScript&&(l=proxiesWindow.document.currentScript.src),e&&(l=e),l=0!==l.indexOf("blob:")?l.substr(0,l.lastIndexOf("/")+1):"",o.print||console.log.bind(console);var u,c,h=o.printErr||console.warn.bind(console);for(r in a)a.hasOwnProperty(r)&&(o[r]=a[r]);a=null,o.arguments&&(s=o.arguments),o.thisProgram&&o.thisProgram,o.quit&&o.quit,o.wasmBinary&&(u=o.wasmBinary),o.noExitRuntime&&o.noExitRuntime,"object"!=typeof WebAssembly&&M("no native wasm support detected");var d=!1;function f(e){var t=o["_"+e];return t||M("Assertion failed: "+("Cannot call unknown function "+e+", make sure it is exported")),t}function p(e,t,i,n,o){var r={string:function(e){var t=0;if(null!=e&&0!==e){var i=1+(e.length<<2);!function(e,t,i){!function(e,t,i,n){if(!(n>0))return 0;for(var o=i+n-1,r=0;r<e.length;++r){var a=e.charCodeAt(r);if(a>=55296&&a<=57343)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++r);if(a<=127){if(i>=o)break;t[i++]=a}else if(a<=2047){if(i+1>=o)break;t[i++]=192|a>>6,t[i++]=128|63&a}else if(a<=65535){if(i+2>=o)break;t[i++]=224|a>>12,t[i++]=128|a>>6&63,t[i++]=128|63&a}else{if(i+3>=o)break;t[i++]=240|a>>18,t[i++]=128|a>>12&63,t[i++]=128|a>>6&63,t[i++]=128|63&a}}t[i]=0}(e,b,t,i)}(e,t=G(i),i)}return t},array:function(e){var t=G(e.length);return function(e,t){g.set(e,t)}(e,t),t}},a=f(e),s=[],l=0;if(n)for(var u=0;u<n.length;u++){var c=r[i[u]];c?(0===l&&(l=H()),s[u]=c(n[u])):s[u]=n[u]}var h=a.apply(null,s);return h=function(e){return"string"===t?(i=e)?function(e,t,i){for(var n=t+undefined,o=t;e[o]&&!(o>=n);)++o;if(o-t>16&&e.subarray&&y)return y.decode(e.subarray(t,o));for(var r="";t<o;){var a=e[t++];if(128&a){var s=63&e[t++];if(192!=(224&a)){var l=63&e[t++];if((a=224==(240&a)?(15&a)<<12|s<<6|l:(7&a)<<18|s<<12|l<<6|63&e[t++])<65536)r+=String.fromCharCode(a);else{var u=a-65536;r+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else r+=String.fromCharCode((31&a)<<6|s)}else r+=String.fromCharCode(a)}return r}(b,i):"":"boolean"===t?Boolean(e):e;var i}(h),0!==l&&U(l),h}var m,g,b,v,y="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function x(e){m=e,o.HEAP8=g=new Int8Array(e),o.HEAP16=new Int16Array(e),o.HEAP32=v=new Int32Array(e),o.HEAPU8=b=new Uint8Array(e),o.HEAPU16=new Uint16Array(e),o.HEAPU32=new Uint32Array(e),o.HEAPF32=new Float32Array(e),o.HEAPF64=new Float64Array(e)}o.INITIAL_MEMORY;var _,w=[],P=[],S=[],k=[];P.push({func:function(){z()}});var A=0,T=null,E=null;function M(e){o.onAbort&&o.onAbort(e),h(e+=""),d=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw n(t),t}function R(e){return t=e,i="data:application/octet-stream;base64,",String.prototype.startsWith?t.startsWith(i):0===t.indexOf(i);var t,i}o.preloadedImages={},o.preloadedAudios={};var B,C="synthmodule.wasm";function F(e){try{if(e==C&&u)return new Uint8Array(u);throw"both async and sync fetching of the wasm failed"}catch(e){M(e)}}function L(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"==typeof i?void 0===t.arg?_.get(i)():_.get(i)(t.arg):i(void 0===t.arg?null:t.arg)}else t(o)}}R(C)||(B=C,C=o.locateFile?o.locateFile(B,l):l+B);function I(e){this.excPtr=e,this.ptr=e-16,this.set_type=function(e){v[this.ptr+8>>2]=e},this.get_type=function(){return v[this.ptr+8>>2]},this.set_destructor=function(e){v[this.ptr+0>>2]=e},this.get_destructor=function(){return v[this.ptr+0>>2]},this.set_refcount=function(e){v[this.ptr+4>>2]=e},this.set_caught=function(e){e=e?1:0,g[this.ptr+12>>0]=e},this.get_caught=function(){return 0!=g[this.ptr+12>>0]},this.set_rethrown=function(e){e=e?1:0,g[this.ptr+13>>0]=e},this.get_rethrown=function(){return 0!=g[this.ptr+13>>0]},this.init=function(e,t){this.set_type(e),this.set_destructor(t),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var e=v[this.ptr+4>>2];v[this.ptr+4>>2]=e+1},this.release_ref=function(){var e=v[this.ptr+4>>2];return v[this.ptr+4>>2]=e-1,1===e}}function D(e){try{return c.grow(e-m.byteLength+65535>>>16),x(c.buffer),1}catch(e){}}var j,O={e:function(e){return N(e+16)+16},d:function(e,t,i){throw new I(e).init(t,i),e},a:function(){M()},b:function(e,t,i){b.copyWithin(e,t,t+i)},c:function(e){e>>>=0;var t=b.length;if(e>2147483648)return!1;for(var i,n=1;n<=4;n*=2){var o=t*(1+.2/n);if(o=Math.min(o,e+100663296),D(Math.min(2147483648,((i=Math.max(16777216,e,o))%65536>0&&(i+=65536-i%65536),i))))return!0}return!1}},z=(function(){var e={a:O};function t(e,t){var i=e.exports;o.asm=i,x((c=o.asm.f).buffer),_=o.asm.F,function(e){if(A--,o.monitorRunDependencies&&o.monitorRunDependencies(A),0==A&&(null!==T&&(clearInterval(T),T=null),E)){var t=E;E=null,t()}}()}function i(e){t(e.instance)}function r(t){return(u||"function"!=typeof proxiesWindow.fetch?Promise.resolve().then((function(){return F(C)})):proxiesWindow.fetch(C,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+C+"'";return e.arrayBuffer()})).catch((function(){return F(C)}))).then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){h("failed to asynchronously prepare wasm: "+e),M(e)}))}if(A++,o.monitorRunDependencies&&o.monitorRunDependencies(A),o.instantiateWasm)try{return o.instantiateWasm(e,t)}catch(e){return h("Module.instantiateWasm callback failed with error: "+e),!1}(u||"function"!=typeof WebAssembly.instantiateStreaming||R(C)||"function"!=typeof proxiesWindow.fetch?r(i):proxiesWindow.fetch(C,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(i,(function(e){return h("wasm streaming compile failed: "+e),h("falling back to ArrayBuffer instantiation"),r(i)}))}))).catch(n)}(),o.___wasm_call_ctors=function(){return(z=o.___wasm_call_ctors=o.asm.g).apply(null,arguments)}),N=(o._createSynth=function(){return(o._createSynth=o.asm.h).apply(null,arguments)},o._synthGetBuffer=function(){return(o._synthGetBuffer=o.asm.i).apply(null,arguments)},o._synthStep=function(){return(o._synthStep=o.asm.j).apply(null,arguments)},o._synthHasEnoughExcitationFrames=function(){return(o._synthHasEnoughExcitationFrames=o.asm.k).apply(null,arguments)},o._synthHasEnoughSpectralFrames=function(){return(o._synthHasEnoughSpectralFrames=o.asm.l).apply(null,arguments)},o._synthSetOnlyNoise=function(){return(o._synthSetOnlyNoise=o.asm.m).apply(null,arguments)},o._synthGetVoice=function(){return(o._synthGetVoice=o.asm.n).apply(null,arguments)},o._voiceAddSpectralFrame=function(){return(o._voiceAddSpectralFrame=o.asm.o).apply(null,arguments)},o._voiceAddExcitationFrame=function(){return(o._voiceAddExcitationFrame=o.asm.p).apply(null,arguments)},o._voiceSetGain=function(){return(o._voiceSetGain=o.asm.q).apply(null,arguments)},o._createSpectralFrame=function(){return(o._createSpectralFrame=o.asm.r).apply(null,arguments)},o._spectralFrameReset=function(){return(o._spectralFrameReset=o.asm.s).apply(null,arguments)},o._spectralFrameGetSpectrogram=function(){return(o._spectralFrameGetSpectrogram=o.asm.t).apply(null,arguments)},o._createExcitationFrame=function(){return(o._createExcitationFrame=o.asm.u).apply(null,arguments)},o._excitationFrameReset=function(){return(o._excitationFrameReset=o.asm.v).apply(null,arguments)},o._excitationFrameGetAperiodic=function(){return(o._excitationFrameGetAperiodic=o.asm.w).apply(null,arguments)},o._excitationFrameGetPeriodic=function(){return(o._excitationFrameGetPeriodic=o.asm.x).apply(null,arguments)},o._clearBuffer=function(){return(o._clearBuffer=o.asm.y).apply(null,arguments)},o._copyBuffer=function(){return(o._copyBuffer=o.asm.z).apply(null,arguments)},o._createReverbContext=function(){return(o._createReverbContext=o.asm.A).apply(null,arguments)},o._createDCReverbContext=function(){return(o._createDCReverbContext=o.asm.B).apply(null,arguments)},o._reverbContextProcess=function(){return(o._reverbContextProcess=o.asm.C).apply(null,arguments)},o._heavySendMessage=function(){return(o._heavySendMessage=o.asm.D).apply(null,arguments)},o._synthBenchmarkSpectrumGeneration=function(){return(o._synthBenchmarkSpectrumGeneration=o.asm.E).apply(null,arguments)},o._malloc=function(){return(N=o._malloc=o.asm.G).apply(null,arguments)}),H=(o._free=function(){return(o._free=o.asm.H).apply(null,arguments)},o.stackSave=function(){return(H=o.stackSave=o.asm.I).apply(null,arguments)}),U=o.stackRestore=function(){return(U=o.stackRestore=o.asm.J).apply(null,arguments)},G=o.stackAlloc=function(){return(G=o.stackAlloc=o.asm.K).apply(null,arguments)};function W(e){function t(){j||(j=!0,o.calledRun=!0,d||(L(P),L(S),i(o),o.onRuntimeInitialized&&o.onRuntimeInitialized(),function(){if(o.postRun)for("function"==typeof o.postRun&&(o.postRun=[o.postRun]);o.postRun.length;)e=o.postRun.shift(),k.unshift(e);var e;L(k)}()))}e=e||s,A>0||(!function(){if(o.preRun)for("function"==typeof o.preRun&&(o.preRun=[o.preRun]);o.preRun.length;)e=o.preRun.shift(),w.unshift(e);var e;L(w)}(),A>0||(o.setStatus?(o.setStatus("Running..."),setTimeout((function(){setTimeout((function(){o.setStatus("")}),1),t()}),1)):t()))}if(o.ccall=p,o.cwrap=function(e,t,i,n){var o=(i=i||[]).every((function(e){return"number"===e}));return"string"!==t&&o&&!n?f(e):function(){return p(e,t,i,arguments)}},E=function e(){j||W(),j||(E=e)},o.run=W,o.preInit)for("function"==typeof o.preInit&&(o.preInit=[o.preInit]);o.preInit.length>0;)o.preInit.pop()();return W(),t.ready}}(),pt=i(4);function mt(){return null!==(null!==proxiesWindow.navigator.userAgent.match(/Android/i)||null!==proxiesWindow.navigator.userAgent.match(/webOS/i)||null!==proxiesWindow.navigator.userAgent.match(/iPhone/i)||null!==proxiesWindow.navigator.userAgent.match(/iPad/i)||null!==proxiesWindow.navigator.userAgent.match(/iPod/i)||null!==proxiesWindow.navigator.userAgent.match(/BlackBerry/i)||proxiesWindow.navigator.userAgent.match(/Windows Phone/i))}function gt(){return null!==proxiesWindow.navigator.userAgent.match(/Android/i)}function bt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(proxiesWindow.navigator.platform)||proxiesWindow.navigator.userAgent.includes("Mac")&&"ontouchend"in proxiesWindow.document}var vt=i(14),yt=i(12),xt=function(){function e(e){this.sampleCount=e,this.samples=[]}return e.prototype.add=function(e){this.samples.length===this.sampleCount&&this.samples.splice(0,1),this.samples.push(e)},e.prototype.get=function(){if(0===this.samples.length)return 0;for(var e=0,t=0;t<this.samples.length;++t)e+=this.samples[t];return e/this.samples.length},e.prototype.enoughSamples=function(){return this.samples.length===this.sampleCount},e}(),_t=function(){function e(e,t,i,n,o,r,a,s,l,u){var c=this;this.timingEnabled=!0,this.onFrameUsed=null,this.audioContext=t,this.scriptNode=this.audioContext.createScriptProcessor(u,0,2),this.audioParameters=l,this.synth=new ht.a(e,i,n,o,r,a,s,l,u),this.synth.onFrameUsed=function(e){c.onFrameUsed&&c.onFrameUsed(e)};var h=Math.floor(5*t.sampleRate/u);this.runningAverage=new xt(h),this.bufferSize=l.scriptProcessorBufferSize}return e.prototype.start=function(){var e=this,t=1e3*this.bufferSize/this.synth.sampleRate;this.scriptNode.onaudioprocess=function(i){var n=[i.outputBuffer.getChannelData(0),i.outputBuffer.getChannelData(1)],o=proxiesWindow.performance.now();e.synth.process(n,e.scriptNode.bufferSize);var r=proxiesWindow.performance.now()-o;e.timingEnabled&&e.runningAverage.add(t/Math.max(1,r))},this.scriptNode.connect(this.audioContext.destination)},e.prototype.setTimingEnabled=function(e){this.timingEnabled=e},e.prototype.getAverageTime=function(){return this.runningAverage.get()},e.prototype.getEnoughSamples=function(){return this.runningAverage.enoughSamples()},e.prototype.setPans=function(e){this.synth.setPans(e)},e.prototype.addSpectralFrame=function(e,t){this.synth.addSpectralFrame(e,t)},e.prototype.addExcitationFrame=function(e,t){this.synth.addExcitationFrame(e,t)},e.prototype.setOverrideFrequency=function(e,t){this.synth.setOverrideFrequency(e,t)},e.prototype.addOverrideF0=function(e,t){this.synth.addOverrideF0(e,t)},e.prototype.setAudioParameters=function(e){this.synth.setAudioParameters(e)},e}(),wt=[32e3,24e3,22050];function Pt(e,t,n,o,r){for(var a=1;Math.floor(e.sampleRate/a)>r;)a*=2;for(var s=e.sampleRate/a,l=0,u=0;u<wt.length&&!((l=wt[u])<=s);++u);var c,h=Object(pt.a)("seeds"+l.toFixed(0)+".flat");return c=!function(e){return e.audioWorklet&&e.audioWorklet instanceof proxiesWindow.AudioWorklet&&"function"==typeof e.audioWorklet.addModule&&proxiesWindow.AudioWorkletNode}(e)||!proxiesWindow.navigator.userAgent.includes("Chrome/89")&&!proxiesWindow.navigator.userAgent.includes("Chrome/90")||bt()?function(e,t,i,n,o,r,a){var s=Object(vt.a)();return Promise.all([ft({locateFile:function(e,t){return e+=Object(yt.a)(),s?Object(pt.a)(e.replace(".wasm","-simd.wasm")):Object(pt.a)(e)}}),Object(dt.a)(i),Object(dt.a)(n)]).then((function(i){return new _t(e,t,i[0],new Uint8Array(i[1]),new Uint8Array(i[2]),t.sampleRate,r,a,o,o.scriptProcessorBufferSize)}))}(t,e,h,n,o,s,l):i.e(4).then(i.bind(null,48)).then((function(i){return i.createAudioWorkletSynthRunner(t,e,h,n,o,s,l)})),Promise.all([c,St(e,"applause","./applause.mp3")]).then((function(t){return new Tt(e,t[0],new kt(e,{applause:t[1]}),s)}))}function St(e,t,i){return proxiesWindow.fetch(i).then((function(e){return e.arrayBuffer()})).then((function(i){return new Promise((function(n,o){e.decodeAudioData(i,(function(e){n({name:t,audioBuffer:e})}),(function(e){n(null)}))}))}))}var kt=function(){function e(e,t){this.samples={},this.audioContext=e,this.samples=t}return e.prototype.addSample=function(e,t){this.samples[e]=t},e.prototype.play=function(e){var t=this.samples[e];if(t){var i=this.audioContext.createBufferSource();i.buffer=t.audioBuffer,i.loop=!1;var n=this.audioContext.createGain();n.gain.value=.2,i.connect(n),n.connect(this.audioContext.destination),i.start(0);var o=t.audioBuffer.length/t.audioBuffer.sampleRate;proxiesWindow.setTimeout((function(){i.stop(),n.disconnect(),i.disconnect()}),1e3*(o+3))}},e}();function At(e,t){var i;for(i=t;e>1;e--)i+=t;return i}var Tt=function(){function e(e,t,i,n){this.hasPlayedTrack=!1,this.audioContext=e,this.synthRunner=t,this.sampleRate=e.sampleRate,this.samplePlayer=i,this.processingSampleRate=n,this.audioContext.resume()}return e.prototype.start=function(){this.audioContext.resume(),this.synthRunner.start();var e=this.audioContext,t=e.createBuffer(1,1,e.sampleRate),i=e.createBufferSource();i.buffer=t,i.connect(e.destination),i.start(0)},e.prototype.tryUnlock=function(){if(bt()&&!this.hasPlayedTrack){var e=proxiesWindow.document.createElement("div");e.innerHTML="<audio x-webkit-airplay='deny'></audio>",this.tag=e.children.item(0),this.tag.controls=!1,this.tag.disableRemotePlayback=!0,this.tag.preload="auto",this.tag.src="data:audio/mpeg;base64,//uQx"+At(23,"A")+"WGluZwAAAA8AAAACAAACcQCA"+At(16,"gICA")+At(66,"/")+"8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkI"+At(320,"A")+"//sQxAADgnABGiAAQBCqgCRMAAgEAH"+At(15,"/")+"7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq"+At(18,"/")+"9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAw"+At(97,"V")+"Q==",this.tag.loop=!0,this.tag.load();try{this.tag.play()}catch(e){}this.hasPlayedTrack=!0}this.audioContext.resume()},e.prototype.isMuted=function(){return"running"!==this.audioContext.state},e.prototype.suspend=function(){this.audioContext.suspend()},e.prototype.resume=function(){this.audioContext.resume()},e}(),Et=function(){function e(e){var t=this;this.queuedPromises=[],this.worker=e,this.worker.onmessage=function(e){var i=e.data;"Notes"===i.type&&(t.queuedPromises[0](i.notes),t.queuedPromises.splice(0,1))}}return e.prototype.harmonize=function(e){var t=this;return new Promise((function(i,n){var o={note:e};t.queuedPromises.push(i),t.worker.postMessage(o)}))},e}();function Mt(e,t){for(var i=[],n=0;n<t;++n)i.push(new proxiesWindow.Worker(Object(pt.a)("voicenetworker.js"+Object(yt.a)())));return Promise.all([Object(dt.a)(Object(pt.a)("spectral.flat")),Object(dt.a)(Object(pt.a)("aperiodic.flat"))]).then((function(n){var o=new Uint8Array(n[0]),r=new Uint8Array(n[1]),a={type:"Init",streamCount:Math.ceil(e/t),spectralParametersBuffer:o,aperiodicParametersBuffer:r};return Promise.all(i.map((function(e){return new Promise((function(t,i){e.onmessage=function(i){var n=i.data;n instanceof ArrayBuffer||"Loaded"!==n.type||t(e)},e.postMessage(a)}))})))})).then((function(i){return new Rt(e,t,i)}))}for(var Rt=function(){function e(e,t,i){var n=this;this.workers=[],this.listeners=[],this.framesBeingGenerated=0,this.workerCount=t,this.workers=i;for(var o=0;o<e;++o)this.listeners.push([]);for(var r=function(e){a.workers[e].onmessage=function(t){var i=t.data;if("Frames"===i.type){n.framesBeingGenerated-=i.excitationFrames.length,n.framesBeingGenerated<0&&(n.framesBeingGenerated=0);for(var o=new be.a(i.spectralFrame),r=o.getId(),a=e+r*n.workerCount,s=i.excitationFrames.map((function(e){return new ve.a(e)})),l=0,u=n.listeners[a];l<u.length;l++)(0,u[l])(o,s)}}},a=this,s=0;s<this.workers.length;++s)r(s)}return e.prototype.generate=function(e,t,i){this.framesBeingGenerated+=i.length;var n=e%this.workerCount,o=Math.floor(e/this.workerCount);t.setId(o);for(var r=0,a=i;r<a.length;r++)a[r].setId(o);var s={type:"Generate",spectralFrame:t.buffer,excitationFrames:i.map((function(e){return e.buffer}))},l=[t.buffer].concat(s.excitationFrames);this.workers[n].postMessage(s,l)},e.prototype.addListener=function(e,t){this.listeners[e].push(t)},e.prototype.setParameters=function(e){for(var t=0,i=this.workers;t<i.length;t++){var n={type:"Parameters",parameters:e};i[t].postMessage(n)}},e}(),Bt=i(37),Ct=function(){function e(){}return e.prototype.loadRecording=function(t){return function(e){return e.length&&!e.match(/[.$\[\]#\/]/)}(t)?proxiesWindow.fetch(e.ROUTE+"/"+t).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){return proxiesWindow.fetch(e.url)})).then((function(e){return e.arrayBuffer()})).then((function(e){return Bt.RecordingMessage.decode(new Uint8Array(e))})):Promise.reject("Invalid recording ID")},e.prototype.saveRecording=function(t){var i=Bt.RecordingMessage.encode(t).finish();return proxiesWindow.fetch(e.ROUTE,{method:"PUT",body:i}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){return{id:e.id}}))},e.ROUTE="./recording",e}(),Ft=(function(){function e(){}e.prototype.loadRecording=function(e){return new Promise((function(e,t){}))},e.prototype.saveRecording=function(e){return new Promise((function(e,t){proxiesWindow.setTimeout((function(){e({id:"temp"})}),1e3)}))}}(),i(39)),Lt={},It=i.n(Ft).a,Dt=It[0].slice(1),jt=0,Ot=Dt;jt<Ot.length;jt++){var zt=Ot[jt];Lt[zt]={}}for(var Nt=1;Nt<It.length;++Nt)for(var Ht=It[Nt],Ut=Ht[0],Gt=0;Gt<Dt.length;++Gt)Lt[Dt[Gt]][Ut]=Ht[1+Gt];var Wt=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Vt=function(){function e(){this.cached={}}return e.prototype.load=function(e){var t=this;return e in this.cached?Promise.resolve(this.cached[e]):this._load(e).then((function(i){return t.cached[e]=i,i}))},e}(),Yt=function(e){function t(t){var i=e.call(this)||this;return i.gl=t,i}return Wt(t,e),t.prototype._load=function(e){var t=this;return Object(dt.b)(e).then((function(e){var i=t.gl;return s(i,0,e,i.REPEAT,i.REPEAT,i.LINEAR_MIPMAP_LINEAR,i.LINEAR,!0)}))},t}(Vt),qt=function(e){function t(){return e.call(this)||this}return Wt(t,e),t.prototype._load=function(e){return Object(dt.a)(e).then((function(e){return new Uint8Array(e)}))},t}(Vt);function Kt(e,t){return Promise.all([e.load(Object(pt.a)(t.albedoTexturePath)),e.load(Object(pt.a)(t.materialTexturePath))]).then((function(e){return{albedoTexture:e[0],materialMap:e[1],normalScale:void 0!==t.normalScale?t.normalScale:1,hueShift:void 0!==t.hueShift?t.hueShift:0,saturationBoost:void 0!==t.saturationBoost?t.saturationBoost:0,lightnessBoost:void 0!==t.lightnessBoost?t.lightnessBoost:0,f0:void 0!==t.f0?t.f0:.2,roughnessScale:void 0!==t.roughnessScale?t.roughnessScale:1}}))}function Xt(e,t,i){return Promise.all([Promise.all(i.blobs.map((function(i){return function(e,t,i){var n=i.modelPath.includes("json");return Promise.all([e.load(Object(pt.a)(i.modelPath)),Kt(t,i.body)]).then((function(e){return{meshBuffer:e[0],isJSONMesh:n,bodyMaterial:e[1],mouthColor:new Float32Array((t=Object(p.i)(i.mouth.color),f.a.pow([],t,2.2)))};var t}))}(e,t,i)}))),Object(dt.b)(Object(pt.a)(i.backgroundImagePath)),Object(dt.b)(Object(pt.a)(i.backgroundMaskPath))]).then((function(e){return{blobAssets:e[0],environmentAssets:{backgroundImage:e[1],backgroundMaskImage:e[2]}}}))}function Jt(e,t){for(var i=e.toFixed(0).slice(0,t);i.length<t;)i="0"+i;return i}function Zt(e){var t=Math.floor(e/60),i=Math.floor(e%60),n=Math.floor(e%1*100);return Jt(t,2)+":"+Jt(i,2)+"."+Jt(n,2)}function Qt(e){e.predicate()?e.hasClass||(e.element.classList.add(e.className),e.hasClass=!0):e.hasClass&&(e.element.classList.remove(e.className),e.hasClass=!1)}var $t,ei=function(){function e(){this.elements=[]}return e.prototype.add=function(e,t,i){for(var n=proxiesWindow.document.querySelectorAll(e),o=0;o<n.length;++o)this.elements.push({predicate:i,element:n[o],className:t,hasClass:n[0].classList.contains(t)});return this},e.prototype.update=function(){for(var e=0,t=this.elements;e<t.length;e++)Qt(t[e])},e}();function ti(e){return e===Xe.Main?"single":e===Xe.Playing?"autoplay":void 0}function ii(e,t,i,n){var o=proxiesWindow.document.createElement("li");return o.innerHTML='\n<div class="list-item-icon">\n    <div class="spinner"></div>\n    <span class="material-icons md-18">'+e+'</span>\n</div>\n<span class="song-name">'+t+'</span>\n<span class="song-description'+(""==i?" hidden":"")+'">'+i+"</span>\n",o.addEventListener("click",n),o}!function(e){e[e.UGC=0]="UGC",e[e.Location=1]="Location",e[e.Festive=2]="Festive"}($t||($t={}));var ni=function(){function e(e,t,i,n,o,r,a){var s,l=this;this.controlledElements=new ei,this.saveState={kind:"None"},this.locationState={kind:"None"},this.showingInfo=!1,this.showingFestivePlaylist=!1,this.showingLocationPlaylist=!1,this.showingLocationSelector=!1,this.hasStoppedRecording=!1,this.hasShownFestivePlaylist=!1,this.hasShownLocationPlaylist=!1,this.hasShownLocationSelector=!1,this.hasShared=!1,this.hasSharedCarol=!1,this.hasToggledFestive=!1,this.hasShownPerformanceWarning=!1,this.showingPerformanceWarning=!1,this.config=e,this.opera=t,this.opera.addStateChangeListener(this.onStateChange.bind(this)),this.blobCache=r,this.textureCache=a,this.environment=i,this.environment.onLocationChange=this.onLocationChange.bind(this),this.language=o,this.backend=new Ct,this.festiveConfig=(s=n.festiveTheme)===c.Christmas?{kind:c.Christmas,songs:[{recordingID:"jinglebells",nameStringID:"song_jingle_bells"},{recordingID:"silentnight",nameStringID:"song_silent_night"},{recordingID:"joytotheworld",nameStringID:"song_joy_to_the_world"},{recordingID:"harktheheraldangelssing",nameStringID:"song_hark_the_herald_angels_sing"},{recordingID:"awayinamanger",nameStringID:"song_away_in_a_manger"},{recordingID:"ocomeallyefaithful",nameStringID:"song_o_come_all_ye_faithful"},{recordingID:"thefirstnoel",nameStringID:"song_the_first_noel"},{recordingID:"onceinroyaldavidscity",nameStringID:"song_once_in_royal_davids_city"}]}:s===c.NewYears?{kind:c.NewYears,songs:[{recordingID:"auldlangsyne",nameStringID:"song_auld_lang_syne"}]}:{kind:c.Normal},"Recording"===n.kind&&(this.saveState={kind:"Saved",savedRecordingID:n.recordingID,recordingType:this.getRecordingType(n.recordingID)});var u=proxiesWindow.document.getElementById("skip"),d=function(){l.opera.skipTutorial(),l.environment.track({action:"skip-tutorial"})};u.addEventListener("click",d),u.addEventListener("touchend",d),proxiesWindow.document.getElementById("record").addEventListener("click",(function(){if(l.opera.isRecording)l.endRecording();else{var e=h.BlobperaHouse;"Loaded"===l.locationState.kind&&(e="location_blobpera_house"===(t=l.locationState.locationStringID)?h.BlobperaHouse:"location_london"===t?h.London:"location_new_york"===t?h.NewYork:"location_paris"===t?h.Paris:"location_mexico_city"===t?h.MexicoCity:"location_seoul"===t?h.Seoul:"location_cape_town"===t?h.CapeTown:h.BlobperaHouse),l.opera.startNewRecording(e),l.environment.track({action:"tap-record"})}var t})),proxiesWindow.document.getElementById("stop-record").addEventListener("click",(function(){l.opera.isRecording&&(l.endRecording(),QGUtils.triggerEvent(proxiesWindow.EVENT_RECORDING_END))})),proxiesWindow.document.getElementById("startstop").addEventListener("click",this.opera.togglePlayback.bind(this.opera)),proxiesWindow.document.getElementById("play").addEventListener("click",(function(){l.opera.enterMain(),l.updateMenus()})),proxiesWindow.document.getElementById("back").addEventListener("click",(function(){QGUtils.triggerEvent(proxiesWindow.EVENT_BACK_TO_MAIN),l.opera.enterMain(),l.updateMenus(),"Previewing"===l.saveState.kind&&l.environment.track({action:"tap-discard"}),l.environment.track({action:"tap-back",label:"Saved"===l.saveState.kind?l.saveState.savedRecordingID:""})})),proxiesWindow.document.getElementById("festive-playlist").addEventListener("click",(function(e){e.stopPropagation(),l.hasShownFestivePlaylist=!0,l.showingFestivePlaylist?l.showingFestivePlaylist=!1:(l.showingFestivePlaylist=!0,l.hasShownFestivePlaylist=!0),l.showingLocationSelector=!1,l.showingLocationPlaylist=!1}));var f=function(e){e.stopPropagation(),e.preventDefault(),l.hasShownLocationPlaylist=!0,l.showingLocationSelector=!1,l.showingLocationPlaylist=!l.showingLocationPlaylist,l.showingFestivePlaylist=!1},p=function(e){e.stopPropagation(),e.preventDefault(),l.hasShownLocationSelector=!0,l.showingLocationPlaylist=!1,l.showingLocationSelector=!l.showingLocationSelector,l.showingFestivePlaylist=!1};proxiesWindow.document.getElementById("location-playlist-button").addEventListener("click",f),proxiesWindow.document.getElementById("location-playlist-button").addEventListener("touchend",f),proxiesWindow.document.getElementById("location-selector-button").addEventListener("click",p),proxiesWindow.document.getElementById("location-selector-button").addEventListener("touchend",p);var m=function(e){e.stopPropagation(),e.preventDefault(),l.showingFestivePlaylist=!1,l.showingLocationPlaylist=!1,l.showingLocationSelector=!1};t.canvas.addEventListener("click",m),t.canvas.addEventListener("touchend",m),proxiesWindow.document.getElementById("performance-warning-dismiss").addEventListener("click",(function(e){l.showingPerformanceWarning=!1}));var g=function(){return t.state===Xe.Main&&"Pitch"===t.tutorialState.kind&&0===t.tutorialState.notesSung||l.opera.state===Xe.Playing&&!t.completedTutorial()},b=function(){return l.festiveConfig.kind!==c.Normal&&l.isAtBlobperaHouse()&&(t.state===Xe.Main&&t.completedTutorial()&&!t.isRecording||t.state===Xe.Playing&&t.completedTutorial())&&!l.opera.isDraggingBlob()&&!l.showingInfo},v=function(){return b()&&t.festiveEnabled&&(t.state===Xe.Main&&!t.isRecording||t.state===Xe.Playing&&(t.state===Xe.Playing&&"Saved"===l.saveState.kind&&l.saveState.recordingType===$t.Festive||"Loading"===l.saveState.kind&&l.saveState.recordingType===$t.Festive))&&!l.opera.isDraggingBlob()},y=function(){return(t.state===Xe.Main&&t.completedTutorial()&&!t.isRecording||t.state===Xe.Playing&&t.completedTutorial())&&!l.opera.isDraggingBlob()&&!l.showingInfo};this.controlledElements.add("#skip","visible",(function(){return l.opera.state===Xe.Main&&!("Finished"===t.tutorialState.kind||"Pitch"===t.tutorialState.kind&&0===t.tutorialState.notesSung)&&!l.showingInfo})).add("#splash","visible",(function(){return g()&&!l.showingInfo})).add("#title-small","visible",(function(){return!g()&&!l.showingInfo})).add("#record-container","visible",(function(){return l.opera.state===Xe.Main&&t.completedTutorial()&&!t.isRecording&&!t.isDraggingBlob()&&!l.showingInfo})).add("#record-container","recording",(function(){return l.opera.isRecording})).add("#stop-recording-container","visible",(function(){return l.opera.state===Xe.Main&&l.opera.isRecording})).add("#save-container","visible",(function(){return t.state===Xe.Playing&&!l.showingInfo})).add("#save-container","saving",(function(){return"SaveRequested"===l.saveState.kind})).add("#discard-container","visible",(function(){return"Previewing"===l.saveState.kind&&!l.showingInfo})).add("#recording-copy-link-container","visible",(function(){return"Saved"===l.saveState.kind&&!l.showingInfo})).add("#startstop-container","visible",(function(){return t.state===Xe.Playing&&!l.showingInfo})).add("#startstop-container","playing",(function(){return t.playing})).add("#play","visible",(function(){return t.state===Xe.Playing&&!t.completedTutorial()&&!l.showingInfo})).add("#back-container","visible",(function(){return t.state===Xe.Playing&&t.completedTutorial()&&!l.showingInfo})).add("#muted-container","visible",(function(){return t.state===Xe.Playing&&t.audio.isMuted()&&!t.suspended})).add("#festive-switch-container","visible",(function(){return b()})).add("#festive-playlist","visible",(function(){return v()})).add("#festive-prompt","visible",(function(){return b()&&!t.festiveEnabled&&!l.hasToggledFestive&&!l.showingLocationSelector})).add("#location-selection-prompt","visible",(function(){var e=!b()||!(!t.festiveEnabled&&!l.hasToggledFestive);return e&&y()&&!l.hasShownLocationSelector&&!l.showingLocationPlaylist&&!l.showingFestivePlaylist&&l.opera.state===Xe.Main})).add("#location-playlist-tray","visible",(function(){return y()&&"Loaded"===l.locationState.kind&&!l.isAtBlobperaHouse()})).add("#location-playlist-button","visible",(function(){return y()&&"Loaded"===l.locationState.kind&&!l.isAtBlobperaHouse()})).add("#location-playlist-button","depressed",(function(){return l.showingLocationPlaylist&&!l.showingInfo})).add("#location-selector-button","visible",(function(){return y()})).add("#location-selector-button","depressed",(function(){return l.showingLocationSelector&&!l.showingInfo})).add("#location-selector-container","visible",(function(){return l.showingLocationSelector&&!l.opera.isDraggingBlob()&&!l.showingInfo})).add("#location-songs-container","visible",(function(){return l.showingLocationPlaylist&&!l.opera.isDraggingBlob()&&!l.showingInfo&&"Loaded"===l.locationState.kind&&!l.isAtBlobperaHouse()})).add("#festive-songs-container","visible",(function(){return l.showingFestivePlaylist&&!l.opera.isDraggingBlob()&&!l.showingInfo})).add("#festive-playlist","depressed",(function(){return l.showingFestivePlaylist&&!l.showingInfo})).add("#recording-indicator","visible",(function(){return t.isRecording&&!l.showingInfo})).add("#tutorial-prompt-pitch","visible",(function(){return t.state===Xe.Main&&"Pitch"===t.tutorialState.kind&&t.tutorialState.notesSung>0&&!l.showingInfo})).add("#tutorial-prompt-vowel","visible",(function(){return t.state===Xe.Main&&"Vowel"===t.tutorialState.kind&&t.tutorialState.notesSung>0&&!l.showingInfo})).add("#tutorial-prompt-harmonization","visible",(function(){return t.state===Xe.Main&&"Harmonization"===t.tutorialState.kind&&t.tutorialState.notesSung>0&&!l.showingInfo})).add("#tutorial-prompt-mute","visible",(function(){return t.state===Xe.Main&&"Mute"===t.tutorialState.kind&&t.tutorialState.notesSung>0&&!l.showingInfo})).add("#tutorial-prompt-end","visible",(function(){return t.state===Xe.Main&&"Finished"===t.tutorialState.kind&&!t.tutorialState.hasInteracted&&!l.showingInfo})).add("#recording-frame-bottom-left","visible",(function(){return t.state===Xe.Main&&"Finished"===t.tutorialState.kind&&t.isRecording})).add("#recording-frame-bottom-right","visible",(function(){return t.state===Xe.Main&&"Finished"===t.tutorialState.kind&&t.isRecording})).add("#recording-frame-top-left","visible",(function(){return t.state===Xe.Main&&"Finished"===t.tutorialState.kind&&t.isRecording})).add("#recording-frame-top-right","visible",(function(){return t.state===Xe.Main&&"Finished"===t.tutorialState.kind&&t.isRecording})).add("#performance-warning","visible",(function(){return l.showingPerformanceWarning})).add("#disclaimer","visible",(function(){return g()&&t.state===Xe.Main&&!l.showingInfo})),this.festiveConfig.kind===c.Christmas?(proxiesWindow.document.querySelector("#festive-switch-container").classList.add("christmas"),proxiesWindow.document.querySelector("#festive-prompt").innerHTML=this.localiseString("prompt_festive")):this.festiveConfig.kind===c.NewYears&&(proxiesWindow.document.querySelector("#festive-switch-container").classList.add("newyears"),proxiesWindow.document.querySelector("#festive-prompt").innerHTML=this.localiseString("prompt_newyear")),this.festiveToggle=proxiesWindow.document.querySelector("input[name=festive]"),t.festiveEnabled&&this.festiveToggle.setAttribute("checked","true"),this.festiveToggle.addEventListener("change",(function(e){l.festiveToggle.checked?t.festiveEnabled||(l.opera.setFestiveEnabled(!0),l.hasToggledFestive=!0,l.festiveConfig.kind===c.NewYears?l.opera.popConfetti():l.festiveConfig.kind===c.Christmas&&l.opera.jingleBells(),v()&&(l.showingFestivePlaylist=!0)):(t.festiveEnabled&&l.opera.setFestiveEnabled(!1),l.showingFestivePlaylist=!1),l.showingLocationSelector=!1,l.environment.track({action:"tap-christmas-logo",label:ti(l.opera.state)})})),this.festiveConfig.kind!==c.Normal&&this.buildPlaylistMenu(proxiesWindow.document.getElementById("festive-songs"),this.festiveConfig.songs,!1);for(var x=proxiesWindow.document.getElementById("location-selector"),_=function(e){x.appendChild(ii("place",Lt[o][e.locationStringID],"",(function(t){t.stopPropagation(),"None"!==l.locationState.kind&&e.locationStringID===l.locationState.locationStringID||(l.opera.enterMain(),l.updateLocationState({kind:"Loading",locationStringID:e.locationStringID}),l.showingLocationPlaylist=!0,Xt(l.blobCache,l.textureCache,e).then((function(t){l.opera.setScene(e,t),l.updateLocationState({kind:"Loaded",locationStringID:e.locationStringID}),l.showingLocationSelector=!1})),l.environment.track({action:"tap-location"}))})))},w=0,S=e.scenes;w<S.length;w++)_(S[w]);var k,A=["soprano","mezzo-soprano","tenor","bass"];t.onBlobInteraction=function(e){l.environment.track({action:"blob-interaction",label:A[e]+"_"+ti(l.opera.state)+("Saved"===l.saveState.kind?"_"+l.saveState.savedRecordingID:"")})},t.onTutorialFinished=function(){l.environment.track({action:"finished-tutorial"})},this.updateLocationState({kind:"Loaded",locationStringID:"Recording"===n.kind?(k=n.recording.location,k===h.BlobperaHouse?"location_blobpera_house":"location_"+P(k)):e.scenes[0].locationStringID}),this.onStateChange(this.opera.state),proxiesWindow.document.querySelectorAll(".button-text").forEach((function(e){e.scrollWidth>e.clientWidth&&e.classList.add("button-text-small")}));var T=function(e){l.update(e),proxiesWindow.requestAnimationFrame(T)};proxiesWindow.requestAnimationFrame(T)}return e.prototype.localiseString=function(e){return Lt[this.language][e]},e.prototype.findLocationSong=function(e){for(var t=0,i=this.config.scenes;t<i.length;t++){var n=i[t];if(n.songs){var o=n.songs.find((function(t){return t.recordingID===e}));if(void 0!==o)return o}}return null},e.prototype.findFestiveSong=function(e){if(this.festiveConfig.kind!==c.Normal){var t=this.festiveConfig.songs.find((function(t){return t.recordingID===e}));if(void 0!==t)return t}return null},e.prototype.isFestiveRecording=function(e){return this.festiveConfig.kind!==c.Normal&&void 0!==this.festiveConfig.songs.find((function(t){return t.recordingID===e}))},e.prototype.isLocationRecording=function(e){for(var t=0,i=this.config.scenes;t<i.length;t++){var n=i[t];if(n.songs&&void 0!==n.songs.find((function(t){return t.recordingID===e})))return!0}return!1},e.prototype.getRecordingType=function(e){return this.isLocationRecording(e)?$t.Location:this.isFestiveRecording(e)?$t.Festive:$t.UGC},e.prototype.onLocationChange=function(e){"Default"===e.kind?this.opera.enterMain():"Recording"===e.kind&&this.playRecording(e.recordingID)},e.prototype.onStateChange=function(e){e===Xe.Main&&(this.saveState={kind:"None"}),e===Xe.Main&&this.environment.changeLocation({kind:"Default"})},e.prototype.endRecording=function(){var e=this.opera.finishRecording();(function(e){for(var t=0,i=e.parts;t<i.length;t++)if(i[t].notes.length>0)return!1;return!0})(e)||(this.hasStoppedRecording=!0,e.theme=this.opera.festiveEnabled&&this.isAtBlobperaHouse()?this.festiveConfig.kind:c.Normal,this.opera.enterPlaying(e),this.saveState={kind:"Previewing"})},e.prototype.getShareText=function(e){return"Saved"===e.kind&&e.recordingType===$t.Location&&"Loaded"===this.locationState.kind?this.localiseString("axl_share_recording_cc").replace("<song>",this.localiseString(this.findLocationSong(e.savedRecordingID).nameStringID+"_name")).replace("<city>",this.localiseString(this.locationState.locationStringID)):"Saved"===e.kind&&e.recordingType===$t.Festive?this.localiseString("axl_share_festive_recording_cc").replace("<song>",this.localiseString(this.findFestiveSong(e.savedRecordingID).nameStringID+"_name")):"Loaded"===this.locationState.kind?this.localiseString("axl_share_recording_ugc").replace("<city>",this.localiseString(this.locationState.locationStringID)):""},e.prototype.saveRecording=function(){var e=this,t=this.getShareText(this.saveState);"Previewing"===this.saveState.kind?(this.saveState={kind:"SaveRequested"},this.opera.playingRecording.theme=this.opera.festiveEnabled&&this.isAtBlobperaHouse()?this.festiveConfig.kind:c.Normal,this.hasShared=!0,this.backend.saveRecording(this.opera.playingRecording).then((function(i){e.saveState={kind:"Saved",savedRecordingID:i.id,recordingType:$t.UGC},e.environment.changeLocation({kind:"Recording",recordingID:i.id}),e.environment.share({kind:"Recording",recordingID:e.saveState.savedRecordingID},t),e.environment.track({action:"tap-share",label:i.id})})).catch((function(t){console.log(t),e.saveState={kind:"Previewing"}}))):"Saved"===this.saveState.kind&&("Saved"===this.saveState.kind&&this.saveState.recordingType===$t.Festive&&(this.hasSharedCarol=!0),this.environment.share({kind:"Recording",recordingID:this.saveState.savedRecordingID},t),this.environment.track({action:"tap-share",label:this.saveState.savedRecordingID}))},e.prototype.update=function(e){var t=this.opera;t.showingPrompts=!this.showingInfo,this.controlledElements.update(),this.opera.festiveEnabled!==this.festiveToggle.checked&&(this.festiveToggle.checked=this.opera.festiveEnabled);var i,n,o,r,a,s=proxiesWindow.document.getElementById("playback-timecode"),l=proxiesWindow.document.querySelector(".progress-ring"),u=proxiesWindow.document.querySelector(".progress-circle");if(t.state===Xe.Playing){var c=t.playing?Math.max(0,t.clock.getTimeMs()-t.playbackStartTime)/1e3:0;s.innerText=Zt(c);var h=Object(p.b)(c/function(e){for(var t=0,i=0,n=e.parts;i<n.length;i++){var o=n[i];o.notes.length>0&&(t=Math.max(t,o.notes[o.notes.length-1].timeSeconds))}return t}(t.playingRecording),0,1);l.setAttribute("d",(i=u.cx.baseVal.value,n=u.cy.baseVal.value,o=u.r.baseVal.value,r=h,a=-2*Math.PI*r-Math.PI/2,"M "+i+" "+(n-o)+" A "+o+" "+o+(r<.5?" 0 0 1 ":" 0 1 1 ")+(i+-Math.cos(a)*o)+" "+(n+Math.sin(a)*o)))}var d=proxiesWindow.document.getElementById("recording-timecode");this.opera.isRecording&&(c=Math.max(0,(t.clock.getTimeMs()-t.recordingStartTime)/1e3),d.innerText=Zt(c)),t.getAudioRTFEnoughSamples()&&t.getAudioRTF().toFixed(1),t.audio.processingSampleRate.toFixed(0),mt()&&t.getAudioRTFEnoughSamples()&&"visible"===proxiesWindow.document.visibilityState&&!this.hasShownPerformanceWarning&&t.getAudioRTF()<3&&(t.onMouseUp(),this.hasShownPerformanceWarning=!0,this.showingPerformanceWarning=!0)},e.prototype.playPresetSong=function(e){this.playRecording(e),this.updateMenus(),QGUtils.triggerEvent(proxiesWindow.EVENT_PRESET_SONG_PLAY)},e.prototype.playRecording=function(e){var t=this;if(this.opera.state!==Xe.Playing||"Saved"!==this.saveState.kind||this.saveState.savedRecordingID!==e){this.opera.stopPlayback();var i=Object.assign({},this.saveState);this.saveState={kind:"Loading",loadingRecordingID:e,recordingType:this.getRecordingType(e)},this.backend.loadRecording(e).then((function(i){t.opera.enterPlaying(i),t.isAtBlobperaHouse()&&(i.theme===c.Christmas&&t.festiveConfig.kind===c.Christmas||i.theme===c.NewYears&&t.festiveConfig.kind===c.NewYears?t.opera.setFestiveEnabled(!0):t.opera.setFestiveEnabled(!1)),t.saveState={kind:"Saved",savedRecordingID:e,recordingType:t.saveState.recordingType},t.showingFestivePlaylist=!1,t.showingLocationPlaylist=!1,t.updateMenus()})).catch((function(e){t.saveState=i,t.updateMenus()}))}},e.prototype.updateLocationState=function(e){this.locationState=e,this.updateMenus()},e.prototype.getSelectedScene=function(){if("None"===this.locationState.kind)return this.config.scenes[0];var e=this.locationState.locationStringID;return this.config.scenes.find((function(t){return t.locationStringID===e}))},e.prototype.isAtBlobperaHouse=function(){return this.getSelectedScene()===this.config.scenes[0]},e.prototype.updateMenus=function(){this.rebuildLocationPlaylistMenu(),this.festiveConfig.kind!==c.Normal&&this.updatePlaylistMenuLoadStates("festive-songs",this.festiveConfig.songs),this.updatePlaylistMenuLoadStates("location-songs",this.getSelectedScene().songs||[]),this.updateLocationMenuLoadStates()},e.prototype.rebuildLocationPlaylistMenu=function(){for(var e=proxiesWindow.document.getElementById("location-songs"),t=0,i=[].slice.apply(e.childNodes);t<i.length;t++)i[t].remove();this.buildPlaylistMenu(e,this.getSelectedScene().songs||[],!0)},e.prototype.buildPlaylistMenu=function(e,t,i){for(var n=this,o=function(t){var o=r.localiseString(t.nameStringID+"_name"),a=i?r.localiseString(t.nameStringID+"_description"):"";e.appendChild(ii("play_circle_outline",o,a,(function(e){e.stopPropagation(),n.playPresetSong(t.recordingID),n.environment.track({action:"tap-song",label:ti(n.opera.state)+"_"+t.recordingID})})))},r=this,a=0,s=t;a<s.length;a++)o(s[a])},e.prototype.updatePlaylistMenuLoadStates=function(e,t){for(var i=proxiesWindow.document.getElementById(e).querySelectorAll("li"),n=0;n<t.length;++n){var o=t[n];("Loading"===this.saveState.kind?this.saveState.loadingRecordingID===o.recordingID:this.opera.state===Xe.Playing&&"Saved"===this.saveState.kind&&this.saveState.savedRecordingID===o.recordingID)?(i[n].classList.add("playing"),i[n].querySelector(".material-icons").innerHTML="volume_up","Loading"===this.saveState.kind&&this.saveState.loadingRecordingID===o.recordingID?i[n].classList.add("loading"):i[n].classList.remove("loading")):(i[n].classList.remove("playing"),i[n].querySelector(".material-icons").innerHTML="play_circle_outline",i[n].classList.remove("loading"))}},e.prototype.updateLocationMenuLoadStates=function(){for(var e=proxiesWindow.document.getElementById("location-selector").querySelectorAll("li"),t=0;t<this.config.scenes.length;++t){var i=this.config.scenes[t];"Loading"===this.locationState.kind&&this.locationState.locationStringID===i.locationStringID?e[t].classList.add("loading"):e[t].classList.remove("loading"),"Loaded"===this.locationState.kind&&this.locationState.locationStringID===i.locationStringID?e[t].classList.add("loaded"):e[t].classList.remove("loaded")}var n=proxiesWindow.document.getElementById("location-label");"None"!==this.locationState.kind?(n.innerText=Lt[this.language][this.locationState.locationStringID],n.style.visibility="visible"):n.style.visibility="hidden"},e}(),oi=i(40),ri=i.n(oi),ai=i(38);function si(e){var t=e.hash;return""===t?{kind:"Default"}:"#/r/"===t.substr(0,4)?{kind:"Recording",recordingID:e.hash.slice(4)}:{kind:"Default"}}ri()(ai.a,{insert:"head",singleton:!1}),ai.a.locals;var li=proxiesWindow.location.protocol+"//"+proxiesWindow.location.hostname+(proxiesWindow.location.port?":"+proxiesWindow.location.port:"")+proxiesWindow.location.pathname+(proxiesWindow.location.search?proxiesWindow.location.search:"");function ui(e){return"Default"===e.kind?"#/":"Recording"===e.kind?"#/r/"+e.recordingID:void 0}var ci=function(){function e(){this.onResume=null,this.onFreeze=null,this.onLocationChange=null,this.location=si(proxiesWindow.location),proxiesWindow.addEventListener("hashchange",this.onHashChange.bind(this))}return e.prototype.track=function(e){},e.prototype.onHashChange=function(e){this.location=si(proxiesWindow.location),this.onLocationChange&&this.onLocationChange(this.location)},e.prototype.changeLocation=function(e){this.location=e,proxiesWindow.location.hash=ui(e),this.onLocationChange&&this.onLocationChange(e)},e.prototype.share=function(e,t){!function(e){proxiesWindow.navigator.clipboard?proxiesWindow.navigator.clipboard.writeText(e).then((function(){}),(function(e){})):function(e){var t=proxiesWindow.document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",proxiesWindow.document.body.appendChild(t),t.focus(),t.select();try{proxiesWindow.document.execCommand("copy")}catch(e){}proxiesWindow.document.body.removeChild(t)}(e)}(function(e){return li+ui(e)}(e))},e.prototype.openURL=function(e){},e}();function hi(e){var t=e.match(/\*[^*]+?\*/);if(t)for(var i=0,n=t;i<n.length;i++){var o=n[i];e=e.replace(o,"<span>"+o.replace(/\*/g,"")+"</span>")}return t&&(e=hi(e)),e}function di(e){var t=e.split("\n");if(t.length>1){for(var i="",n=0,o=t;n<o.length;n++)i+="<p>"+o[n]+"</p>";return i}return e}function fi(e){var t=e.match(/\<davidli\>/);if(t)for(var i=0,n=t;i<n.length;i++){var o=n[i];e=e.replace(o,'<span id="credit">David&nbsp;Li</span>')}return t&&(e=hi(e)),e}function pi(e,t){var i=e.match(/\<performing_arts_link\>/);if(i)for(var n=0,o=i;n<o.length;n++){var r=o[n];e=e.replace(r,'<span id="info-link">'+t.info_performing_arts_link+"</span>")}return i&&(e=hi(e)),e}function mi(e,t){var i=e.match(/{{(\w+)}}/g);if(i)for(var n=0,o=i;n<o.length;n++){var r=o[n],a=t[r.replace("{{","").replace("}}","")];a=(a=pi(a=fi(a=hi(a=di(a))),t)).replace("-","&#8209;"),e=e.replace(r,a)}return e}var gi=i(10),bi={cameraFOVDegrees:22.5,positioningMode:"relative",scenes:[{locationStringID:"location_blobpera_house",name:"default",startCameraPosition:[2.3382685902179845,3.25,12.65],endCameraPosition:[0,4.25,19.5],blobs:[{position:[0,0,0],modelPath:"assets/004.flat",scale:1,parameters:{leftEyeScale:[.12,.14,.12],rightEyeScale:[.12,.14,.12],rightEyeX:-.2,rightEyeZ:.21,leftEyeX:.2,leftEyeZ:.21,hatY:2.1},stretch:1.25,rotationDegrees:45,singerIndex:0,subsurfaceColor:"#bbbbbb",mouthRotation:.3,inflation:1,lipScale:1.33,pitchScale:.5,width:1.8,mouthYScale:.9,festiveHatBrimRadius:.3,partyHatBrimRadius:.25,partyHatHue:.75,body:{albedoTexturePath:"assets/004_albedo.jpg",materialTexturePath:"assets/004_material.png",saturationBoost:.5,lightnessBoost:.8,hueShift:-.03,roughnessScale:.65,f0:.3},mouth:{color:"#ffdf74"}},{position:[0,0,.2],modelPath:"assets/003.flat",scale:1,parameters:{leftEyeScale:[.1,.1,.1],rightEyeScale:[.1,.1,.1],rightEyeX:-.13,rightEyeZ:-.1,leftEyeX:.13,leftEyeZ:-.1,eyeAttachOffset:.05,hatY:2.45},stretch:.95,rotationDegrees:45,singerIndex:1,subsurfaceColor:"#bbbbbb",mouthRotation:0,inflation:1.2,lipScale:1.3,pitchScale:.5,width:1.3,partyHatHue:.25,festiveHatBrimRadius:.15,partyHatBrimRadius:.15,body:{albedoTexturePath:"assets/003_albedo.jpg",materialTexturePath:"assets/003_material.png",saturationBoost:.3,lightnessBoost:0},mouth:{color:"#9abfe6"}},{position:[0,0,0],modelPath:"assets/002.flat",scale:.85,parameters:{leftEyeScale:[.15,.17,.15],rightEyeScale:[.15,.17,.15],rightEyeX:-.184637,rightEyeZ:.234132,leftEyeX:.184637,leftEyeZ:.234132,hatY:2.5},stretch:1,rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:2,mouthRotation:0,inflation:1,lipScale:1.4,pitchScale:.5,width:1.7,partyHatHue:.5,festiveHatBrimRadius:.32,partyHatBrimRadius:.25,body:{albedoTexturePath:"assets/002_albedo.jpg",materialTexturePath:"assets/002_material.png",normalScale:1,saturationBoost:.5,lightnessBoost:0},mouth:{color:"#a9ed87"}},{position:[0,0,-.3],scale:1,parameters:{leftEyeScale:[.18,.18,.18],rightEyeScale:[.18,.18,.18],rightEyeX:.3,rightEyeZ:.3,leftEyeX:-.3,leftEyeZ:.3,hatY:2.5},stretch:1,modelPath:"assets/001.flat",rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:3,mouthRotation:.2,inflation:1,lipScale:1.3,pitchScale:.5,width:1.7,partyHatHue:0,festiveHatBrimRadius:.32,partyHatBrimRadius:.27,body:{albedoTexturePath:"assets/001_albedo.jpg",materialTexturePath:"assets/001_material.png",normalScale:1,saturationBoost:.5,lightnessBoost:.3},mouth:{color:"#f09cf9"}}],backgroundImagePath:"backgrounds/default.jpeg",backgroundMaskPath:"backgrounds/default_mask.jpeg"},{locationStringID:"location_london",name:"london",startCameraPosition:[2.3382685902179845,3.25,12.65],endCameraPosition:[0,4.25,19.5],blobs:[{position:[0,0,.2],modelPath:"assets/003.flat",scale:1,parameters:{leftEyeScale:[.08,.08,.08],rightEyeScale:[.08,.08,.08],rightEyeX:-.15,rightEyeZ:-.1,leftEyeX:.15,leftEyeZ:-.1,eyeAttachOffset:.05},stretch:1,rotationDegrees:45,singerIndex:0,subsurfaceColor:"#bbbbbb",mouthRotation:0,inflation:1,lipScale:1.3,pitchScale:.5,width:1.3,body:{albedoTexturePath:"assets/003_albedo.jpg",materialTexturePath:"assets/003_material.png",hueShift:.75,saturationBoost:.1,lightnessBoost:.5},mouth:{color:"#6dfff3"}},{position:[0,0,0],modelPath:"assets/004.flat",scale:1,parameters:{leftEyeScale:[.12,.14,.12],rightEyeScale:[.12,.14,.12],rightEyeX:-.2,rightEyeZ:.21,leftEyeX:.2,leftEyeZ:.21},stretch:1.25,rotationDegrees:45,singerIndex:1,subsurfaceColor:"#bbbbbb",mouthRotation:.4,inflation:1,lipScale:1.33,pitchScale:.5,width:1.8,mouthYScale:.9,body:{albedoTexturePath:"assets/004_albedo.jpg",materialTexturePath:"assets/004_material.png",hueShift:.8,saturationBoost:.3,lightnessBoost:.5,roughnessScale:.65,f0:.3},mouth:{color:"#ee96f6"}},{position:[0,0,0],scale:1,parameters:{leftEyeScale:[.16,.16,.16],rightEyeScale:[.16,.16,.16],rightEyeX:.4,rightEyeZ:.3,leftEyeX:-.4,leftEyeZ:.3},stretch:1,modelPath:"assets/001.flat",rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:2,mouthRotation:.2,inflation:.5,lipScale:1.3,pitchScale:.5,width:1.7,body:{albedoTexturePath:"assets/001_albedo.jpg",materialTexturePath:"assets/001_material.png",normalScale:1,hueShift:.8,saturationBoost:.3,lightnessBoost:.5},mouth:{color:"#a7d3fb"}},{position:[0,0,0],modelPath:"assets/002.flat",scale:.85,parameters:{leftEyeScale:[.15,.17,.15],rightEyeScale:[.15,.17,.15],rightEyeX:-.184637,rightEyeZ:.234132,leftEyeX:.184637,leftEyeZ:.234132},stretch:1,rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:3,mouthRotation:0,inflation:1,lipScale:1.4,pitchScale:.5,width:1.7,body:{albedoTexturePath:"assets/002_albedo.jpg",materialTexturePath:"assets/002_material.png",normalScale:1,hueShift:.7,saturationBoost:.3,lightnessBoost:.5},mouth:{color:"#fffed2"}}],backgroundImagePath:"backgrounds/london.jpg",backgroundMaskPath:"backgrounds/london_mask.jpeg",songs:[{nameStringID:"song_hallelujah_chorus",recordingID:"hallelujahchorus5"},{nameStringID:"song_londonderry_air",recordingID:"londonderryair1"},{nameStringID:"song_wellerman",recordingID:"wellerman3"},{nameStringID:"song_ar_hyd_y_nos",recordingID:"ArHydYNos2"},{nameStringID:"song_loch_lomond",recordingID:"LochLomond2"}]},{locationStringID:"location_new_york",name:"new_york",startCameraPosition:[2.3382685902179845,3.25,12.65],endCameraPosition:[0,4.25,19.5],blobs:[{position:[0,0,0],modelPath:"assets/002.flat",scale:.85,parameters:{leftEyeScale:[.1,.1,.1],rightEyeScale:[.1,.1,.1],rightEyeX:-.184637,rightEyeZ:.234132,leftEyeX:.184637,leftEyeZ:.234132},stretch:1,rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:0,mouthRotation:0,inflation:1,lipScale:1.4,pitchScale:.5,width:1.7,body:{albedoTexturePath:"assets/002_albedo.jpg",materialTexturePath:"assets/002_material.png",normalScale:1,saturationBoost:.3,lightnessBoost:.5,hueShift:.4},mouth:{color:"#f2b8fa"}},{position:[0,0,.2],modelPath:"assets/003.flat",scale:1,parameters:{leftEyeScale:[.11,.11,.11],rightEyeScale:[.11,.11,.11],rightEyeX:-.13,rightEyeZ:-.1,leftEyeX:.13,leftEyeZ:-.1,eyeAttachOffset:.05},stretch:1,rotationDegrees:45,singerIndex:1,subsurfaceColor:"#bbbbbb",mouthRotation:0,inflation:1.2,lipScale:1.3,pitchScale:.5,width:1.3,body:{albedoTexturePath:"assets/003_albedo.jpg",materialTexturePath:"assets/003_material.png",hueShift:.8,saturationBoost:.3,lightnessBoost:.5},mouth:{color:"#6dfff3"}},{position:[0,0,0],scale:1,parameters:{leftEyeScale:[.15,.165,.15],rightEyeScale:[.15,.165,.15],rightEyeX:.3,rightEyeZ:.1,leftEyeX:-.3,leftEyeZ:.1},stretch:1,modelPath:"assets/001.flat",rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:2,mouthRotation:.2,inflation:.8,lipScale:1.3,pitchScale:.5,width:1.944,body:{albedoTexturePath:"assets/001_albedo.jpg",materialTexturePath:"assets/001_material.png",normalScale:4,saturationBoost:.5,lightnessBoost:.5,hueShift:.2},mouth:{color:"#aa33b8"}},{position:[0,0,0],modelPath:"assets/004.flat",scale:1,parameters:{leftEyeScale:[.2,.2,.2],rightEyeScale:[.2,.2,.2],rightEyeX:-.3,rightEyeZ:.21,leftEyeX:.3,leftEyeZ:.21},stretch:1.25,rotationDegrees:45,singerIndex:3,subsurfaceColor:"#bbbbbb",mouthRotation:0,inflation:1.8,lipScale:1.33,pitchScale:.5,width:1.8,mouthYScale:.9,body:{albedoTexturePath:"assets/004_albedo.jpg",materialTexturePath:"assets/004_material.png",saturationBoost:.3,lightnessBoost:.5,hueShift:.5},mouth:{color:"#ffffff"}}],backgroundImagePath:"backgrounds/newyork.jpg",backgroundMaskPath:"backgrounds/newyork_mask.jpeg",songs:[{nameStringID:"song_new_world_symphony",recordingID:"dvorak1"},{nameStringID:"song_down_to_the_river",recordingID:"downtotheriver1"},{nameStringID:"song_when_the_saints",recordingID:"whenthesaints4"},{nameStringID:"song_summertime",recordingID:"summertime3"},{nameStringID:"song_country_club",recordingID:"countryclub1"}]},{locationStringID:"location_mexico_city",name:"mexico_city",startCameraPosition:[2.3382685902179845,3.25,12.65],endCameraPosition:[0,4.25,19.5],blobs:[{position:[0,0,0],modelPath:"assets/004.flat",scale:1,parameters:{leftEyeScale:[.12,.14,.12],rightEyeScale:[.12,.14,.12],rightEyeX:-.2,rightEyeZ:.21,leftEyeX:.2,leftEyeZ:.21},stretch:1.35,rotationDegrees:45,singerIndex:0,subsurfaceColor:"#bbbbbb",mouthRotation:.4,inflation:.9,lipScale:1.33,pitchScale:.5,width:1.7,mouthYScale:.9,body:{albedoTexturePath:"assets/004_albedo.jpg",materialTexturePath:"assets/004_material.png",saturationBoost:.5,lightnessBoost:.5,hueShift:.2,roughnessScale:.65,f0:.3},mouth:{color:"#c9f7a2"}},{position:[0,0,0],modelPath:"assets/003.flat",scale:1,parameters:{leftEyeScale:[.08,.08,.08],rightEyeScale:[.08,.08,.08],rightEyeX:-.1,rightEyeZ:-.1,leftEyeX:.1,leftEyeZ:-.1,eyeAttachOffset:.05},stretch:1,rotationDegrees:45,singerIndex:1,subsurfaceColor:"#bbbbbb",mouthRotation:0,inflation:1.2,lipScale:1.3,pitchScale:.5,width:1.3,body:{albedoTexturePath:"assets/003_albedo.jpg",materialTexturePath:"assets/003_material.png",saturationBoost:.3,lightnessBoost:.5,hueShift:.2},mouth:{color:"#f6c7fe"}},{position:[0,0,0],scale:1,parameters:{leftEyeScale:[.11,.11,.11],rightEyeScale:[.11,.11,.11],rightEyeX:.2,rightEyeZ:-.01,leftEyeX:-.2,leftEyeZ:-.01},stretch:1,modelPath:"assets/005.flat",rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:2,mouthRotation:.2,inflation:1.4,lipScale:1.3,pitchScale:.5,width:1.7,body:{albedoTexturePath:"assets/005_albedo.jpg",materialTexturePath:"assets/005_material.png",normalScale:1,hueShift:.25,saturationBoost:.4,lightnessBoost:.6},mouth:{color:"#f8d89f"}},{position:[0,0,-.8],scale:1,parameters:{leftEyeScale:[.13,.13,.13],rightEyeScale:[.13,.13,.13],rightEyeX:.3,rightEyeZ:.3,leftEyeX:-.3,leftEyeZ:.3},stretch:1,modelPath:"assets/001.flat",rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:3,mouthRotation:.2,inflation:1,lipScale:1.3,pitchScale:.5,width:1.3,body:{albedoTexturePath:"assets/001_albedo.jpg",materialTexturePath:"assets/001_material.png",normalScale:1,saturationBoost:.5,lightnessBoost:.5,hueShift:.8},mouth:{color:"#c3f3fd"}}],backgroundImagePath:"backgrounds/mexicocity.jpg",backgroundMaskPath:"backgrounds/mexicocity_mask.jpeg",songs:[{nameStringID:"song_dios_nunca_muera",recordingID:"diosnuncamuere2"},{nameStringID:"song_la_bamba",recordingID:"labamba2"},{nameStringID:"song_la_llorona",recordingID:"lallorona2"}]},{locationStringID:"location_seoul",name:"seoul",startCameraPosition:[2.3382685902179845,3.25,12.65],endCameraPosition:[0,4.25,19.5],blobs:[{position:[0,0,0],modelPath:"assets/002.flat",scale:.85,parameters:{leftEyeScale:[.15,.17,.15],rightEyeScale:[.15,.17,.15],rightEyeX:-.184637,rightEyeZ:.234132,leftEyeX:.184637,leftEyeZ:.234132},stretch:1,rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:0,mouthRotation:0,inflation:1,lipScale:1.4,pitchScale:.5,width:2,body:{albedoTexturePath:"assets/002_albedo.jpg",materialTexturePath:"assets/002_material.png",normalScale:1,hueShift:.7,saturationBoost:.3,lightnessBoost:.5},mouth:{color:"#fcea83"}},{position:[0,0,0],scale:1,parameters:{leftEyeScale:[.11,.11,.11],rightEyeScale:[.11,.11,.11],rightEyeX:.2,rightEyeZ:-.01,leftEyeX:-.2,leftEyeZ:-.01},stretch:1,modelPath:"assets/005.flat",rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:1,mouthRotation:.2,inflation:1.4,lipScale:1.3,pitchScale:.5,width:1.7,body:{albedoTexturePath:"assets/005_albedo.jpg",materialTexturePath:"assets/005_material.png",normalScale:1,hueShift:.8,saturationBoost:.3,lightnessBoost:.5},mouth:{color:"#addaf7"}},{position:[0,0,-.3],scale:1,parameters:{leftEyeScale:[.16,.16,.16],rightEyeScale:[.16,.16,.16],rightEyeX:.4,rightEyeZ:.3,leftEyeX:-.4,leftEyeZ:.3},stretch:1,modelPath:"assets/001.flat",rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:2,mouthRotation:.2,inflation:.8,lipScale:1.3,pitchScale:.5,width:1.4,body:{albedoTexturePath:"assets/001_albedo.jpg",materialTexturePath:"assets/001_material.png",normalScale:1,hueShift:.5,saturationBoost:.3,lightnessBoost:.5},mouth:{color:"#e4fcc4"}},{position:[0,0,-.5],modelPath:"assets/004.flat",scale:1,parameters:{leftEyeScale:[.12,.14,.12],rightEyeScale:[.12,.14,.12],rightEyeX:-.3,rightEyeZ:.21,leftEyeX:.3,leftEyeZ:.21},stretch:1.25,rotationDegrees:45,singerIndex:3,subsurfaceColor:"#bbbbbb",mouthRotation:0,inflation:1.8,lipScale:1.33,pitchScale:.5,width:3,mouthYScale:.9,body:{albedoTexturePath:"assets/004_albedo.jpg",materialTexturePath:"assets/004_material.png",saturationBoost:.3,lightnessBoost:.5,hueShift:.7},mouth:{color:"#ffffff"}}],backgroundImagePath:"backgrounds/seoul.jpg",backgroundMaskPath:"backgrounds/seoul_mask.jpeg",songs:[{nameStringID:"song_arirang",recordingID:"arirang2"},{nameStringID:"song_han_river",recordingID:"hanriver1"},{nameStringID:"song_doraji",recordingID:"doraji1"}]},{locationStringID:"location_cape_town",name:"cape_town",startCameraPosition:[2.3382685902179845,3.25,12.65],endCameraPosition:[0,4.25,19.5],blobs:[{position:[0,0,0],modelPath:"assets/004.flat",scale:1,parameters:{leftEyeScale:[.08,.08,.08],rightEyeScale:[.08,.08,.08],rightEyeX:-.2,rightEyeZ:.21,leftEyeX:.2,leftEyeZ:.21},stretch:1.25,rotationDegrees:45,singerIndex:0,subsurfaceColor:"#bbbbbb",mouthRotation:.4,inflation:1,lipScale:1.33,pitchScale:.5,width:1.8,mouthYScale:.9,body:{albedoTexturePath:"assets/004_albedo.jpg",materialTexturePath:"assets/004_material.png",saturationBoost:.1,lightnessBoost:.6,hueShift:.6,roughnessScale:.65,f0:.3},mouth:{color:"#ffffff"}},{position:[0,0,.2],modelPath:"assets/003.flat",scale:1.1,parameters:{leftEyeScale:[.1,.11,.1],rightEyeScale:[.1,.11,.1],rightEyeX:.2,rightEyeZ:0,leftEyeX:-.2,leftEyeZ:0},stretch:.9,rotationDegrees:45,singerIndex:1,subsurfaceColor:"#bbbbbb",mouthRotation:0,inflation:1,lipScale:1.3,pitchScale:.5,width:1.3,body:{albedoTexturePath:"assets/003_albedo.jpg",materialTexturePath:"assets/003_material.png",saturationBoost:.3,lightnessBoost:.7,hueShift:.5},mouth:{color:"#f7efac"}},{position:[0,0,-.2],scale:1,parameters:{leftEyeScale:[.12,.12,.12],rightEyeScale:[.12,.12,.12],rightEyeX:.3,rightEyeZ:.3,leftEyeX:-.3,leftEyeZ:.3},stretch:1,modelPath:"assets/001.flat",rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:2,mouthRotation:.2,inflation:.8,lipScale:1.3,pitchScale:.5,width:1.944,body:{albedoTexturePath:"assets/001_albedo.jpg",materialTexturePath:"assets/001_material.png",normalScale:1,saturationBoost:.5,lightnessBoost:.5,hueShift:.6},mouth:{color:"#b5f4c1"}},{position:[0,0,0],modelPath:"assets/002.flat",scale:.85,parameters:{leftEyeScale:[.15,.17,.15],rightEyeScale:[.15,.17,.15],rightEyeX:-.184637,rightEyeZ:.234132,leftEyeX:.184637,leftEyeZ:.234132},stretch:1,rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:3,mouthRotation:0,inflation:1,lipScale:1.3,pitchScale:.5,width:1.7,body:{albedoTexturePath:"assets/002_albedo.jpg",materialTexturePath:"assets/002_material.png",normalScale:1,saturationBoost:.5,lightnessBoost:.5,hueShift:.35},mouth:{color:"#eebafb"}}],backgroundImagePath:"backgrounds/capetown.jpg",backgroundMaskPath:"backgrounds/capetown_mask.jpeg",songs:[{nameStringID:"song_shosholoza",recordingID:"Shosholoza2"},{nameStringID:"song_thula_baba",recordingID:"thulababa2"},{nameStringID:"song_nkosi",recordingID:"nkosi2"}]},{locationStringID:"location_paris",name:"paris",startCameraPosition:[2.3382685902179845,3.25,12.65],endCameraPosition:[0,4.25,19.5],blobs:[{position:[0,0,0],modelPath:"assets/002.flat",scale:.85,parameters:{leftEyeScale:[.15,.17,.15],rightEyeScale:[.15,.17,.15],rightEyeX:-.184637,rightEyeZ:.234132,leftEyeX:.184637,leftEyeZ:.234132},stretch:1,rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:0,mouthRotation:0,inflation:1,lipScale:1.4,pitchScale:.5,width:1.7,body:{albedoTexturePath:"assets/002_albedo.jpg",materialTexturePath:"assets/002_material.png",normalScale:1,saturationBoost:.5,lightnessBoost:.5,hueShift:.65},mouth:{color:"#ffdbae"}},{position:[0,0,0],modelPath:"assets/004.flat",scale:1,parameters:{leftEyeScale:[.12,.14,.12],rightEyeScale:[.12,.14,.12],rightEyeX:-.2,rightEyeZ:.19,leftEyeX:.2,leftEyeZ:.19},stretch:1.25,rotationDegrees:45,singerIndex:1,subsurfaceColor:"#bbbbbb",mouthRotation:.4,inflation:1,lipScale:1.33,pitchScale:.5,width:1.8,mouthYScale:.9,body:{albedoTexturePath:"assets/004_albedo.jpg",materialTexturePath:"assets/004_material.png",saturationBoost:.1,lightnessBoost:.8,hueShift:.7,roughnessScale:.65,f0:.3},mouth:{color:"#ffffff"}},{position:[0,0,0],modelPath:"assets/003.flat",scale:1.1,parameters:{leftEyeScale:[.1,.11,.1],rightEyeScale:[.1,.11,.1],rightEyeX:.2,rightEyeZ:0,leftEyeX:-.2,leftEyeZ:0,eyeAttachOffset:.05},stretch:.9,rotationDegrees:45,singerIndex:2,subsurfaceColor:"#bbbbbb",mouthRotation:0,inflation:1.3,lipScale:1.3,pitchScale:.5,width:1.3,body:{albedoTexturePath:"assets/003_albedo.jpg",materialTexturePath:"assets/003_material.png",saturationBoost:.5,lightnessBoost:.5,hueShift:.8},mouth:{color:"#6dfff3"}},{position:[0,0,-.4],scale:1,parameters:{leftEyeScale:[.15,.165,.15],rightEyeScale:[.15,.165,.15],rightEyeX:.3,rightEyeZ:0,leftEyeX:-.3,leftEyeZ:0},stretch:1,modelPath:"assets/001.flat",rotationDegrees:45,subsurfaceColor:"#bbbbbb",singerIndex:3,mouthRotation:.2,inflation:.8,lipScale:1.3,pitchScale:.5,width:1.944,body:{albedoTexturePath:"assets/001_albedo.jpg",materialTexturePath:"assets/001_material.png",normalScale:1,saturationBoost:.5,lightnessBoost:.5,hueShift:.9},mouth:{color:"#aa33b8"}}],backgroundImagePath:"backgrounds/paris.jpg",backgroundMaskPath:"backgrounds/paris_mask.jpeg",songs:[{nameStringID:"song_gymnopedie",recordingID:"gymnopedie6"},{nameStringID:"song_frere_jacques",recordingID:"frerejacques4"},{nameStringID:"song_habanera",recordingID:"habanera2"}]}],midiMappingMode:"keyboard",skipTutorial:!1,disableDrop:!1,disableUI:!1},vi="undefined"!=typeof globalThis&&globalThis||void 0!==proxiesWindow.self&&proxiesWindow.self||void 0!==vi&&vi,yi="URLSearchParams"in vi,xi="Symbol"in vi&&"iterator"in Symbol,_i="FileReader"in vi&&"Blob"in vi&&function(){try{return new proxiesWindow.Blob,!0}catch(e){return!1}}(),wi="FormData"in vi,Pi="ArrayBuffer"in vi;if(Pi)var Si=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],ki=ArrayBuffer.isView||function(e){return e&&Si.indexOf(Object.prototype.toString.call(e))>-1};function Ai(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function Ti(e){return"string"!=typeof e&&(e=String(e)),e}function Ei(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return xi&&(t[Symbol.iterator]=function(){return t}),t}function Mi(e){this.map={},e instanceof Mi?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function Ri(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function Bi(e){return new Promise((function(t,i){e.onload=function(){t(e.result)},e.onerror=function(){i(e.error)}}))}function Ci(e){var t=new proxiesWindow.FileReader,i=Bi(t);return t.readAsArrayBuffer(e),i}function Fi(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function Li(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:_i&&proxiesWindow.Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:wi&&proxiesWindow.FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:yi&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():Pi&&_i&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=Fi(e.buffer),this._bodyInit=new proxiesWindow.Blob([this._bodyArrayBuffer])):Pi&&(ArrayBuffer.prototype.isPrototypeOf(e)||ki(e))?this._bodyArrayBuffer=Fi(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):yi&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},_i&&(this.blob=function(){var e=Ri(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new proxiesWindow.Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new proxiesWindow.Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?Ri(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer)):this.blob().then(Ci)}),this.text=function(){var e,t,i,n=Ri(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,i=Bi(t=new proxiesWindow.FileReader),t.readAsText(e),i;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),i=new Array(t.length),n=0;n<t.length;n++)i[n]=String.fromCharCode(t[n]);return i.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},wi&&(this.formData=function(){return this.text().then(ji)}),this.json=function(){return this.text().then(JSON.parse)},this}Mi.prototype.append=function(e,t){e=Ai(e),t=Ti(t);var i=this.map[e];this.map[e]=i?i+", "+t:t},Mi.prototype.delete=function(e){delete this.map[Ai(e)]},Mi.prototype.get=function(e){return e=Ai(e),this.has(e)?this.map[e]:null},Mi.prototype.has=function(e){return this.map.hasOwnProperty(Ai(e))},Mi.prototype.set=function(e,t){this.map[Ai(e)]=Ti(t)},Mi.prototype.forEach=function(e,t){for(var i in this.map)this.map.hasOwnProperty(i)&&e.call(t,this.map[i],i,this)},Mi.prototype.keys=function(){var e=[];return this.forEach((function(t,i){e.push(i)})),Ei(e)},Mi.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),Ei(e)},Mi.prototype.entries=function(){var e=[];return this.forEach((function(t,i){e.push([i,t])})),Ei(e)},xi&&(Mi.prototype[Symbol.iterator]=Mi.prototype.entries);var Ii=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Di(e,t){if(!(this instanceof Di))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var i,n,o=(t=t||{}).body;if(e instanceof Di){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new Mi(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new Mi(t.headers)),this.method=(n=(i=t.method||this.method||"GET").toUpperCase(),Ii.indexOf(n)>-1?n:i),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(o),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var r=/([?&])_=[^&]*/;r.test(this.url)?this.url=this.url.replace(r,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function ji(e){var t=new proxiesWindow.FormData;return e.trim().split("&").forEach((function(e){if(e){var i=e.split("="),n=i.shift().replace(/\+/g," "),o=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}})),t}function Oi(e,t){if(!(this instanceof Oi))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"",this.headers=new Mi(t.headers),this.url=t.url||"",this._initBody(e)}Di.prototype.clone=function(){return new Di(this,{body:this._bodyInit})},Li.call(Di.prototype),Li.call(Oi.prototype),Oi.prototype.clone=function(){return new Oi(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Mi(this.headers),url:this.url})},Oi.error=function(){var e=new Oi(null,{status:0,statusText:""});return e.type="error",e};var zi=[301,302,303,307,308];Oi.redirect=function(e,t){if(-1===zi.indexOf(t))throw new RangeError("Invalid status code");return new Oi(null,{status:t,headers:{location:e}})};var Ni=vi.DOMException;try{new Ni}catch(e){(Ni=function(e,t){this.message=e,this.name=t;var i=Error(e);this.stack=i.stack}).prototype=Object.create(Error.prototype),Ni.prototype.constructor=Ni}function Hi(e,t){return new Promise((function(i,n){var o=new Di(e,t);if(o.signal&&o.signal.aborted)return n(new Ni("Aborted","AbortError"));var r=new proxiesWindow.XMLHttpRequest;function a(){r.abort()}r.onload=function(){var e,t,n={status:r.status,statusText:r.statusText,headers:(e=r.getAllResponseHeaders()||"",t=new Mi,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var i=e.split(":"),n=i.shift().trim();if(n){var o=i.join(":").trim();t.append(n,o)}})),t)};n.url="responseURL"in r?r.responseURL:n.headers.get("X-Request-URL");var o="response"in r?r.response:r.responseText;setTimeout((function(){i(new Oi(o,n))}),0)},r.onerror=function(){setTimeout((function(){n(new TypeError("Network request failed"))}),0)},r.ontimeout=function(){setTimeout((function(){n(new TypeError("Network request failed"))}),0)},r.onabort=function(){setTimeout((function(){n(new Ni("Aborted","AbortError"))}),0)},r.open(o.method,function(e){try{return""===e&&vi.location.href?vi.location.href:e}catch(t){return e}}(o.url),!0),"include"===o.credentials?r.withCredentials=!0:"omit"===o.credentials&&(r.withCredentials=!1),"responseType"in r&&(_i?r.responseType="blob":Pi&&o.headers.get("Content-Type")&&-1!==o.headers.get("Content-Type").indexOf("application/octet-stream")&&(r.responseType="arraybuffer")),!t||"object"!=typeof t.headers||t.headers instanceof Mi?o.headers.forEach((function(e,t){r.setRequestHeader(t,e)})):Object.getOwnPropertyNames(t.headers).forEach((function(e){r.setRequestHeader(e,Ti(t.headers[e]))})),o.signal&&(o.signal.addEventListener("abort",a),r.onreadystatechange=function(){4===r.readyState&&o.signal.removeEventListener("abort",a)}),r.send(void 0===o._bodyInit?null:o._bodyInit)}))}function Ui(e){return e.split("-")[0]}function Gi(){var e,t=new URLSearchParams(proxiesWindow.location.search);return t.has("notheme")?c.Normal:t.has("christmas")?c.Christmas:t.has("newyears")?c.NewYears:(e=new Date,Object(p.m)(e)?c.NewYears:Object(p.l)(e)?c.Christmas:c.Normal)}function Wi(){return("1"===new URLSearchParams(proxiesWindow.location.search).get("axl")?i.e(0).then(i.bind(null,49)).then((function(e){return new Promise((function(t,i){var n=e.default,o=new n,r=o.handshake().then((function(e){return function(e){return"r"in e?{kind:"Recording",recordingID:e.r}:"nye"in e?(proxiesWindow.alert("NYE"),{kind:"Recording",recordingID:"jinglebells"}):{kind:"Default"}}(e)})),a=new Promise((function(e,t){var i=!1;o.registerMessageCallback(n.HostToChild.RESUME,(function(){i||(e(),i=!0)}))})),s=function(){function e(e,t){var i=this;this.onLocationChange=null,this.onResume=null,this.onFreeze=null,this.axl=e,this.location=t,e.registerMessageCallback(n.HostToChild.RESUME,(function(){i.onResume&&i.onResume()})),e.registerMessageCallback(n.HostToChild.FREEZE,(function(){i.onFreeze&&i.onFreeze()}))}return e.prototype.track=function(e){o.sendMessage(n.ChildToHost.TRACK,e)},e.prototype.changeLocation=function(e){this.location=e,o.sendMessage(n.ChildToHost.SET_URL_PARAMS,function(e){return"Recording"===e.kind?{r:e.recordingID}:"Default"===e.kind?{}:void 0}(e))},e.prototype.share=function(e,t){this.changeLocation(e),"Recording"===e.kind&&o.sendMessage(n.ChildToHost.SHARE,{title:t})},e.prototype.openURL=function(e){o.sendMessage(n.ChildToHost.NAVIGATE,e)},e}();return Promise.all([r,a]).then((function(e){t(new s(o,e[0]))}))}))})):Promise.resolve(new ci)).then((function(e){var t,i=e.location;return(t=i,"Recording"===t.kind?(new Ct).loadRecording(t.recordingID).then((function(e){return{kind:"Recording",recording:e,recordingID:t.recordingID,festiveTheme:e.theme===c.Normal?Gi():e.theme}})).catch((function(e){return{kind:"Default",festiveTheme:Gi()}})):Promise.resolve({kind:"Default",festiveTheme:Gi()})).then((function(t){return[e,t]}))}))}function Vi(e,t,i,n){return Wi().then((function(o){var r=o[0],a=o[1],s="default";"Recording"===a.kind&&(s=P(a.recording.location));var l=function(e,t){return e.scenes.find((function(e){return e.name===t}))}(e,s);return a.festiveTheme===c.NewYears?Promise.all([Xt(Qi,i,l),Yi(t),St(n,"party",Object(pt.a)("party.mp3"))]).then((function(e){return{environment:r,initOptions:a,sceneConfig:l,sceneAssets:e[0],balloonAssets:e[1],additionalSamples:[e[2]]}})):a.festiveTheme===c.Christmas?Promise.all([Xt(Qi,i,l),St(n,"bells",Object(pt.a)("bells.mp3"))]).then((function(e){return{environment:r,initOptions:a,sceneConfig:l,sceneAssets:e[0],additionalSamples:[e[1]]}})):Xt(Qi,i,l).then((function(e){return{environment:r,initOptions:a,sceneConfig:l,sceneAssets:e}}))}))}function Yi(e){var t=Object(p.h)(new Date),i=new URLSearchParams(proxiesWindow.location.search);i.has("year")&&(t=i.get("year"));for(var n={},o=[],r=function(e){var i=t.charAt(e);n[i]||(n[i]=!0,o.push(Object(dt.a)(Object(pt.a)("assets/balloon_"+i+".flat")).then((function(e){return{digit:i,buffer:new Uint8Array(e)}}))))},a=0;a<t.length;++a)r(a);return Promise.all([Promise.all(o),Object(dt.b)(Object(pt.a)("assets/balloon_normals.png")),Object(dt.b)(Object(pt.a)("assets/balloon_environment.jpg"))]).then((function(i){for(var n={},o=0,r=i[0];o<r.length;o++){var a=r[o];n[a.digit]=a.buffer}return{year:t,rigidMeshData:n,normalMap:s(e,0,i[1],e.REPEAT,e.REPEAT,e.LINEAR,e.LINEAR,!1),environmentMap:s(e,0,i[2],e.REPEAT,e.REPEAT,e.LINEAR,e.LINEAR,!0)}}))}function qi(e){var t=proxiesWindow.document.createElement("div");proxiesWindow.document.body.appendChild(t),t.outerHTML=e}Hi.polyfill=!0,vi.fetch||(vi.fetch=Hi,vi.Headers=Mi,vi.Request=Di,vi.Response=Oi),i(42);var Ki=proxiesWindow.mainCanvas;Ki.parentElement.removeChild(Ki),Ki.style.zIndex="-1",Ki.style.position="fixed",Ki.style.width="100%",Ki.style.height="100%",Ki.style.display="block";var Xi,Ji=function(){var e=function(e){return"in"===e?"id":e}(new URLSearchParams(proxiesWindow.location.search).get("lang"));if(null!==e){if(e in Lt)return e;for(var t in Lt)if(Ui(e)===Ui(t))return t}return"en-US"}(),Zi=Ki.getContext("webgl",{alpha:!1}),Qi=new qt,$i=new Yt(Zi);if(Xi=new(proxiesWindow.AudioContext||proxiesWindow.webkitAudioContext),null!==Zi&&(proxiesWindow.AudioContext||proxiesWindow.webkitAudioContext)&&proxiesWindow.Worker&&"object"==typeof WebAssembly){qi(mi('<div id="splash" class="hideable-unclickable visible"> <div id="intro">{{splash_intro}}</div> <div id="title" class="title"><img id="title-image" src="./logo-2x.png"></div> <div id="tagline">{{splash_description}}</div> <div id="loading" class="loading-visible"> <div id="loading-bar"> <div id="loading-fill"><div id="loading-play">{{button_begin}}</div></div> </div> <div id="audio-prompt">{{splash_sound_hint}}</div> <div id="silent-hint"><span class="material-icons" style="vertical-align:middle">notifications</span>{{splash_silent_hint}}</div> </div> </div> <div id="disclaimer" class="hideable-unclickable visible"> {{disclaimer}} </div> <div id="landscape-warning-overlay"> <div> <div id="landscape-warning-desktop"> <div class="landscape-warning-icon"><span class="material-icons">fullscreen</span></div> <div class="landscape-warning-text">{{landscape_warning_desktop}}</div> </div> <div id="landscape-warning-mobile"> <div class="landscape-warning-icon"><span class="material-icons">screen_rotation</span></div> <div class="landscape-warning-text">{{landscape_warning_mobile}}</div> </div> </div> </div>',Lt[Ji])),bt()&&proxiesWindow.document.getElementById("silent-hint").classList.add("silent-hint-show");var en=function(){proxiesWindow.innerHeight<400?(mt()?(proxiesWindow.document.getElementById("landscape-warning-desktop").style.display="none",proxiesWindow.document.getElementById("landscape-warning-mobile").style.display="block"):(proxiesWindow.document.getElementById("landscape-warning-mobile").style.display="none",proxiesWindow.document.getElementById("landscape-warning-desktop").style.display="block"),proxiesWindow.document.getElementById("landscape-warning-overlay").style.display="flex"):(proxiesWindow.document.getElementById("landscape-warning-overlay").style.display="none",proxiesWindow.scrollTo(0,1))},tn=gt()?"eyelow.flat":"eye.flat",nn=tn.includes("json");proxiesWindow.addEventListener("resize",en),en(),Promise.resolve(bi).then((function(e){var t,i;(function(e,t){for(var i=e.length,n=0,o=0,r=e;o<r.length;o++)r[o].then((function(){t((n+=1)/i)}));return Promise.all(e)})([ct({locateFile:function(e,t){return e+=Object(yt.a)(),Object(vt.a)()?Object(pt.a)(e.replace(".wasm","-simd.wasm")):Object(pt.a)(e)}}),(t=Xi,4,i=Object(pt.a)("jittertemplates.proto"),Promise.resolve(gi.a).then((function(e){gt()&&(e.scriptProcessorBufferSize=8192);var n=mt()?24e3:32e3;return Pt(t,4,i,e,n)}))),new Promise((function(e,t){var i=new proxiesWindow.Worker(Object(pt.a)("harmonizerworker.js"+Object(yt.a)()));i.onmessage=function(t){"Loaded"===t.data.type&&e(new Et(i))}})),Mt(4,gt()?1:4),Object(dt.a)(Object(pt.a)("recordedlibrettos.proto")),Object(dt.a)(Object(pt.a)(tn)),Vi(e,Zi,$i,Xi)],(function(e){proxiesWindow.document.getElementById("loading-fill").style.width=Math.round(100*e).toFixed(0)+"%",console.log("loading progress: ",e),e>=1&&QGUtils.triggerEvent(QGUtils.GameEvent.Ready)})).then((function(t){var i=t[6],n=i.environment,o=i.initOptions,r=i.sceneConfig,a=i.sceneAssets,s=!1,l=function(){if(!s){s=!0,proxiesWindow.document.body.appendChild(Ki),qi(mi('\n<div id="skip" class="hideable-clickable"> {{label_skip_tutorial}} &gt;</div>\n<div id="title-small" class="title hideable-unclickable"><img id="title-small-image" src="./logo-1x.png"></div>\n<div id="soprano-prompt" class="voice-prompt prompt prompt-right-arrow hideable-unclickable">{{prompt_soprano}}</div>\n<div id="alto-prompt" class="voice-prompt prompt prompt-right-arrow hideable-unclickable">{{prompt_mezzo}}</div>\n<div id="tenor-prompt" class="voice-prompt prompt prompt-right-arrow hideable-unclickable">{{prompt_tenor}}</div>\n<div id="bass-prompt" class="voice-prompt prompt prompt-right-arrow hideable-unclickable">{{prompt_bass}}</div>\n<div id="pitch-prompt" class="prompt prompt-left-arrow hideable-unclickable">{{prompt_pitch}}&nbsp;<span\n    id="pitch-prompt-pitch"></span></div>\n<div id="vowel-prompt" class="prompt prompt-bottom-arrow hideable-unclickable">{{prompt_vowel}}&nbsp;<span\n    id="vowel-prompt-vowel"></span></div>\n<svg style="width:0;height:0;position:absolute;z-index:-1">\n  <defs>\n    <g id="silence-line">\n      <line x1="10" y1="10" x2="40" y2="40"></line>\n    </g>\n    <g id="silence-icon">\n      <path d=" M 10 20 L 10 30 L 19 30 L 30 40 L 30 10 L 19 20 Z" fill="white" stroke="white" stroke-width="1"\n            stroke-linecap="butt" stroke-linejoin="round"/>\n      <path d=" M 33 20 A 10 10 0 0 1 33 30 M 35 15 A 15 15 0 0 1 35 35" fill="transparent" stroke="white"\n            stroke-width="1.5"></path>\n    </g>\n  </defs>\n</svg>\n<div id="record-container" class="button-container hideable-clickable">\n  <div id="record">\n    <div id="record-start"></div>\n  </div>\n  <div id="record-text" class="button-text">{{label_record}}</div>\n</div>\n<div id="stop-recording-container" class="button-container hideable-clickable recording">\n  <div id="recording-timecode" class="timecode"></div>\n  <div id="stop-record">\n    <div id="record-start"></div>\n  </div>\n  <div id="finish-text" class="button-text">{{label_finish}}</div>\n</div>\n<div id="stop-recording-prompt" class="prompt prompt-left-arrow hideable-unclickable">{{prompt_stop_recording}}</div>\n<div id="festive-prompt" class="prompt prompt-bottom-arrow hideable-unclickable"></div>\n<div id="location-selection-prompt" class="prompt prompt-bottom-arrow hideable-unclickable">{{prompt_locations}}</div>\n<div id="location-songs-prompt" class="prompt prompt-bottom-arrow hideable-unclickable">{{prompt_location_songs}}</div>\n<div id="startstop-container" class="button-container hideable-clickable">\n  <div id="playback-timecode" class="timecode"></div>\n  <svg id="startstop-ring" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 58 58">\n    <circle class="progress-circle" r="26" cx="29" cy="29" stroke-width="6" stroke="rgba(255, 255, 255, 0.2)"\n            fill="transparent"/>\n    <path class="progress-ring" d="" stroke-width="6" stroke="white" fill="transparent"/>\n  </svg>\n  <div id="startstop" class="">\n    <div id="startstop-play"></div>\n    <div id="startstop-stop"></div>\n  </div>\n  <div id="play-text" class="button-text">{{label_play}}</div>\n  <div id="stop-text" class="button-text">{{label_stop}}</div>\n</div>\n<div id="back-container" class="button-container hideable-clickable">\n  <div class="button-text">{{label_back}}</div>\n  <div id="back" class="button material-icons">arrow_back</div>\n</div>\n<div id="festive-switch-container" class="hideable-clickable"><label class="switch" id="festive-switch"> <input\n    type="checkbox" name="festive"> <span class="slider round"></span> </label></div>\n<div id="festive-playlist" class="festive-button material-icons hideable-clickable">queue_music</div>\n<div id="location-playlist-tray" class="hideable-clickable">\n  <div id="location-playlist-button" class="playlist-button material-icons hideable-clickable">queue_music</div>\n  <div id="location-label"></div>\n</div>\n<div id="location-selector-button" class="location-button material-icons hideable-clickable">public</div>\n<div id="play" class="hideable-clickable">{{prompt_in_playback_shared}}</div>\n<div id="muted-container" class="hideable-unclickable">\n  <svg width="100%" height="100%" viewBox="-10 -10 70 70" xmlns="http://www.w3.org/2000/svg">\n    <mask id="line-mask" width="200%">\n      <rect x="-10" y="-10" width="160" height="100" fill="white"></rect>\n      <line x1="10" y1="10" x2="40" y2="40" stroke="black" stroke-width="4"></line>\n    </mask>\n    <path d="\n            M 10 20\n            L 10 30\n            L 19 30\n            L 30 40\n            L 30 10\n            L 19 20\n            Z\n        " mask="url(#line-mask)" fill="white" stroke="white" stroke-width="1" stroke-linecap="butt"\n          stroke-linejoin="round"/>\n    <line x1="10" y1="10" x2="40" y2="40" stroke="white" stroke-width="2"></line>\n    <path d="\n        M 33 20\n        A 10 10 0 0 1 33 30\n\n        M 35 15\n        A 15 15 0 0 1 35 35\n        " mask="url(#line-mask)" fill="transparent" stroke="white" stroke-width="1.5"></path>\n  </svg>\n  <div id="muted-text">{{prompt_unmute}}</div>\n</div>\n<div id="info-overlay" class="hideable-clickable"></div>\n<div id="festive-songs-container" class="menu-container hideable-clickable prompt-bottom-arrow">\n  <ul id="festive-songs" class="menu-items"></ul>\n</div>\n<div id="location-selector-container" class="menu-container hideable-clickable prompt-bottom-arrow">\n  <ul id="location-selector" class="menu-items"></ul>\n</div>\n<div id="location-songs-container" class="menu-container hideable-clickable prompt-bottom-arrow">\n  <ul id="location-songs" class="menu-items"></ul>\n</div>\n<svg id="recording-frame-top-left" viewbox="0 0 1 1" class="recording-frame-corner hideable-unclickable">\n  <path d="M 1 0 L 0 0 L 0 1" fill="transparent"></path>\n</svg>\n<svg id="recording-frame-top-right" viewbox="0 0 1 1" class="recording-frame-corner hideable-unclickable">\n  <path d="M 0 0 L 1 0 L 1 1" fill="transparent"></path>\n</svg>\n<svg id="recording-frame-bottom-left" viewbox="0 0 1 1" class="recording-frame-corner hideable-unclickable">\n  <path d="M 1 1 L 0 1 L 0 0" fill="transparent"></path>\n</svg>\n<svg id="recording-frame-bottom-right" viewbox="0 0 1 1" class="recording-frame-corner hideable-unclickable">\n  <path d="M 1 0 L 1 1 L 0 1" fill="transparent"></path>\n</svg>\n<div id="recording-indicator" class="hideable-unclickable">\n  <div id="recording-icon"></div>\n  RECORDING\n</div>\n<div id="tutorial-prompt-pitch" class="hideable-unclickable tutorial-prompt">{{tutorial_pitch}}</div>\n<div id="tutorial-prompt-vowel" class="hideable-unclickable tutorial-prompt">{{tutorial_vowel}}</div>\n<div id="tutorial-prompt-harmonization" class="hideable-unclickable tutorial-prompt">{{tutorial_harmonization}}</div>\n<div id="tutorial-prompt-mute" class="hideable-unclickable tutorial-prompt">{{tutorial_mute}}</div>\n<div id="tutorial-prompt-end" class="hideable-unclickable tutorial-prompt">{{tutorial_end}}</div>\n<div id="timer"></div>\n<div id="performance-warning" class="hideable-clickable">\n  <div id="performance-warning-content">\n    <div id="performance-warning-icon" class="material-icons">warning</div>\n    <div id="performance-warning-text">{{performance_warning}}</div>\n    <div id="performance-warning-dismiss">{{performance_warning_dismiss}}</div>\n  </div>\n</div>\n              ',Lt[Ji]));var l=t[0],u=t[1];if(i.additionalSamples)for(var c=0,h=i.additionalSamples;c<h.length;c++){var d=h[c];u.samplePlayer.addSample(d.name,d)}var f=gt()?3:0,p=new ut(e,Ki,Zi,l,t[2],t[3],u,new Uint8Array(t[4]),a,o,u.synthRunner.audioParameters.frameHopSeconds,gt()?{blobSubdivisions:0}:{blobSubdivisions:1},f,r,new Uint8Array(t[5]),nn,i.balloonAssets);e.disableUI?(proxiesWindow.document.getElementById("splash").classList.remove("visible"),proxiesWindow.document.getElementById("disclaimer").classList.remove("visible")):new ni(e,p,n,o,Ji,Qi,$i);var m=proxiesWindow.document.getElementById("loading");m.className="loading-hidden",proxiesWindow.setTimeout((function(){m.parentNode.removeChild(m)}),300),n.onFreeze=function(){p.freeze()},n.onResume=function(){p.resume()};var g=function(){p.state===Xe.Playing&&p.stopPlayback(),p.audio.synthRunner.setTimingEnabled(!1)};proxiesWindow.document.addEventListener("visibilitychange",(function(e){"hidden"===proxiesWindow.document.visibilityState?g():"visible"===proxiesWindow.document.visibilityState&&p.audio.synthRunner.setTimingEnabled(!0)})),proxiesWindow.addEventListener("pagehide",g),proxiesWindow.addEventListener("pageshow",(function(){p.audio.synthRunner.setTimingEnabled(!0)})),n.track({action:"launch-experiment"})}},u=function(){t[1].tryUnlock(),l()};gt()||bt()?(proxiesWindow.document.getElementById("loading-bar").className="loading-button",proxiesWindow.document.getElementById("loading-bar").addEventListener("touchstart",(function(e){e.preventDefault()})),proxiesWindow.document.getElementById("loading-bar").addEventListener("touchend",u),proxiesWindow.document.getElementById("loading-bar").addEventListener("click",u)):l()}))}))}else qi(mi('<div id="error">Your browser doesn\'t support the required features. Try another browser and/or device!</div>',Lt[Ji]))}]);